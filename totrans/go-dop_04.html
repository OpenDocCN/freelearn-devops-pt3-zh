<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer014">
			<h1 id="_idParaDest-118"><a id="_idTextAnchor260"/>Chapter <a id="_idTextAnchor261"/>3: Setting Up Your Environment</h1>
			<p>In this chapter, we are going to talk about setting up your <strong class="bold">Go</strong> environment for use in <em class="italic">our future chapters</em> and for developing your own Go software in the future.</p>
			<p>We're going to cover the following main topics:</p>
			<ul>
				<li>Installing Go on your machine</li>
				<li>Building code locally</li>
			</ul>
			<p>Before we begin, let's have a brief walk-through of the technical requirements you need to be aware of before reading on. </p>
			<h1 id="_idParaDest-119"><a id="_idTextAnchor262"/>Technical requirements</h1>
			<p>The only technical requirements for this chapter are as follows:</p>
			<ul>
				<li>A computer with an OS supported by the Go tools</li>
				<li>An internet connection and web browser to download the Go tools</li>
			</ul>
			<h1 id="_idParaDest-120"><a id="_idTextAnchor263"/>Installing Go on your machine</h1>
			<p>The <strong class="bold">Go compiler</strong> and toolset can be found at <a href="https://golang.org/dl/">https://golang.org/dl/</a>. Here, you will find releases<a id="_idIndexMarker325"/> for the macOS, Windows, and Linux<a id="_idIndexMarker326"/> platforms for a multitude of computing platforms. </p>
			<p>The most common platform is the <strong class="bold">AMD64</strong> architecture, which should be used<a id="_idIndexMarker327"/> for any x86 system. For macOS, it is important to note that if you are using a machine with a non-Intel-based CPU, such as an Apple M1, you<a id="_idIndexMarker328"/> will want to use the <strong class="bold">arm64 builds</strong>. </p>
			<p>In the next sections, we will describe methods of installing Go for the major OSs. You should skip to the OS you plan to install <a id="_idTextAnchor264"/>on.</p>
			<h2 id="_idParaDest-121"><a id="_idTextAnchor265"/>macOS installation using the package installer</h2>
			<p>The easiest way to install the Go tooling for macOS is to use a <strong class="source-inline">.pkg</strong> installer. The download page offers <strong class="source-inline">.tar.gz</strong> builds and <strong class="source-inline">.pkg</strong>. With the tarballs, you must unpack the files in a location<a id="_idIndexMarker329"/> and add that location to your path. It also means<a id="_idIndexMarker330"/> you will have to manually<a id="_idIndexMarker331"/> handle upgrades. You should only do this if you have advanced needs.</p>
			<p>The <strong class="source-inline">.pkg</strong> file makes installation and upgrading simple. Simply double-click the <strong class="source-inline">.pkg</strong> file and follow the onscreen prompts to install. This may require entering in your credentials at a prompt.</p>
			<p>Once installation is finished, open the <strong class="source-inline">Applications/Utilities/terminal.app</strong> terminal and type <strong class="source-inline">go version</strong>, which should yield something similar to the following:</p>
			<p class="source-code">$ go version</p>
			<p class="source-code">go version go1.17.5 linux/amd64</p>
			<p>Note that the <strong class="bold">version output</strong> will depend on the version<a id="_idIndexMarker332"/> of Go that you have downloaded and the platform you are runn<a id="_idTextAnchor266"/>ing on.</p>
			<h2 id="_idParaDest-122"><a id="_idTextAnchor267"/>macOS installation via Homebrew</h2>
			<p>Many developers on macOS<a id="_idIndexMarker333"/> prefer to use the popular <strong class="bold">Homebrew</strong> (<a href="https://brew.sh">https://brew.sh</a>) to install Go. If you are a Homebrew<a id="_idIndexMarker334"/> user, there is a simple two-step process<a id="_idIndexMarker335"/> for installing Go, as explained in the following sections.</p>
			<h3>Installing Xcode</h3>
			<p>Go has some reliance on Apple's <strong class="bold">Xcode</strong>, and it needs to be installed<a id="_idIndexMarker336"/> in order to work correctly. To see whether you have Xcode installed, type the following:</p>
			<p class="source-code">$ xcode-select -p</p>
			<p>This should output something like this:</p>
			<p class="source-code">$ /Library/Developer/CommandLineTools</p>
			<p>If it gives an error, you need<a id="_idIndexMarker337"/> to install Xcode by following this link on the App Store: <a href="https://itunes.apple.com/us/app/xcode/id497799835?mt=12&amp;ign-mpt=uo%3D2">https://itunes.apple.com/us/app/xcode/id497799835?mt=12&amp;ign-mpt=uo%3D2</a>. </p>
			<p>Once installed, you can install<a id="_idIndexMarker338"/> the separate command-line tools with the following:</p>
			<p class="source-code">$ xcode-select --install</p>
			<p>Now, let's look at the next step.</p>
			<h3>Homebrew update and Go installation</h3>
			<p>Update Homebrew<a id="_idIndexMarker339"/> and install the latest Go tools<a id="_idIndexMarker340"/> with the following:</p>
			<p class="source-code">$ brew update</p>
			<p class="source-code">$ brew install golang</p>
			<p>You can verify the Go version with <strong class="source-inline">$ go version</strong>.</p>
			<p>Next, we will look at installat<a id="_idTextAnchor268"/>ion on Windows.</p>
			<h2 id="_idParaDest-123"><a id="_idTextAnchor269"/>Windows installation using MSI</h2>
			<p>Windows installation<a id="_idIndexMarker341"/> is similar to other Windows application installations using a <strong class="bold">Microsoft Installer</strong> (<strong class="bold">MSI</strong>) file. Simply download the MSI file and follow the onscreen<a id="_idIndexMarker342"/> instructions. By default, this will install the Go tooling at <strong class="bold">Program Files</strong> or <strong class="bold">Program Files (x86)</strong>. </p>
			<p>To verify that Go was installed correctly, click the <em class="italic">Start</em> menu, type <strong class="source-inline">cmd</strong> into the search box, and the Command Prompt shell should appear. Type <strong class="source-inline">go version</strong>, and it should display the installed version of Go.</p>
			<p>Next, we will look at insta<a id="_idTextAnchor270"/>llation on Linux.</p>
			<h2 id="_idParaDest-124"><a id="_idTextAnchor271"/>Linux</h2>
			<p>Linux package management<a id="_idIndexMarker343"/> could be the subject of its own series of books and, as Linus points out, it is one of the reasons why Linux as a desktop system has failed so spectacularly. </p>
			<p>If you are using Linux for development, chances are you have some knowledge on how to install packages for your distribution. As we can't cover all possible methods of installation on Linux, we are going to cover installation using <strong class="source-inline">apt</strong>, Snap<a id="_idTextAnchor272"/>, and via <strong class="source-inline">tarball</strong>.</p>
			<h3>Linux installation via APT on Ubuntu</h3>
			<p><strong class="bold">APT</strong> is a package installation<a id="_idIndexMarker344"/> manager used in various<a id="_idIndexMarker345"/> distributions. Installing Go via APT is pretty<a id="_idIndexMarker346"/> straightforward.</p>
			<p>Update and upgrade APT to the latest version, as follows:</p>
			<p class="source-code">$ sudo apt update</p>
			<p class="source-code">$ sudo apt upgrade</p>
			<p>Install the Go package as follows:</p>
			<p class="source-code">sudo apt install golang-go</p>
			<p>Now, type <strong class="source-inline">go version</strong> into the terminal, and it should display the ins<a id="_idTextAnchor273"/>talled version of Go.</p>
			<h3>Linux installation via Snap on Ubuntu</h3>
			<p><strong class="bold">Snap</strong> is a universal package manager<a id="_idIndexMarker347"/> meant to make the installation of a package<a id="_idIndexMarker348"/> easy across multiple distributions<a id="_idIndexMarker349"/> or versions by including all the necessary files in the package.</p>
			<p>If you have Snap installed, you can simply use <strong class="source-inline">snap info go</strong> to locate a version of Go to install:</p>
			<div>
				<div id="_idContainer013" class="IMG---Figure">
					<img src="Images/B17626_03_001.jpg" alt="Figure 3.1 – Screenshot showing the snap info go command output&#13;&#10;" width="1099" height="502"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.1 – Screenshot showing the snap info go command output</p>
			<p>You can choose to install the latest stable version of Go by typing the following:</p>
			<p class="source-code">sudo snap install go</p>
			<p>Now, type <strong class="source-inline">go version</strong> into the terminal, and it should display the installed version of Go.</p>
			<p>Note that you may receive a warning about the Go package being built on a revision of Snap with classic confinement. In that case, to install<a id="_idIndexMarker350"/> using Snap, you may need<a id="_idIndexMarker351"/> to append <strong class="source-inline">–-classic</strong> as follows:</p>
			<p class="source-code">sudo <a id="_idTextAnchor274"/>snap install go --classic</p>
			<h3>Linux installation via tarball</h3>
			<p>In order to do this, you need to download the package for Linux and your platform. Our example<a id="_idIndexMarker352"/> will use <strong class="source-inline">go1.16.5.linux-amd64.tar.gz</strong>. You will notice that the name<a id="_idIndexMarker353"/> gives the Go version (<em class="italic">1.16.5</em>), the OS (Linux), and the architecture (<em class="italic">AMD64</em>). You will need to download the current version of Go and your architecture into a directory.</p>
			<p>The rest of these instructions will use the terminal.</p>
			<p>We want to install our version into <strong class="source-inline">/usr/local/go</strong> and remove any previous installation. This can be achieved with the following:</p>
			<p class="source-code">rm -rf /usr/local/go &amp;&amp; tar -C /usr/local -xzf go1.16.5.linux-amd64.tar.gz</p>
			<p>Now, let's add our directory to our <strong class="source-inline">PATH</strong> so that we can find our Go tools. This can be accomplished with the following:</p>
			<p class="source-code">export PATH=$PATH:/usr/local/go/bin</p>
			<p>With most shells, this change will not happen immediately. The easiest way to cause <strong class="source-inline">PATH</strong> to update is simply to open a new shell. You may also use the <strong class="source-inline">source</strong> command to reload your shell's profile if you know the name/location of your shell's profile – <strong class="source-inline">source $HOME/.profile</strong>, for example.</p>
			<p>To test if your <strong class="source-inline">PATH</strong> was updated<a id="_idIndexMarker354"/> correctly, type <strong class="source-inline">go version</strong>, which should yield<a id="_idIndexMarker355"/> the following:</p>
			<p class="source-code">$ go version</p>
			<p class="source-code">go<a id="_idTextAnchor275"/> version go1.16.5 linux/amd64</p>
			<p>What about installing Go on other platforms? </p>
			<h2 id="_idParaDest-125"><a id="_idTextAnchor276"/>Other platforms</h2>
			<p>Go can certainly be installed<a id="_idIndexMarker356"/> on other platforms, such as <strong class="bold">FreeBSD</strong>, but those are not covered here. See the Go <em class="italic">installation documentat<a id="_idTextAnchor277"/>ion</em> for these other platforms.</p>
			<h2 id="_idParaDest-126"><a id="_idTextAnchor278"/>A note on Go compiler version compatibility</h2>
			<p>The Go project is governed<a id="_idIndexMarker357"/> by the Go compatibility promise: <a href="https://golang.org/doc/go1compat">https://golang.org/doc/go1compat</a>. The gist is that Go will be backward compatible unless there is a major semantic version<a id="_idIndexMarker358"/> number change (<strong class="bold">1.x.x</strong> to <strong class="bold">2.x.x</strong>). While you might hear people talk about Go 2.0, the authors have been very clear that they have no plans to leave version 1.</p>
			<p>This means software written for <strong class="bold">Go 1.0.0</strong> works in the latest <strong class="bold">Go 1.17.5</strong> version. This has been a major<a id="_idIndexMarker359"/> win for the Go community<a id="_idIndexMarker360"/> in stability. This book will be using Go 1.17.5 for its revision.</p>
			<p>By the end of this section, you should have installed<a id="_idIndexMarker361"/> the Go tooling and tested that the tooling is working for your OS of choice. In the next section, we will discuss<a id="_idTextAnchor279"/> how to build code on your machine.</p>
			<h1 id="_idParaDest-127"><a id="_idTextAnchor280"/>Building code locally</h1>
			<p>The current Go ecosystem (Go 1.13 onward) and toolchain allow you to write Go code from any location<a id="_idIndexMarker362"/> in the filesystem. Most users choose to set up a local Git repository for their package(s) and develop within that directory.</p>
			<p>This is accomplished using Go modules that<a id="_idIndexMarker363"/> the Go team describes as <em class="italic">"a collection of Go packages stored in a file tree with a go.mod file at its root."</em> A Go module most often represents a GitHub repository, such as <strong class="source-inline">github.com/user/repository</strong>. </p>
			<p>Most Go developers will use the command line to move around the filesystem environment and for interacting with the Go toolchain. In this section, we will concentrate on using Unix commands for accessing the filesystem and using Go compiler tools. The Go compiler commands will be the same between each OS, but filesystem commands may not be, and the file paths may also differ, such as Windows usi<a id="_idTextAnchor281"/>ng <strong class="source-inline">\</strong> instead of <strong class="source-inline">/</strong> as path separators.</p>
			<h2 id="_idParaDest-128"><a id="_idTextAnchor282"/>Creating a module directory and go.mod file</h2>
			<p>The directory can be anywhere<a id="_idIndexMarker364"/> on the filesystem you have access. <strong class="source-inline">godev/</strong> is a good directory<a id="_idIndexMarker365"/> name to use, and putting it in your home directory, which is OS-dependent, is a logical place to make it easy to find. </p>
			<p>Within that directory, I will create a new directory for my package. For this example, I will create a directory called <strong class="source-inline">hello/</strong> that will represent my Go module:</p>
			<p class="source-code">$ cd ~</p>
			<p class="source-code">$ mkdir -p ~/godev/hello</p>
			<p class="source-code">$ cd ~/godev/hello </p>
			<p>To create our module, we simply need to create a <strong class="source-inline">go.mod</strong> file that contains our module name. Module names are typically the Git path, such as <strong class="source-inline">github.com/johnsiilver/fs</strong>.</p>
			<p>If you have a GitHub repository that you wish to store this example in, you can substitute it in our command:</p>
			<p class="source-code">$ go mod init example.com/hello</p>
			<p class="source-code">go: creating new go.mod: module example.com/hello</p>
			<p>This <strong class="source-inline">go.mod</strong> file will contain a few key sections worth noting:</p>
			<p class="source-code">module example.com/hello</p>
			<p class="source-code">go 1.17</p>
			<p>The first line defines our module, which is the path to the root of the Git repository. The second defines the minimum version of Go that can be used to compile this module. Depending on what features you use, your module may be compatible with previous versions of Go, and you can modify this to have a lower version number.  </p>
			<p>While this example <a id="_idIndexMarker366"/>will not have any third-party packages, it is worth<a id="_idIndexMarker367"/> noting that most <strong class="source-inline">go.mod</strong> files will have a <em class="italic">require</em> section that lists packages and their versions that your module imports.  </p>
			<h2 id="_idParaDest-129"><a id="_idTextAnchor283"/>Updating a module when adding dependencies</h2>
			<p>When adding a third-party package, your <strong class="source-inline">go.mod</strong> file will need to be modified<a id="_idIndexMarker368"/> to contain the dependency information. This would be a tedious task, but Go has you covered with the <strong class="source-inline">go mod tidy</strong> command.</p>
			<p>Running <strong class="source-inline">go mod tidy</strong> will look at all your package imports and add them to your <strong class="source-inline">go.mod</strong> file automatically. Remember to run th<a id="_idTextAnchor284"/>is after adding any external dependencies.</p>
			<h2 id="_idParaDest-130"><a id="_idTextAnchor285"/>Adding a hello world</h2>
			<p>To learn how to compile<a id="_idIndexMarker369"/> and run Go code, we are going to create a <em class="italic">hello world</em> application. In Go, all Go source files end with the <strong class="source-inline">.go</strong> extension. </p>
			<p>Create a file in the directory called <strong class="source-inline">hello.go</strong> using your favorite text editor and insert the following code:</p>
			<p class="source-code">package main </p>
			<p class="source-code"><strong class="bold">import "fmt" </strong></p>
			<p class="source-code">func main() { </p>
			<p class="source-code">    fmt.Println("Hello W<a id="_idTextAnchor286"/>orld")</p>
			<p class="source-code">}</p>
			<p>Next, let's run<a id="_idIndexMarker370"/> our first program.</p>
			<h2 id="_idParaDest-131"><a id="_idTextAnchor287"/>Running our first program</h2>
			<p>Once you have that file saved, let's try compiling and running<a id="_idIndexMarker371"/> that code:</p>
			<p class="source-code">$ go run hello.go</p>
			<p class="source-code">Hello World</p>
			<p class="source-code">$</p>
			<p>This compiled our source file and ran it as a binary. You may only use <strong class="source-inline">go run</strong> for a package called <strong class="source-inline">main</strong>. </p>
			<p>If we want to create a binary for this OS and architecture , we can simply run the following:</p>
			<p class="source-code">$ go build hello.go # Builds a program called hello</p>
			<p class="source-code">$ ./hello           # Executes the hello binary</p>
			<p class="source-code">Hello World</p>
			<p>There is now a binary called <strong class="source-inline">hello</strong> that can be run on any OS/architecture of the same type. If our package was not called <strong class="source-inline">main</strong>, this would compile the package and emit any errors encountered, but it would not create a binary.</p>
			<h1 id="_idParaDest-132"><a id="_idTextAnchor288"/>Summary</h1>
			<p>You have now created your first Go module, initialized your first <strong class="source-inline">go.mod</strong> file, created a Go program, run the Go program with <strong class="source-inline">go run</strong>, and built a Go executable for your OS. This chapter has left you with the necessary skills to create a basic Go module and the basic knowledge of the Go command-line tool required to both run a Go package and build a Go program. These are used every day in the life of a Go developer.</p>
			<p>In the next chapter, we're going to cover the basics of the Go language, including how packages work, testing, and many more essentials.</p>
		</div>
	</div></body></html>