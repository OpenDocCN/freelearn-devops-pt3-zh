<html><head></head><body>
		<div id="_idContainer027">
			<h1 id="_idParaDest-37" class="hapter-number"><a id="_idTextAnchor038"/>2</h1>
			<h1 id="_idParaDest-38"><a id="_idTextAnchor039"/>Talking about Python</h1>
			<p class="author-quote">Language is the key to world peace. If we all spoke each other’s tongues, perhaps the scourge of war would <a id="_idTextAnchor040"/>be ended forever.</p>
			<p class="author-quote">– Batman</p>
			<p>The Python programming language was built on a set of principles that was meant to simplify coding in it. This simplification came at the cost of a lot of speed and performance compared to other programming languages but also produced a popular language that was accessible and easy to build in, with a massive library of built-in functions. All of these made Python very versatile and capable of being used in a myriad of situations, a programming <a id="_idIndexMarker024"/>Swiss army knife if you will. A perfect tool for a diverse discipline such <span class="No-Break">as </span><span class="No-Break"><strong class="bold">DevOps</strong></span><span class="No-Break">.</span></p>
			<p>Beginners are recommended Python as a learning language because it is<a id="_idTextAnchor041"/> fairly simple, easy to pick up,<a id="_idTextAnchor042"/> and also used a fair amount in the industry (if it wasn’t, why would I be writing this book?). Python is also a great flexible programming language for hobbyists because of the same reasons as before, as well as the library support that it has for things such as OS automation, the internet of things, machine learning, and other specific areas of interest. At the professional level, Python has a lot of competition for market space, but this is largely because – at that level – smaller differences, legacy systems, and available skills count <span class="No-Break">for something.</span></p>
			<p>And that’s perfectly fine. We don’t need the entire market share for Python – that would be very boring and counterintuitive to innovation. In fact, I encourage you to try other languages and their concepts before returning to Python because that will help you find out a lot of things that Python makes easier for you and help you appreciate the abstraction that <span class="No-Break">Python provides.</span></p>
			<p>Python is the language of simplicity, and it is the language of conciseness. Often, you can write a piece of code in Python in one line that would have otherwise taken 10 lines in <span class="No-Break">another language.</span></p>
			<p>All the things that I have stated are not the only reasons that Python is so popular in development and DevOps. In fact, one of the most important reasons for Python’s popularity <span class="No-Break">is this:</span></p>
			<p><em class="itali">{}</em></p>
			<p>Yes, that. That is not a print error. That represents the JSON/dictionary format that carries data across the internet on practically every major modern system. Python handles that better than any other language and makes it easier to operate on than any other language. The base Python libraries are usually enough to fully unleash the power of JSON whereas in many other languages, it would require additional libraries or <span class="No-Break">custom functions.</span></p>
			<p>Now, you might ask, “Can’t I install those libraries? What’s the big deal?” Well, understanding the big deal comes from working with this type of data and understanding that not every programming language that you use has grown to emphasize the importance of these two brackets and how much of a problem that can become in modern <span class="No-Break">DevOps/the cloud.</span></p>
			<p>In this chapter, I will provide a basic refresher for Python and give you some Python knowledge that is practical, hands-on, and useful in the DevOps field. It will not be all of the Python programming language, because that is a massive topic and not the focus of this book. We will only focus on the aspects of the Python programming language that are useful for <span class="No-Break">our work.</span></p>
			<p>So, let’s list out what we are going to <span class="No-Break">cover here:</span></p>
			<ul>
				<li>The basics of Python through the philosophical ideas of <span class="No-Break">its creators</span></li>
				<li>How Python can support <span class="No-Break">DevOps practices</span></li>
				<li>Some examples to support <span class="No-Break">these points</span></li>
			</ul>
			<h1 id="_idParaDest-39"><a id="_idTextAnchor043"/>Python 101</h1>
			<p>Python is – as I have said before – a simple language to pick up. It is meant to be readable by the layperson and the logic of its code is meant to be easily understandable. It is because of <a id="_idIndexMarker025"/>this fact that everything from installing Python to configuring it in your OS is probably the smoothest installation process out of any of the major programming languages. The barrier of entry is next <span class="No-Break">to zero.</span></p>
			<p>So, if you want to declare a variable and other basic stuff, start from the following figure and figure <span class="No-Break">it out:</span></p>
			<div>
				<div id="_idContainer012" class="IMG---Figure">
					<img src="image/B21320_02_1.jpg" alt="Figure 2.1 – Declaring and manipulating variables"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.1 – Declaring and manipulating variables</p>
			<p>This section will be focused on the philosophy of Python because that is what will be important in your journey toward using Python in DevOps. Once you understand the underlying philosophies, you will understand why Python and DevOps are such a <span class="No-Break">perfect match.</span></p>
			<p>In fact, we can find that <a id="_idIndexMarker026"/>similarity in the <strong class="bold">Zen of Python<a id="_idTextAnchor044"/></strong>. The Zen is a series of principles that have come to define the Python language and how its libraries are built. The Zen of Python was written in 1999 by Tim Peters for his Python mailing list. It has since been integrated into the Python interpreter itself. If you go to the command line of the interpreter and type in <strong class="sour e-inline">import this</strong>, you’ll see the 19 lines of Zen. Odd number, you say? It’s an <span class="No-Break">interesting story.</span></p>
			<p>So, if you haven’t seen it before, I’m going to list it out here <span class="No-Break">for posterity:</span></p>
			<p><em class="itali">Beautiful is better </em><span class="No-Break"><em class="itali">than ugly.</em></span></p>
			<p><em class="itali">Explicit is better </em><span class="No-Break"><em class="itali">than implicit.</em></span></p>
			<p><em class="itali">Simple is better </em><span class="No-Break"><em class="itali">than complex.</em></span></p>
			<p><em class="itali">Complex is better </em><span class="No-Break"><em class="itali">than complicated.</em></span></p>
			<p><em class="itali">Flat is better </em><span class="No-Break"><em class="itali">than nested.</em></span></p>
			<p><em class="itali">Sparse is better </em><span class="No-Break"><em class="itali">than dense.</em></span></p>
			<p><span class="No-Break"><em class="itali">Readability counts.</em></span></p>
			<p><em class="itali">Special cases aren’t special enough to break </em><span class="No-Break"><em class="itali">the rules.</em></span></p>
			<p><em class="itali">Although practicality </em><span class="No-Break"><em class="itali">beats purity.</em></span></p>
			<p><em class="itali">Errors should never </em><span class="No-Break"><em class="itali">pass silently.</em></span></p>
			<p><em class="itali">Unless </em><span class="No-Break"><em class="itali">explicitly silenced.</em></span></p>
			<p><em class="itali">In the face of ambiguity, refuse the temptation </em><span class="No-Break"><em class="itali">to guess.</em></span></p>
			<p><em class="itali">There should be one-- and preferably only one --obvious way to </em><span class="No-Break"><em class="itali">do it.</em></span></p>
			<p><em class="itali">Although that way may not be obvious at first unless </em><span class="No-Break"><em class="itali">you’re Dutch.</em></span></p>
			<p><em class="itali">Now is better </em><span class="No-Break"><em class="itali">than never.</em></span></p>
			<p><em class="itali">Although never is often better than *</em><span class="No-Break"><em class="itali">right* now.</em></span></p>
			<p><em class="itali">If the implementation is hard to explain, it’s a </em><span class="No-Break"><em class="itali">bad idea.</em></span></p>
			<p><em class="itali">If the implementation is easy to explain, it may be a </em><span class="No-Break"><em class="itali">good idea.</em></span></p>
			<p><em class="itali">Namespaces are one honking great idea -- let’s do more </em><span class="No-Break"><em class="itali">of those!</em></span></p>
			<p>(<em class="itali">Tim Peters, 1999, The Zen of </em><span class="No-Break"><em class="itali">Python,</em></span><span class="No-Break"> </span><a href="https://peps.python.org/pep-0020/#the-zen-of-python"><span class="No-Break">https://peps.python.org/pep-0020/#the-zen-of-python</span></a><span class="No-Break">)</span></p>
			<p>The reason I’m laying this out for you right now is so that I can give you examples of how these principles have <a id="_idIndexMarker027"/>become a part of the fully evolved Python language. I am going to do this in pairs. Except for that last one. These rules and their implementations will provide you with the appropriate boundaries that you need to write decent <span class="No-Break">Python code.</span></p>
			<h2 id="_idParaDest-40"><a id="_idTextAnchor045"/>Beautiful-ugly/explicit-implicit</h2>
			<p>Let’s start <a id="_idIndexMarker028"/>with beauty. They say beauty is in the eye of the beholder. And this is why, when you behold improperly indented code, you begin to understand the beauty of actually indented code. Here is the same code written correctly in JavaScript <span class="No-Break">and Python:</span></p>
			<ul>
				<li><span class="No-Break">JavaScript:</span><pre class="sour e- ode">const value = 5; for (let i = 0; i &lt;= value; i++) {console.log(i);}</pre></li>
				<li><span class="No-Break">Python:</span><pre class="sour e- ode">value = 5
for i in range(value+1):
print(i)</pre></li>
			</ul>
			<p>The JavaScript code works, by the way. It does the same thing that the Python code does. You could write all of the scripts for JavaScript on a single line if you wanted to (and when you build JS frontends, sometimes you do to save space). But which one can you read better? Which one breaks down the information in a better way for you? Python forces <a id="_idIndexMarker029"/>this syntax due to its removal of semi-colons in favor of indentations as a way to separate code lines, making the code more <span class="No-Break">objectively </span><span class="No-Break"><em class="itali">beautiful</em></span><span class="No-Break">.</span></p>
			<p>But something is missing. You may understand the fact that the code is clear and concise, but you might not understand the code. This is where we must be explicit, in the definition of the code and its variables. Python encourages comments describing every code block as well as a defined structure when it comes to assigning variables. <strong class="bold">Snake case</strong> (<strong class="sour e-inline">snake_case</strong>) is used <a id="_idIndexMarker030"/>for variables and uppercase snake case is used for constants. Let’s re-write our Python code following <span class="No-Break">these guidelines:</span></p>
			<pre class="sour e- ode">""" Initial constant that doesn't change """INITIAL_VALUE = 5""" Loop through the range of the constant """for current_value in range(INITIAL_VALUE+1):""" Print current loop value """print(current_value)</pre>
			<p>You don’t need to do this for every line; I’m just being a little more explicit than usual for posterity. But this is the basic way to define variables and comments. No more of that <em class="itali">i</em>, <em class="itali">j</em>, and <em class="itali">k</em> stuff. Be kind and <span class="No-Break">be defined.</span></p>
			<p>Definition simplifies things, which is what we are going to discuss in this <span class="No-Break">next section.</span></p>
			<h2 id="_idParaDest-41"><a id="_idTextAnchor046"/>Simple-complex-complicated</h2>
			<p>Simplicity must be maintained wherever possible. That is the rule because, well, it’s easier that way. Keeping things simple, however, is hard. It’s impossible sometimes. As an application or a solution becomes greater in size, the complexity becomes greater too. What we do not want is for the code to <span class="No-Break">become complicated.</span></p>
			<p>What’s the <a id="_idIndexMarker031"/>difference between complex and complicated? Code is complex when it is written to sustainably deal with all the scenarios presented before it dynamically and understandably. Code is complicated when (in a complex solution) it is written in a way that handles every possible case based on static, very specific parameters (hard coding) and in a way that becomes difficult to understand, even for the person who <span class="No-Break">wrote it.</span></p>
			<p>I have seen a lot of it over my career; I wrote a lot of it at the beginning, too. It’s a learning process and if you don’t build good habits, you will fall into bad habits or fall back to a simpler solution for a more <span class="No-Break">complex problem.</span></p>
			<p>Once, when reviewing an old <strong class="bold">Django</strong> code base, I encountered an API written not in any API library <a id="_idIndexMarker032"/>but written using the <strong class="bold">p</strong><strong class="bold">andas data science library</strong> with the ensuing result being presented using the Django <strong class="sour e-inline">JSONResponse</strong> function. It was baffling, and I couldn’t help but think about why someone would write the code this way, until I found out that the person who had written it had had no previous web development expertise and was instead a data engineer. So, they reverted to what their vision of simplicity was: data science libraries, even for <span class="No-Break">backend development.</span></p>
			<p>Now, this slowed down the application immensely and, of course, had to be refactored, but – since we are blameless on individuals in this book – we couldn’t blame the developer. We have to blame the habits that they fall back on and the simplicity they seek that eventually results in complicated code, when a slightly more complex yet concise solution would have resulted in <span class="No-Break">better code.</span></p>
			<h2 id="_idParaDest-42"><a id="_idTextAnchor047"/>Flat-nested/sparse-dense</h2>
			<p>The part <a id="_idIndexMarker033"/>about flat being better than nested, in particular, is a reason for those famous one-line Python codes that you see. Simple code shouldn’t have to span across 20-30 lines when it can be done in a few. In a lot of languages, it cannot be done in a few lines, but in Python, <span class="No-Break">it can.</span></p>
			<p>Let’s test out this concept when printing each value for this array: <strong class="sour e-inline">my_list = [</strong><span class="No-Break"><strong class="sour e-inline">1,2,3,4,5]</strong></span><span class="No-Break">:</span></p>
			<table id="table001-1" class="No-Table-Style _idGenTablePara-1">
				<colgroup>
					<col/>
					<col/>
				</colgroup>
				<tbody>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><strong class="bold">Flat </strong><span class="No-Break"><strong class="bold">and sparse</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="bold">Nested </strong><span class="No-Break"><strong class="bold">and dense</strong></span></p>
						</td>
					</tr>
					<tr class="No-Table-Style">
						<td class="No-Table-Style">
							<p><span class="No-Break"><strong class="sour e-inline">print(*my_list)</strong></span></p>
						</td>
						<td class="No-Table-Style">
							<p><strong class="sour e-inline">for element in </strong><span class="No-Break"><strong class="sour e-inline">my_list: print(element)</strong></span></p>
						</td>
					</tr>
				</tbody>
			</table>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Table 2.1 – Flat and sparse versus nested and dense</p>
			<p>Again, a very small example, but one of many present in the Python language. I recommend <a id="_idIndexMarker034"/>going through the list of libraries that Python comes pre-installed with; it is a very interesting read and will help you come up with a lot <span class="No-Break">of ideas.</span></p>
			<p>A lot of the time, this flat and sparse concept reduces the amount of code written by a significant amount. In turn, this makes the code more readable just from the reduced time it takes to read <span class="No-Break">the code.</span></p>
			<p>Let’s dive into readability and the purity of <span class="No-Break">the concept.</span></p>
			<h2 id="_idParaDest-43"><a id="_idTextAnchor048"/>Readability-special cases-practicality-purity-errors</h2>
			<p>Python is meant to be a language that can be read and understood at some level by the layperson. It doesn’t <a id="_idIndexMarker035"/>require any particularly special syntax and even the one-liners can be interpreted quite easily. Readability counts, and there are no special cases that are special enough to violate this credo. I have already expressed both philosophies through the previous examples, so there is no need to reiterate <span class="No-Break">them here.</span></p>
			<p>Practicality over purity is a fairly simple concept. Often, trying to follow best practices too strictly simply results in a waste of time. Sometimes, the best way to do something is to do it and then explain it later. However, in such cases, make sure that your boldness doesn’t <a id="_idIndexMarker036"/>result in something that might break the system. In that case, <strong class="bold">try-catch error handling</strong> is your best friend. It also helps to pass errors silently when you need <span class="No-Break">it to.</span></p>
			<p>Balance between the two – progress and verification – results in code that has been verified and tested, but also code that is actually shipped to the end user. This balance is integral to any successful project. You have to be pragmatic when you are doing actual work, but you also <a id="_idIndexMarker037"/>have to realize that other people may not be so pragmatic in their actions and <span class="No-Break">their estimates.</span></p>
			<p>To take action in either direction, pragmatism or purity requires a sense of direction. It requires deciding something or some way and sticking <span class="No-Break">to it.</span></p>
			<h2 id="_idParaDest-44"><a id="_idTextAnchor049"/>Ambiguity/one way/Dutch</h2>
			<p>Anyone who has ever worked with clients knows how demoralizing and frustrating a vague requirement is. “<em class="itali">Do this, do that, we need this</em>” – that’s all you hear, without any understanding <a id="_idIndexMarker038"/>from the other side or respect for how the process works. They have a certain goal in mind, and they don’t care how you get there. That’s fine for machines (and we’ll learn how to do some of that), but for work done by people (and especially for coding work), that is not the way. You need to know exactly what is required so that you can do <span class="No-Break">it precisely.</span></p>
			<p>A lot of the time, even the clients don’t know what they want; they have a vague idea that they want to act upon, but nothing beyond that. This ambiguity needs to be sorted out at the beginning of the project and it certainly should never spread to the code. Once something has been defined, then there is a way to do it that is the fastest, most secure, or most convenient (depending on requirements). This is the way that you need <span class="No-Break">to find.</span></p>
			<p>But, again, how do you find this way? It is not obvious to anyone who is not Dutch (a reference to the Dutch programmer Guido Van Rossum, the original author of Python). So, if you’re Dutch, you’re fine. If you’re not, read this story (it’s a much better fit for these principles than <span class="No-Break">regular code):</span></p>
			<p><em class="itali">Three friends were stranded on a boat with no food or water. These friends only had in their possession a lamp that seemed to be empty. One of the friends decided to rub the lamp, which caused a genie to appear. The genie granted each of the friends one wish since they had all summoned </em><span class="No-Break"><em class="itali">him together.</em></span></p>
			<p><em class="itali">The first friend made his wish: “I wish to be sent to my wife and children.” The wish was granted, and the friend disappeared, having been sent back to his family. The second friend wished to be sent back to his house in his hometown. This wish was similarly granted. The third friend, a loner, had nowhere he could think to go nor no one he could think to go to, so when his turn came, he said: “I wish I had my friends </em><span class="No-Break"><em class="itali">with me.”</em></span></p>
			<p>Now, this is an old story, but the way most people interpret it is that the friends were forcibly put back onto the boat by the third friend’s wish: a classic tale of <em class="itali">be careful what you wish for</em>. However, an engineer can read the story and come up with some other possible scenarios. Maybe the third wish brought back more than those two people (if he had more than two friends); maybe it brought back no one (if the other two weren’t considered friends, that would be a sad turn to the story), or it could even lead to an argument over what a <span class="No-Break">friend is.</span></p>
			<p>But most <a id="_idIndexMarker039"/>programming languages are like the genie. It does exactly what you tell it to do. If you’re vague, the room you give it for interpretation can cost you, so be careful and only wish for the exact thing you want. And people (such as our previous clients) are like, well, the people. They sometimes know what they want, they sometimes do not. But, to succeed, they need to know precisely what they want in both the context of the goal (getting home) and the context of the rules that govern them (they could’ve let the third friend go first if they doubted his intentions). This is quite a conundrum, <span class="No-Break">isn’t it?</span></p>
			<p>The key here – and this is <a id="_idIndexMarker040"/>something DevOps and <strong class="bold">Agile methodologies</strong> preach as well – is continuous improvement. Trying to continually find that one way. And if the scenario changes, tweaking the way to that scenario. This strategy is essential in coding, DevOps, machine learning, and practically every technology field. Iterative methodology helps turn even the vaguest goal into a bold mission statement and can provide <span class="No-Break">unified direction.</span></p>
			<p>The Dutch are a very direct people; only they could have invented a language as head-first as Python. Speaking of direct, you should probably read the next section now … or never, if you don’t have the time right now (see what I <span class="No-Break">did there?).</span></p>
			<h2 id="_idParaDest-45"><a id="_idTextAnchor050"/>Now or never</h2>
			<p>This is another <a id="_idIndexMarker041"/>one of those principle pairs that is more about the method of writing than the writing itself. The statements of <em class="itali">now</em> being better than <em class="itali">never</em> but <em class="itali">never</em> being better than <em class="itali">right now</em> may seem somewhat paradoxical, but they describe the nature of writing code and delivering value <span class="No-Break">through it.</span></p>
			<p><em class="itali">Now</em> doesn’t mean <em class="itali">right this second</em>. It is meant to represent the near future and in that near future, the code we have written has delivered value. This is opposed to never releasing the code at all or releasing it in an unrealistically long timeframe, by the end of which the written code might become irrelevant. As Steve Jobs used <span class="No-Break">to say:</span></p>
			<p><em class="itali">Real </em><span class="No-Break"><em class="itali">artists ship</em></span><span class="No-Break">.</span></p>
			<p>However, <em class="itali">right now</em> is also never a good time. To release something too early, with no thought put into it, no understanding, and no game plan, can result in disaster. The basic lesson <a id="_idIndexMarker042"/>there is to look before you leap. And if you leap into a volcano, you probably didn’t do your <span class="No-Break">due diligence.</span></p>
			<p>One of the reasons that <em class="itali">right now</em> is looked at as not a good time is because right now, there are no good ideas. There are never any good ideas right now; you kind of have to wait for your brain to come up with one. You push too hard trying to get something through that is hard to explain – that is a bad idea. That is how we can explain all the stupid trades that general managers make in sports at the <span class="No-Break">trade deadline.</span></p>
			<h2 id="_idParaDest-46"><a id="_idTextAnchor051"/>Hard-bad/easy-good</h2>
			<p>If you’re having a hard time explaining something, it is probably a bad idea. There’s not much to <a id="_idIndexMarker043"/>explain there – that’s just common sense. A complex vision is no vision at all. It needs to be reduced, simplified, and shaped into something that most people can understand (or at least <span class="No-Break">work toward).</span></p>
			<p>An idea that is complicated is simply an idea that hasn’t been reduced to its most useful, simplest component yet. As the old adage goes, there is always a ratio of 20% of the effort producing 80% of the output. To create the good idea, we just need to bring out and work on <span class="No-Break">that 20%.</span></p>
			<h2 id="_idParaDest-47"><a id="_idTextAnchor052"/>Namespaces</h2>
			<p>The lone zen, <strong class="bold">na</strong><strong class="bold">mespaces</strong> are just <a id="_idIndexMarker044"/>import statements written in ways that don’t cause conflicts. In this example, there are two libraries, <strong class="sour e-inline">lib1</strong> and <strong class="sour e-inline">lib2</strong>, both containing methods named <strong class="sour e-inline">example</strong>. What would be the solution that allows both of the methods to be imported into one Python file? You can just change one or both of their names to <span class="No-Break">unique namespaces:</span></p>
			<ul>
				<li>Code <span class="No-Break">without namespaces:</span><pre class="sour e- ode">from lib1 import example
from lib2 import example
 This is bound to cause conflicts """</pre></li>
				<li>Code <span class="No-Break">with namespaces:</span><pre class="sour e- ode">from lib1 import example as ex1
from lib2 import example as ex2
#This won't cause conflicts</pre></li>
			</ul>
			<p>A honking <a id="_idIndexMarker045"/>great <span class="No-Break">idea indeed.</span></p>
			<p>Through these principles, you can observe how Python has evolved into the language that it is and how it has distinguished itself from all the other programming languages. These changes have also helped make Python a language that aligns itself with DevOps principles. So, let’s now observe the marriage between the principles behind Python and DevOps and how they are mutually beneficial to <span class="No-Break">each other.</span></p>
			<h1 id="_idParaDest-48"><a id="_idTextAnchor053"/>What Python offers DevOps</h1>
			<p>In the previous section, we focused on the principles of Python. Now, we are going to look into what <a id="_idIndexMarker046"/>following those principles offers DevOps as a practice and DevOps engineers in general. The principles behind DevOps and Python are more similar than they are different. They both share an emphasis on flexibility, automation, and conciseness. This makes Python and DevOps a perfect pairing in the field of DevOps. Even for DevOps professionals who may not have the sharpest coding skills, Python is easy to pick up, easy to use, and can be integrated with practically every tool and platform because almost all these platforms have native support and libraries <span class="No-Break">in Python.</span></p>
			<p>I previously stated that the reason that Python is so pervasive in DevOps is that it handles data that resides between curly brackets (<em class="itali">{}</em>) better than almost any other language. The offerings of Python for DevOps are numerous and will be covered in further detail in future chapters. Right now, we will go over some of these offerings <span class="No-Break">in brief.</span></p>
			<h2 id="_idParaDest-49"><a id="_idTextAnchor054"/>Operating systems</h2>
			<p>Python has native libraries that interact with the OS of any server that it is currently working on. These <a id="_idIndexMarker047"/>libraries allow for programmatic access to various OS processes. This is especially useful when you work with virtual machines on <a id="_idIndexMarker048"/>the cloud (such as with <strong class="bold">Amazon EC2</strong>). You can do things such as <span class="No-Break">the following:</span></p>
			<ul>
				<li>Set environment variables in <span class="No-Break">the OS</span></li>
				<li>Get information about files <span class="No-Break">or directories</span></li>
				<li>Manipulate, create, or delete files <span class="No-Break">and directories</span></li>
				<li>Kill or spawn processes <span class="No-Break">and threads</span></li>
				<li>Create temporary files and <span class="No-Break">file locations</span></li>
				<li>Run <span class="No-Break">Bash scripts</span></li>
			</ul>
			<p>OSs are nice and all, but they can be difficult to maintain in a desired state with ideal resource usage. For this challenge, we have a common solution <span class="No-Break">in containerization.</span></p>
			<h2 id="_idParaDest-50"><a id="_idTextAnchor055"/>Containerization</h2>
			<p><strong class="bold">Containers</strong> are made <a id="_idIndexMarker049"/>using the <strong class="bold">Docker</strong> library. The creation, destruction, and modification <a id="_idIndexMarker050"/>of containers can be automated <a id="_idIndexMarker051"/>and orchestrated using Python. It provides a way to programmatically <a id="_idIndexMarker052"/>maintain and modify container states. Some applications include <span class="No-Break">the following:</span></p>
			<ul>
				<li>Interaction with Docker API for commands, such as getting a list of Docker containers or images present in <span class="No-Break">the OS</span></li>
				<li>Automatically <a id="_idIndexMarker053"/>generating <strong class="bold">Docker Compose files</strong> from a list of <span class="No-Break">Docker images</span></li>
				<li>Building <span class="No-Break">Docker images</span></li>
				<li>Orchestrating <a id="_idIndexMarker054"/>containers using the <span class="No-Break"><strong class="bold">Kubernetes library</strong></span></li>
				<li>Testing and verifying <span class="No-Break">Docker images</span></li>
			</ul>
			<p>You may be wondering what the point of containers is, and that may be because you’ve never gotten <a id="_idIndexMarker055"/>tired of the constant online discourse over OSs and <a id="_idIndexMarker056"/>frameworks and which ones are superior (in fact, you may have even encouraged such malarkey). But, containers exist for those who tire of such debate and instead want isolated environments for all their specific operating needs. So they made one with containers, and someone had the bright idea to call <span class="No-Break">them microservices.</span></p>
			<h2 id="_idParaDest-51"><a id="_idTextAnchor056"/>Microservices</h2>
			<p>Sometimes, containers and <strong class="bold">microservices</strong> are used interchangeably, but in modern DevOps that <a id="_idIndexMarker057"/>is not necessarily the case. Yes, it is containers that make microservices possible, but t the overall writing of microservices on top of those <a id="_idIndexMarker058"/>containers is efficient code that has the most bang for its buck. Some reasons for Python use in microservices are <span class="No-Break">as follows:</span></p>
			<ul>
				<li>Strong native library support inside of a Python container – libraries such as <strong class="bold">json</strong>, <strong class="bold">asyncio</strong>, <span class="No-Break">and </span><span class="No-Break"><strong class="bold">subprocess</strong></span></li>
				<li>Excellent native code modules that simplify certain iterative and manipulative operations on data such as the <span class="No-Break"><strong class="sour e-inline">collection</strong></span><span class="No-Break"> module</span></li>
				<li>Ability to properly natively handle semi-structured and varied JSON data that is usually used <span class="No-Break">in microservices</span></li>
			</ul>
			<p>To have these microservices interact with each other effectively and consistently, we need some repetition, some consistent repetition. What’s the word I’m looking for ... automaton ... no, that’s a robot ... autograph ... no, that’ll be what I do once this book becomes a bestseller ... automation, yes, that’s the <span class="No-Break">word. Automation.</span></p>
			<p><strong class="bold">Automation</strong> is probably <a id="_idIndexMarker059"/>the primary selling point for DevOps engineers when <a id="_idIndexMarker060"/>it comes to Python because of its incredible <strong class="bold">automation library</strong> and support features. Most systems guys who transition to DevOps prefer <a id="_idIndexMarker061"/>their precious <strong class="bold">Bash scripting</strong>, and that does have a place in environments such as these, but Python is more powerful and more flexible, and it is better supported by the community and the companies in the industry overall. Some applications <a id="_idIndexMarker062"/>of Python for automation in this case would be <a id="_idIndexMarker063"/><span class="No-Break">the following:</span></p>
			<ul>
				<li>Various <strong class="bold">Software Development Kits</strong> (<strong class="bold">SDKs</strong>) for <a id="_idIndexMarker064"/>cloud-based deployments in <strong class="bold">AWS</strong>, <strong class="bold">Azure</strong>, <strong class="bold">Google Cloud</strong>, and <span class="No-Break">other providers</span></li>
				<li>Support for automated building and testing <span class="No-Break">of applications</span></li>
				<li>Support for monitoring applications and <span class="No-Break">sending notifications</span></li>
				<li>Support for parsing and scraping necessary data from web pages, databases, and various other sources <span class="No-Break">of data</span></li>
			</ul>
			<p>Now that we have talked the talk, let’s walk a little. A light jog to combine Python <span class="No-Break">and DevOps.</span></p>
			<h1 id="_idParaDest-52"><a id="_idTextAnchor057"/>A couple of simple DevOps tasks in Python</h1>
			<p>I have so far preached to you the virtues of DevOps and the virtues of Python but so far, I have shown <a id="_idIndexMarker065"/>you very little of how the two work together. Now, we get to that part. Here, I will demonstrate a couple of examples of how to use <a id="_idIndexMarker066"/>Python to automate some regular DevOps tasks that some engineers may have to perform on a daily basis. These two examples will be from AWS, though they are applicable in other big clouds as well and can be applied on most data center servers if you have the <span class="No-Break">right APIs.</span></p>
			<p>The code for this chapter and all future chapters are stored in this <span class="No-Break">repository: </span><a href="https://github.com/PacktPublishing/Hands-On-Python-for-DevOps"><span class="No-Break">https://github.com/PacktPublishing/Hands-On-Python-for-DevOps</span></a><a href="https://github.com/PacktPublishing/Hands-on-Python-for-DevOps"/></p>
			<h2 id="_idParaDest-53"><a id="_idTextAnchor058"/>Automated shutdown of a server</h2>
			<p>Oftentimes, there is the case of certain servers that only need to be up during working hours and <a id="_idIndexMarker067"/>then need to be switched off afterward. Now, this <a id="_idIndexMarker068"/>particular scenario has a lot of caveats, which include the platform used, the accounts where the servers are running, and how working hours are measured…but for this scenario, we are simply going to shut our EC2 servers <a id="_idIndexMarker069"/>down in an AWS account using an <strong class="bold">AWS Lambda</strong> function microservice that runs a Python script that leverages the <strong class="bold">boto3 library</strong>. That sounds <a id="_idIndexMarker070"/>like a lot? Let’s break <span class="No-Break">it down.</span></p>
			<p>In my AWS account, I have two EC2 instances running. Every second that they run costs me money. However, I need them during business hours. Here <span class="No-Break">they are:</span></p>
			<div>
				<div id="_idContainer013" class="IMG---Figure">
					<img src="image/B21320_02_2.jpg" alt="Figure 2.2 – Running instances"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.2 – Running instances</p>
			<p>Creatively named, I know. But they are running, and there will come a point in time when I want <a id="_idIndexMarker071"/>them to not be running. So, to achieve that, I need to find some way to stop them. I could stop them one by one, but that’s <a id="_idIndexMarker072"/>tedious. And would I still do that if these 2 instances were 1,000 instances? No. So, we need to find <span class="No-Break">another way.</span></p>
			<p>We could try the <strong class="bold">command-line interface</strong> (<strong class="bold">CLI</strong>), but this is a coding book and not a CLI book, so we <a id="_idIndexMarker073"/>won’t. Though, keep it in mind if you want to try it. So, let’s look to our old friend Python, and also to a service that allows you to deploy a function that you can call at any time, called AWS Lambda. Here are the steps to create a Lambda function and use it to start and stop an <span class="No-Break">EC2 instance:</span></p>
			<ol>
				<li>Let’s create a function called <strong class="sour e-inline">stopper</strong> with the latest available Python runtime (3.10 for <span class="No-Break">this book):</span></li>
			</ol>
			<div>
				<div id="_idContainer014" class="IMG---Figure">
					<img src="image/B21320_02_3.jpg" alt="Figure 2.3 – Creating a Lambda function"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.3 – Creating a Lambda function</p>
			<ol>
				<li value="2">Next, you will either have to create an execution role for the Lambda function or give it an existing one. This will be important later. But for now, do the one you prefer. Click <strong class="bold">Create function</strong> to create your new <span class="No-Break">blank canvas.</span><p class="list-inset">The reason we are using the AWS environment for the microservices to manipulate EC2 instances (other than the obvious reasons) is that the runtime that they <a id="_idIndexMarker074"/>provide comes with the <strong class="sour e-inline">boto3</strong> library by default, which is very useful for <span class="No-Break">resource interaction.</span></p></li>
				<li>Before we <a id="_idIndexMarker075"/>can start or stop any instance, we need to list them out. You have to load and dump the return function once to handle the <strong class="sour e-inline">datetime</strong> data type. For now, let’s just initialize the <strong class="sour e-inline">boto3</strong> client for EC2 and try and list all of the instances that are <span class="No-Break">currently available:</span></li>
			</ol>
			<div>
				<div id="_idContainer015" class="IMG---Figure">
					<img src="image/B21320_02_4.jpg" alt="Figure 2.4 – Initial code to describe instances"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.4 – Initial code to describe instances</p>
			<p class="list-inset">Running this with a test will get you an exception thrown similar <span class="No-Break">to this:</span></p>
			<div>
				<div id="_idContainer016" class="IMG---Figure">
					<img src="image/B21320_02_5.jpg" alt="Figure 2.5 – Authorization exception"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.5 – Authorization exception</p>
			<p class="list-inset">That is <a id="_idIndexMarker076"/>because the Lambda function also has an <strong class="bold">identity and access management</strong> (<strong class="bold">IAM</strong>) role, and that role does not have the required permissions to describe the instances. So, let’s set the permissions that we <span class="No-Break">may need.</span></p>
			<ol>
				<li value="4">As shown in the following figure, under <strong class="bold">Configuration</strong> | <strong class="bold">Permissions</strong>, you will find the role assigned to the <span class="No-Break">Lambda function:</span></li>
			</ol>
			<div>
				<div id="_idContainer017" class="IMG---Figure">
					<img src="image/B21320_02_6.jpg" alt="Figure 2.6 – Finding the role for permissions"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.6 – Finding the role for permissions</p>
			<ol>
				<li value="5">On the <a id="_idIndexMarker077"/>page for the role, go to <strong class="bold">Add permissions</strong> and then <span class="No-Break"><strong class="bold">Attach policies</strong></span><span class="No-Break">:</span></li>
			</ol>
			<div>
				<div id="_idContainer018" class="IMG---Figure">
					<img src="image/B21320_02_7.jpg" alt="Figure 2.7 – Attaching a permission"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.7 – Attaching a permission</p>
			<p class="list-inset">Let’s give <a id="_idIndexMarker078"/>the Lambda function full access to the EC2 services since we will need it to stop the instance as well. If you prefer or if you feel that’s too much access, you can make a <span class="No-Break">custom role:</span></p>
			<div>
				<div id="_idContainer019" class="IMG---Figure">
					<img src="image/B21320_02_8.jpg" alt="Figure 2.8 – Attaching the appropriate permission"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.8 – Attaching the appropriate permission</p>
			<ol>
				<li value="6">Let’s run this again and see <span class="No-Break">the results:</span></li>
			</ol>
			<div>
				<div id="_idContainer020" class="IMG---Figure">
					<img src="image/B21320_02_9.jpg" alt="Figure 2.9 – Successful code run"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.9 – Successful code run</p>
			<p class="list-inset">You’ll see <a id="_idIndexMarker079"/>the display of instances as well as information regarding whether they are running <span class="No-Break">or not.</span></p>
			<ol>
				<li value="7">Now, let’s get <a id="_idIndexMarker080"/>to the part where we shut down the running instances. Add code to filter among the instances for ones that are running and get a list of their IDs, which we will use to reference the instances we want <span class="No-Break">to stop:</span></li>
			</ol>
			<div>
				<div id="_idContainer021" class="IMG---Figure">
					<img src="image/B21320_02_10.jpg" alt="Figure 2.10 – Adding code that stops the instances"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.10 – Adding code that stops the instances</p>
			<p class="list-inset">Simple <a id="_idIndexMarker081"/>enough to understand, especially if we are <a id="_idIndexMarker082"/>following the principle of readability <span class="No-Break">and explicitness.</span></p>
			<p class="list-inset">The instances are now in a state where they are shutting down. And soon, they will <span class="No-Break">be stopped:</span></p>
			<div>
				<div id="_idContainer022" class="IMG---Figure">
					<img src="image/B21320_02_11.jpg" alt="Figure 2.11 – Shut down instances"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.11 – Shut down instances</p>
			<ol>
				<li value="8">Now that <a id="_idIndexMarker083"/>we have done it once, let’s automate it further by using a service called EventBridge, which can trigger that function every day. Navigate to <strong class="bold">Amazon EventBridge</strong> and make an <span class="No-Break">EventBridge schedule:</span></li>
			</ol>
			<div>
				<div id="_idContainer023" class="IMG---Figure">
					<img src="image/B21320_02_12.jpg" alt="Figure 2.12 – Setting up a cron job on EventBridge"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.12 – Setting up a cron job on EventBridge</p>
			<ol>
				<li value="9">Select <a id="_idIndexMarker084"/>our Lambda <a id="_idIndexMarker085"/>function as the <span class="No-Break">event target:</span></li>
			</ol>
			<div>
				<div id="_idContainer024" class="IMG---Figure">
					<img src="image/B21320_02_13.jpg" alt="Figure 2.13 – Selecting Lambda to invoke for EventBridge"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.13 – Selecting Lambda to invoke for EventBridge</p>
			<p>You can <a id="_idIndexMarker086"/>now create the EventBridge scheduled event, which <a id="_idIndexMarker087"/>will trigger at 8 P.M. every day and list and shut down your <span class="No-Break">EC2 instances.</span></p>
			<p>So, in following these steps, you now have the tools necessary to schedule the shutdown of instances based on the timed schedule that <span class="No-Break">you want.</span></p>
			<h2 id="_idParaDest-54"><a id="_idTextAnchor059"/>Autopull a list of Docker images</h2>
			<p>Grabbing <a id="_idIndexMarker088"/>Docker images can be tedious. Especially <a id="_idIndexMarker089"/>grabbing multiple images. So now, we are going to see how we can pull a number of Docker images at the same time using the Python library <span class="No-Break">for Docker:</span></p>
			<ol>
				<li>First, install the Docker Python library in a virtual environment using the <span class="No-Break">following command:</span><pre class="sour e- ode"><strong class="bold">pip install docker</strong></pre></li>
				<li>Then, write a script in a file called <strong class="sour e-inline">docker_pull.py</strong> to loop through a list of image names and pull them by leveraging the <span class="No-Break">Docker library:</span></li>
			</ol>
			<div>
				<div id="_idContainer025" class="IMG---Figure">
					<img src="image/B21320_02_14.jpg" alt="Figure 2.14 – Code to pull Docker images"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.14 – Code to pull Docker images</p>
			<ol>
				<li value="3">After this, run <a id="_idIndexMarker090"/>the file using <span class="No-Break">this command:</span><pre class="sour e- ode"><strong class="bold">python docker_pull.py</strong></pre><p class="list-inset">You can <a id="_idIndexMarker091"/>then run the <strong class="sour e-inline">docker images</strong> command to check out the Docker containers that you may <span class="No-Break">have locally:</span></p></li>
			</ol>
			<div>
				<div id="_idContainer026" class="IMG---Figure">
					<img src="image/B21320_02_15.jpg" alt="Figure 2.15 – List of Docker images"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 2.15 – List of Docker images</p>
			<p>So, this gives you a pretty nifty way to get the Docker containers you want with the tags that you want <span class="No-Break">on them.</span></p>
			<h1 id="_idParaDest-55"><a id="_idTextAnchor060"/>Summary</h1>
			<p>Python is not just about writing code; it is about a coding philosophy – a philosophy that has made Python incredibly popular among DevOps engineers. The writing of the Zen of Python affected the way that the language was developed, and we still see the consequences today in both Python and DevOps. Python’s philosophy offers the DevOps realm the programming language that fits <span class="No-Break">its philosophy.</span></p>
			<p>Python has numerous uses that facilitate a lot of DevOps tasks. So, hopefully, this chapter has given you some insights into what makes Python such a good companion for DevOps. In the next chapter, you will see that companionship in action and learn how to use your knowledge in a truly <span class="No-Break">hands-on way.</span></p>
		</div>
	</body></html>