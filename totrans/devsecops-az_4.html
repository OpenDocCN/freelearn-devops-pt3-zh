<html><head></head><body>
		<div id="_idContainer112">
			<h1 id="_idParaDest-71" class="chapter-number"><a id="_idTextAnchor072"/><st c="0">4</st></h1>
			<h1 id="_idParaDest-72"><a id="_idTextAnchor073"/><st c="2">Implementing Pre-commit Security Controls</st></h1>
			<p><st c="43">After the initial planning phase, the application development process shifts to the code development phase, which starts on developer systems or workspaces. </st><st c="201">Developers, while skilled in feature development and using coding languages, might not know or might overlook security details, leading to mistakes. </st><st c="350">If not detected and addressed early, these mistakes can lead to unintentional vulnerabilities that can potentially compromise that software or the data </st><span class="No-Break"><st c="502">it processes.</st></span></p>
			<p><st c="515">Additionally, if the development environment/workspace is poorly managed and maintained, it could result in an entry point for attackers to inject malicious code or components into </st><span class="No-Break"><st c="697">the software.</st></span></p>
			<p><st c="710">In this chapter, we will focus on security measures and checks that can be implemented before code changes are committed </st><a id="_idIndexMarker244"/><st c="832">to a </st><strong class="bold"><st c="837">version control system</st></strong><st c="859"> (</st><strong class="bold"><st c="861">VCS</st></strong><st c="864">) by developers. </st><st c="882">This includes implementing security controls to reduce development environment risks and setting up security safeguards to identify and fix vulnerabilities and common mistakes before code is committed to the local code repository. </st><st c="1113">By the end of this chapter, you will have gained a solid understanding of the following </st><span class="No-Break"><st c="1201">key areas:</st></span></p>
			<ul>
				<li><st c="1211">Approaches to maintaining a secure </st><span class="No-Break"><st c="1247">development environment/workspace</st></span></li>
				<li><st c="1280">Techniques to prevent the inclusion of sensitive files or secrets </st><span class="No-Break"><st c="1347">in code</st></span></li>
				<li><st c="1354">Use of security extensions in IDEs for real-time </st><span class="No-Break"><st c="1404">security feedback</st></span></li>
				<li><st c="1421">Implementing pre-commit checks to ensure code safety before committing to the </st><span class="No-Break"><st c="1500">local repository</st></span></li>
			</ul>
			<p><st c="1516">These topics will equip you with the necessary knowledge and skills to integrate security practices into the code development phase of a DevOps workflow. </st><st c="1671">Let’s </st><span class="No-Break"><st c="1677">dive in!</st></span></p>
			<h1 id="_idParaDest-73"><a id="_idTextAnchor074"/><st c="1685">Technical requirements</st></h1>
			<p><st c="1708">To follow along with the instructions in this chapter, you will need </st><span class="No-Break"><st c="1778">the following:</st></span></p>
			<ul>
				<li><st c="1792">A PC with an </st><span class="No-Break"><st c="1806">internet connection</st></span></li>
				<li><st c="1825">An active </st><span class="No-Break"><st c="1836">Azure subscription</st></span></li>
				<li><st c="1854">An Azure </st><span class="No-Break"><st c="1864">DevOps organization</st></span></li>
				<li><st c="1883">A GitHub </st><span class="No-Break"><st c="1893">Enterprise organization</st></span></li>
			</ul>
			<h1 id="_idParaDest-74"><a id="_idTextAnchor075"/><st c="1916">Overview of the pre-commit coding phase of DevOps</st></h1>
			<p><st c="1966">In the </st><em class="italic"><st c="1974">Understanding the stages in a DevOps workflow</st></em><st c="2019"> section from </st><a href="B19710_01.xhtml#_idTextAnchor016"><span class="No-Break"><em class="italic"><st c="2033">Chapter 1</st></em></span></a><st c="2042">, </st><em class="italic"><st c="2044">Agile, DevOps, and Azure Overview</st></em><st c="2077">, we outlined the eight stages of a standard DevOps workflow. </st><st c="2139">While the implementation of these stages can differ among organizations, and some stages might even be combined for efficiency, the general sequence</st><a id="_idIndexMarker245"/><st c="2287"> remains consistent. </st><st c="2308">After the planning phase, the process moves to the code development stage, which begins with the developer environment. </st><st c="2428">To make our discussion in this book clearer and more structured, we have split the code development stage into </st><span class="No-Break"><st c="2539">two parts:</st></span></p>
			<ul>
				<li><strong class="bold"><st c="2549">The pre-commit phase</st></strong><st c="2570">: This </st><a id="_idIndexMarker246"/><st c="2578">phase refers to all activities that take place from the moment a developer starts writing or modifying code to a new or cloned repository until just before they save (or </st><em class="italic"><st c="2748">commit</st></em><st c="2754">) these changes to a VCS. </st><st c="2781">As shown in </st><em class="italic"><st c="2793">step 1</st></em><st c="2799"> of </st><span class="No-Break"><em class="italic"><st c="2803">Figure 4</st></em></span><em class="italic"><st c="2811">.1</st></em><st c="2813">, the developer sets up a workspace, usually in an IDE such as Visual Studio Code. </st><st c="2896">This space holds the code and its related configuration files and is where code changes happen. </st><st c="2992">After making the necessary changes, the developer </st><em class="italic"><st c="3042">stages</st></em><st c="3048"> these modifications using the </st><strong class="source-inline"><st c="3079">git add</st></strong><st c="3086"> operation, signaling that these changes are ready to be saved or committed (</st><em class="italic"><st c="3163">step 2</st></em><st c="3170"> of </st><span class="No-Break"><em class="italic"><st c="3174">Figure 4</st></em></span><em class="italic"><st c="3182">.1</st></em><st c="3184">). </st><st c="3188">The developer then proceeds to save the staged changes to their local repository using the </st><strong class="source-inline"><st c="3279">git commit</st></strong><st c="3289"> operation (</st><em class="italic"><st c="3301">step 3</st></em><st c="3308"> of </st><span class="No-Break"><em class="italic"><st c="3312">Figure 4</st></em></span><em class="italic"><st c="3320">.1</st></em><st c="3322">). </st><st c="3326">This not only stores the changes but also logs a record of the modifications. </st><st c="3404">It is worth noting that most times, staging and committing are done as a single operation </st><span class="No-Break"><st c="3494">for convenience.</st></span></li>
				<li><strong class="bold"><st c="3510">The source control management phase</st></strong><st c="3546">: After local commitment to their code </st><a id="_idIndexMarker247"/><st c="3586">changes, the </st><a id="_idIndexMarker248"/><st c="3599">developer’s next move is to update the central repository by </st><em class="italic"><st c="3660">pushing</st></em><st c="3667"> these changes using the </st><strong class="source-inline"><st c="3692">git push</st></strong><st c="3700"> operation. </st><st c="3712">This phase is all about managing the code in that </st><span class="No-Break"><st c="3762">central repository:</st></span></li>
			</ul>
			<div>
				<div id="_idContainer071" class="IMG---Figure">
					<img src="image/B19710_04_01.jpg" alt="Figure 4.1 – The code development phase of DevOps"/><st c="3781"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="3974">Figure 4.1 – The code development phase of DevOps</st></p>
			<p><st c="4023">Given that our primary attention in this chapter is on the </st><em class="italic"><st c="4083">pre-commit phase</st></em><st c="4099">, it is essential to get some understanding of the developer environment where the activities occur. </st><st c="4200">The choice of development environment plays a pivotal role in how security is implemented during this phase. </st><st c="4309">Let us take a closer look at the available development environment options before we discuss their implications </st><span class="No-Break"><st c="4421">for security.</st></span></p>
			<p class="callout-heading"><st c="4434">Note</st></p>
			<p class="callout"><st c="4439">Our aim is not to extensively cover developer environments and tooling but to provide a broad overview of the options available. </st><st c="4569">We believe it is beneficial for those overseeing the security of DevOps practices to understand these options and their associated </st><span class="No-Break"><st c="4700">security risks.</st></span></p>
			<h2 id="_idParaDest-75"><a id="_idTextAnchor076"/><st c="4715">Understanding the developer environment options</st></h2>
			<p><st c="4763">Traditionally, developers </st><a id="_idIndexMarker249"/><st c="4790">use a local workstation as their development environment. </st><st c="4848">Depending on the organization device setup process, this may or may not come with essential tools for coding and contributing to a project, such as Git for source control, the required language SDKs, and an IDE such as Visual Studio or Visual Studio Code. </st><st c="5104">Additionally, many extensions and tools, including AI ones such as GitHub Copilot, are </st><span class="No-Break"><st c="5191">commonly added.</st></span></p>
			<p><st c="5206">Using a local workstation for development has several drawbacks, the primary one being the delay in reaching a productive state. </st><st c="5336">Setting up the environment with all required installations, such as the IDE, SDKs, extensions, and libraries, can be time-consuming. </st><st c="5469">It might take hours, days, or even longer for a developer to become productive after joining a project. </st><st c="5573">As an example, in a recent discussion I (David) had with an engineering lead, they shared that it typically takes a month for a developer to submit their first PR after joining a project in </st><span class="No-Break"><st c="5763">their organization!</st></span></p>
			<p><st c="5782">Another downside of the local workstation is that if the system crashes or needs replacement, the entire setup process typically has to be repeated. </st><st c="5932">This can be avoided if there is a continuous backup, but most workstations do not have one. </st><st c="6024">Another challenge is for developers who are juggling multiple projects. </st><st c="6096">In medium to large organizations, it is uncommon for developers to focus solely on one project. </st><st c="6192">They often work across different projects or contribute to several simultaneously. </st><st c="6275">Sometimes, the tools needed for one project might conflict with another, making it difficult for a developer to transition smoothly from one project to another. </st><st c="6436">Another issue arises from the limited computational resources of local workstations when working with large projects such </st><a id="_idIndexMarker250"/><st c="6558">as </st><strong class="bold"><st c="6561">machine learning</st></strong><st c="6577"> (</st><strong class="bold"><st c="6579">ML</st></strong><st c="6581">) models or complex </st><span class="No-Break"><st c="6602">monolithic applications.</st></span></p>
			<p><st c="6626">From a security perspective, local developer workstations are often connected to a company’s internal network either directly or through VPNs. </st><st c="6770">If these computers get breached, the threat is not just about an attacker getting the source code; it also opens up the possibility to move sideways within the network to access other systems and data. </st><st c="6972">This lateral movement can lead to broader breaches and more </st><span class="No-Break"><st c="7032">significant damage.</st></span></p>
			<p><st c="7051">To address these challenges, organizations are exploring modern development environment options such as </st><span class="No-Break"><st c="7156">the following:</st></span></p>
			<ul>
				<li><strong class="bold"><st c="7170">Cloud-hosted development workstations</st></strong><st c="7208">: Examples include </st><strong class="bold"><st c="7228">Platform as a Service</st></strong><st c="7249"> (</st><strong class="bold"><st c="7251">PaaS</st></strong><st c="7255">) solutions</st><a id="_idIndexMarker251"/><st c="7267"> such as </st><strong class="bold"><st c="7276">Azure Virtual Desktop</st></strong><st c="7297"> (</st><strong class="bold"><st c="7299">AVD</st></strong><st c="7302">) or </st><strong class="bold"><st c="7308">Software as a Service</st></strong><st c="7329"> (</st><strong class="bold"><st c="7331">SaaS</st></strong><st c="7335">) offerings such as Azure’s </st><strong class="bold"><st c="7364">Dev Box</st></strong><st c="7371">. Dev Box is a </st><a id="_idIndexMarker252"/><st c="7386">cloud workstation </st><a id="_idIndexMarker253"/><st c="7404">designed for developers. </st><st c="7429">It gives them quick access to </st><a id="_idIndexMarker254"/><st c="7459">powerful computers that are ready for coding. </st><st c="7505">These workstations are set up by development</st><a id="_idIndexMarker255"/><st c="7549"> teams with the tools they need. </st><st c="7582">IT teams</st><a id="_idIndexMarker256"/><st c="7590"> can manage these cloud workstations similarly to regular laptops. </st><st c="7657">They can implement security hardening, deploy tools, audit, and maintain the environment using automation to minimize the risk of data loss. </st><st c="7798">Developers also like it because they can transition between different Dev Box workstations that are provisioned for each project, plus they can save costs by putting the workstations in a low-power hibernation mode when not </st><span class="No-Break"><st c="8022">in use.</st></span></li>
				<li><strong class="bold"><st c="8029">Cloud-hosted IDEs</st></strong><st c="8047">: Recently, cloud IDEs</st><a id="_idIndexMarker257"/><st c="8070"> have become a favored choice for code development. </st><st c="8122">They offer developers the ability to write, run, and debug code directly from a web browser without the need for a local development environment. </st><st c="8268">The most </st><a id="_idIndexMarker258"/><st c="8277">common ones are GitHub Codespaces, </st><strong class="bold"><st c="8312">Amazon Web Services</st></strong><st c="8331"> (</st><strong class="bold"><st c="8333">AWS</st></strong><st c="8336">) Cloud9, Gitpod, Codeanywhere, and </st><span class="No-Break"><st c="8373">Eclipse Che.</st></span><p class="list-inset"><st c="8385">Cloud IDEs address many challenges of local workstations. </st><st c="8444">They significantly reduce </st><strong class="bold"><st c="8470">time to productivity</st></strong><st c="8490"> (</st><strong class="bold"><st c="8492">TTP</st></strong><st c="8495">) so</st><a id="_idIndexMarker259"/><st c="8500"> that developers can start coding in mere minutes after joining a project instead of waiting hours or days for tool installations. </st><st c="8631">For resource-intensive projects, cloud IDEs, such as GitHub Codespaces, can scale up to 32 CPU cores and 64 GB RAM. </st><st c="8747">That is a lot of power! </st><st c="8771">Additionally, when working on multiple projects, developers can maintain a separate workspace for each project, ensuring no tool </st><span class="No-Break"><st c="8900">conflicts arise.</st></span></p><p class="list-inset"><span class="No-Break"><em class="italic"><st c="8916">Figure 4</st></em></span><em class="italic"><st c="8925">.2</st></em><st c="8927"> shows the architecture of a GitHub Codespace cloud IDE. </st><st c="8984">As shown, the codespace is hosted in a container running on a Linux </st><strong class="bold"><st c="9052">virtual machine</st></strong><st c="9067"> (</st><strong class="bold"><st c="9069">VM</st></strong><st c="9071">) in</st><a id="_idIndexMarker260"/><st c="9076"> Azure. </st><st c="9084">We can choose our preferred editor to connect to it. </st><st c="9137">While we can code directly in the web browser, there is also the option to connect using various desktop IDEs, including Visual </st><span class="No-Break"><st c="9265">Studio Code:</st></span></p></li>
			</ul>
			<div>
				<div id="_idContainer072" class="IMG---Figure">
					<img src="image/B19710_04_02.jpg" alt="Figure 4.2 – GitHub codespace architecture"/><st c="9277"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="9689">Figure 4.2 – GitHub codespace architecture</st></p>
			<ul>
				<li><strong class="bold"><st c="9731">Local or hosted container dev environments</st></strong><st c="9774">: In the evolving landscape of software development, containerized</st><a id="_idIndexMarker261"/><st c="9841"> development environments are also gaining traction. </st><st c="9894">These</st><a id="_idIndexMarker262"/><st c="9899"> are like ready-made development environments that have everything needed to contribute to a project, and they can be used either locally or in the cloud. </st><st c="10054">A good example of this is dev containers, which integrate locally with the </st><em class="italic"><st c="10129">Visual Studio Code Dev Containers</st></em><st c="10162"> extension or in the cloud with </st><em class="italic"><st c="10194">GitHub Codespaces</st></em><st c="10211">. The heart of the dev container setup is the </st><strong class="source-inline"><st c="10257">devcontainer.json</st></strong><st c="10274"> file. </st><st c="10281">This file tells Visual Studio Code or GitHub Codespaces how to create (or access) a development container with a well-defined tool and runtime stack needed for </st><span class="No-Break"><st c="10441">the project.</st></span><p class="list-inset"><st c="10453">The primary advantage of such a setup is the elimination of setup delays as developers can dive straight into coding without the hassles of setting up tools and dependencies. </st><st c="10629">It also has the added benefit of environment consistency. </st><st c="10687">When multiple developers collaborate on a project, this ensures that everyone contributes using a </st><span class="No-Break"><st c="10785">uniform environment.</st></span></p><p class="list-inset"><st c="10805">In </st><span class="No-Break"><em class="italic"><st c="10809">Figure 4</st></em></span><em class="italic"><st c="10817">.3</st></em><st c="10819">, we show how a dev container works in Visual Studio Code. </st><st c="10878">Basically, Visual Studio Code interprets the </st><strong class="source-inline"><st c="10923">devcontainer.json</st></strong><st c="10940"> file and creates a development container with a Visual Studio Code server. </st><st c="11016">It then mounts the workspace files from the local PC or clones them into the container. </st><st c="11104">Any </st><a id="_idIndexMarker263"/><st c="11108">extra extensions defined in the </st><strong class="source-inline"><st c="11140">devcontainer.json</st></strong><st c="11157"> file are installed inside the container. </st><st c="11199">This setup lets developers easily switch between different project environments by just connecting to </st><span class="No-Break"><st c="11301">another project:</st></span></p></li>
			</ul>
			<div>
				<div id="_idContainer073" class="IMG---Figure">
					<img src="image/B19710_04_03.jpg" alt="Figure 4.3 – Dev container in Visual Studio Code architecture"/><st c="11317"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="11400">Figure 4.3 – Dev container in Visual Studio Code architecture</st></p>
			<p><st c="11461">Having gained insight into the various development environment options available, it is essential to also understand the workflow of this stage. </st><st c="11607">In this chapter, our primary emphasis is on pre-commit security, so let us explore </st><span class="No-Break"><st c="11690">this further.</st></span></p>
			<h2 id="_idParaDest-76"><a id="_idTextAnchor077"/><st c="11703">Understanding the security categories in the pre-commit phase</st></h2>
			<p><st c="11765">There are two</st><a id="_idIndexMarker264"/><st c="11779"> main security categories that we will address for this phase. </st><st c="11842">The first focuses on effective security hygiene of the development environment or workspace where coding happens. </st><st c="11956">The second aims to reduce common security errors developers often commit </st><span class="No-Break"><st c="12029">during coding:</st></span></p>
			<div>
				<div id="_idContainer074" class="IMG---Figure">
					<img src="image/B19710_04_04.jpg" alt="Figure 4.4 – Two main security categories in the pre-commit coding phase of DevOps"/><st c="12043"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="12136">Figure 4.4 – Two main security categories in the pre-commit coding phase of DevOps</st></p>
			<p><st c="12218">Let’s start by addressing the first risk category and security mitigations to put </st><span class="No-Break"><st c="12301">in place.</st></span></p>
			<h1 id="_idParaDest-77"><a id="_idTextAnchor078"/><st c="12310">Securing the development environment</st></h1>
			<p><st c="12347">Attackers </st><a id="_idIndexMarker265"/><st c="12358">are increasingly targeting developer tools and workspaces (IDEs, extensions, SDKs), regardless of whether they are running locally or cloud-based, with the intent of interfering with pre-commit phase activities. </st><st c="12570">By compromising these, attackers can embed malicious code early in the software development process with the aim of impacting a broad number of </st><span class="No-Break"><st c="12714">downstream consumers.</st></span></p>
			<p><st c="12735">But why even target activities in the pre-commit phase? </st><st c="12792">Because it can sometimes allow them to bypass tighter security checks later in the process. </st><st c="12884">Unfortunately, many organizations tend to trust code from their developers without further scrutiny. </st><st c="12985">Attackers are looking to exploit this trust to sneak in undetected. </st><st c="13053">A notable example is the Solorigate </st><a id="_idIndexMarker266"/><st c="13089">breach in 2019, where hackers discreetly added 4,000 lines of malicious code at an early stage, which allowed the code to be officially approved and digitally signed after the code was committed to </st><span class="No-Break"><st c="13287">the repository.</st></span></p>
			<p class="callout-heading"><st c="13302">The Solorigate breach</st></p>
			<p class="callout"><st c="13324">For a detailed </st><a id="_idIndexMarker267"/><st c="13340">overview and timeline of the Solorigate breach, refer to this </st><span class="No-Break"><st c="13402">document: </st></span><a href="https://www.microsoft.com/en-us/security/blog/2020/12/18/analyzing-solorigate-the-compromised-dll-file-that-started-a-sophisticated-cyberattack-and-how-microsoft-defender-helps-protect/"><span class="No-Break"><st c="13412">https://www.microsoft.com/en-us/security/blog/2020/12/18/analyzing-solorigate-the-compromised-dll-file-that-started-a-sophisticated-cyberattack-and-how-microsoft-defender-helps-protect/</st></span></a></p>
			<p class="callout"><st c="13597">Some may know this breach as Sunburst, which is the name of the malware that </st><span class="No-Break"><st c="13675">was injected.</st></span></p>
			<p><st c="13688">And this is one of the mindset shifts that needs to happen as we adopt a DevOps workflow. </st><st c="13779">Security measures need to be strong right from</st><a id="_idIndexMarker268"/><st c="13825"> the early stages of the </st><strong class="bold"><st c="13850">software development life cycle</st></strong><st c="13881"> (</st><strong class="bold"><st c="13883">SDLC</st></strong><st c="13887">). </st><st c="13891">Trusting code just because it is from an internal source is risky. </st><st c="13958">Implicit trust should never be given! </st><st c="13996">As you mature in integrating security into your DevOps (DevSecOps), you need to ensure that code is only accepted after verifying the security of the developer’s environment and after the code itself undergoes a rigorous </st><span class="No-Break"><st c="14217">security review.</st></span></p>
			<p class="author-quote"><st c="14233">Implicit trust should never be given because the code is from an internal source!</st></p>
			<p><st c="14315">Let us now turn our attention to understanding some of the entry points for attackers into the development environment and addressing </st><span class="No-Break"><st c="14450">those risks.</st></span></p>
			<h2 id="_idParaDest-78"><a id="_idTextAnchor079"/><st c="14462">Risk 1 – IDE vulnerability risks</st></h2>
			<p><st c="14495">IDEs, as with other applications, can</st><a id="_idIndexMarker269"/><st c="14533"> have security flaws. </st><st c="14555">A</st><a id="_idIndexMarker270"/><st c="14556"> notable example is </st><strong class="bold"><st c="14576">CVE-2022-41034</st></strong><st c="14590">, a critical vulnerability in Visual Studio Code that could be exploited through a crafted link or website, to take over the workstation of a Visual Studio Code user! </st><st c="14757">This vulnerability also impacted GitHub Codespaces, GitHub’s web-based editor (</st><a href="https://github.dev"><st c="14836">https://github.dev</st></a><st c="14855">), and </st><a id="_idIndexMarker271"/><st c="14863">Visual Studio Code for the </st><span class="No-Break"><st c="14890">web (</st></span><a href="https://vscode.dev"><span class="No-Break"><st c="14895">https://vscode.dev</st></span></a><span class="No-Break"><st c="14914">).</st></span></p>
			<p><st c="14917">If you think these issues are less common, you will be mistaken. </st><st c="14983">Since January 2022, Visual Studio Code has reported at least six </st><strong class="bold"><st c="15048">remote code execution</st></strong><st c="15069"> (</st><strong class="bold"><st c="15071">RCE</st></strong><st c="15074">) vulnerabilities! </st><st c="15094">This is why it is vital to keep locally installed IDEs updated. </st><st c="15158">Managed development </st><a id="_idIndexMarker272"/><st c="15178">platforms such as GitHub Codespaces handle security updates automatically, reducing our maintenance tasks. </st><st c="15285">However, this does not cover plugins </st><span class="No-Break"><st c="15322">or extensions.</st></span></p>
			<p class="callout-heading"><st c="15336">Visual Studio Code vulnerability lookup</st></p>
			<p class="callout"><st c="15376">To</st><a id="_idIndexMarker273"/><st c="15379"> explore a list of disclosed vulnerabilities for Visual Studio Code, go to the following </st><span class="No-Break"><st c="15468">link: </st></span><a href="https://www.cvedetails.com/vulnerability-list/vendor_id-26/product_id-50646/Microsoft-Visual-Studio-Code.html"><span class="No-Break"><st c="15474">https://www.cvedetails.com/vulnerability-list/vendor_id-26/product_id-50646/Microsoft-Visual-Studio-Code.html</st></span></a></p>
			<p class="callout"><st c="15583">For more information on CVE-2022041034, refer to this </st><strong class="bold"><st c="15638">National Institute of Standards and Technology</st></strong><st c="15684"> (</st><strong class="bold"><st c="15686">NIST</st></strong><st c="15690">) </st><span class="No-Break"><st c="15693">link: </st></span><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-41034"><span class="No-Break"><st c="15699">https://nvd.nist.gov/vuln/detail/CVE-2022-41034</st></span></a></p>
			<p><st c="15746">On another note, using managed development environments such as GitHub Codespaces offers the added benefit of reduced lateral movement risk. </st><st c="15888">By isolating each development environment in its own VM and network, Codespaces ensures tighter security. </st><st c="15994">While it’s not foolproof against all threats, the potential for a breach to spread within the environment is </st><span class="No-Break"><st c="16103">significantly reduced!</st></span></p>
			<h2 id="_idParaDest-79"><a id="_idTextAnchor080"/><st c="16125">Risk 2 – Malicious and vulnerable IDE extensions</st></h2>
			<p><st c="16174">Visual Studio Code is a</st><a id="_idIndexMarker274"/><st c="16198"> lightweight IDE that has a strong ecosystem of extensions for extensibility. </st><st c="16276">Whatever task you aim to achieve in Visual Studio Code, there is likely an extension for it. </st><st c="16369">As of September 2023, the </st><a id="_idIndexMarker275"/><st c="16395">Visual Studio Code Marketplace (</st><a href="https://marketplace.visualstudio.com/vscode"><st c="16427">https://marketplace.visualstudio.com/vscode</st></a><st c="16471">) has over </st><span class="No-Break"><st c="16483">51,000+ extensions!</st></span></p>
			<div>
				<div id="_idContainer075" class="IMG---Figure">
					<img src="image/B19710_04_05.jpg" alt="Figure 4.5 – The Visual Studio Code Marketplace"/><st c="16502"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="17140">Figure 4.5 – The Visual Studio Code Marketplace</st></p>
			<p><st c="17187">When it</st><a id="_idIndexMarker276"/><st c="17195"> comes to extensions, trust is crucial! </st><st c="17235">Extensions in Visual Studio Code operate with the same rights as the logged-in user. </st><st c="17320">For many developers, this is the local administrator role. </st><st c="17379">This means that a malicious extension has the potential to install additional applications (which could be malicious) and modify code locally or remotely. </st><st c="17534">The impact of installing a malicious extension can </st><span class="No-Break"><st c="17585">be significant!</st></span></p>
			<p><st c="17600">To help mitigate this risk, developers must be able to evaluate the trustworthiness of an extension so that they only install </st><span class="No-Break"><st c="17727">trusted extensions.</st></span></p>
			<p><st c="17746">This is why developers must be able to evaluate the trustworthiness of an extension before installing it. </st><st c="17853">To help with this, Microsoft implements several measures to ensure the safety of extensions in </st><span class="No-Break"><st c="17948">the marketplace:</st></span></p>
			<div>
				<div id="_idContainer076" class="IMG---Figure">
					<img src="image/B19710_04_06.jpg" alt="Figure 4.6 – Visual Studio Code Marketplace extension security measures"/><st c="17964"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="18207">Figure 4.6 – Visual Studio Code Marketplace extension security measures</st></p>
			<p><st c="18278">Before </st><a id="_idIndexMarker277"/><st c="18286">publishing, extensions undergo a virus scan, followed by a check to prevent name squatting, for </st><em class="italic"><st c="18382">official</st></em><st c="18390"> publisher names (</st><span class="No-Break"><em class="italic"><st c="18408">Figure 4</st></em></span><em class="italic"><st c="18417">.6</st></em><st c="18419">). </st><st c="18423">After publishing, extensions are rescanned for viruses with every update by the publisher. </st><st c="18514">If the community reports an extension as malicious, Microsoft evaluates it. </st><st c="18590">If validated, the extension is removed from the marketplace and added to a </st><em class="italic"><st c="18665">kill list</st></em><st c="18674">, prompting Visual Studio Code to auto-uninstall it whenever it is installed (</st><span class="No-Break"><em class="italic"><st c="18752">Figure 4</st></em></span><span class="No-Break"><em class="italic"><st c="18761">.6</st></em></span><span class="No-Break"><st c="18763">).</st></span></p>
			<p><st c="18766">While Microsoft’s safety measures are commendable, they are not foolproof. </st><st c="18842">Many widely used extensions are created by community contributors who are not included in the name-squatting checks for official publishers. </st><st c="18983">A real risk is the impersonation of popular extensions to trick developers into installing them. </st><st c="19080">A case in point is research published by the team at Aqua Security. </st><st c="19148">They created an impersonated version of Prettier, a popular Visual Studio Code extension with millions of installs, and were able to publish it to the marketplace. </st><st c="19312">They named the URL of their version </st><strong class="source-inline"><st c="19348">pretier-vscode</st></strong><st c="19362"> (with a single </st><em class="italic"><st c="19378">t</st></em><st c="19379">), subtly differing from the genuine </st><strong class="source-inline"><st c="19416">prettier-vscode</st></strong><st c="19431"> (with a double </st><em class="italic"><st c="19447">t</st></em><st c="19448">) – see </st><span class="No-Break"><em class="italic"><st c="19456">Figure 4</st></em></span><em class="italic"><st c="19464">.7</st></em><st c="19466">. Within 48 hours of publishing it, they had about a thousand installs from developers in multiple countries around </st><span class="No-Break"><st c="19582">the world!</st></span></p>
			<div>
				<div id="_idContainer077" class="IMG---Figure">
					<img src="image/B19710_04_07.jpg" alt="Figure 4.7 – Comparing the genuine extension and an impersonation of the extension in the marketplace"/><st c="19592"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="19804">Figure 4.7 – Comparing the genuine extension and an impersonation of the extension in the marketplace</st></p>
			<p><st c="19905">Unfortunately, it </st><a id="_idIndexMarker278"/><st c="19924">may not be easy to enforce large-scale checks. </st><st c="19971">Some organizations may block the installation of unallowed extensions on their corporate firewalls or on endpoint firewalls, but this could also lead to friction in situations where developers perceive it as impacting their productivity negatively. </st><st c="20220">Also, using Codespaces allows a distinct list of approved extensions. </st><st c="20290">However, there is no way to prevent someone from syncing or adding in other extensions unless there is a policy for Visual Studio Code extensions in an org, which comes with various </st><span class="No-Break"><st c="20472">other problems.</st></span></p>
			<p><st c="20487">Developers will need to be trained to be cautious before installing extensions. </st><st c="20568">They should verify publisher details, read the reviews and ratings of the extension, and check the download count. </st><st c="20683">But this puts a security responsibility on developers. </st><st c="20738">Some practices, such as Workspace Trust, can help (we will cover this in the next section), but a better system to show and control extension permissions would be ideal. </st><st c="20908">There’s been an ongoing discussion about this since </st><span class="No-Break"><st c="20960">2018! </st><st c="20966">(</st></span><a href="https://github.com/microsoft/vscode/issues/52116"><span class="No-Break"><st c="20967">https://github.com/microsoft/vscode/issues/52116</st></span></a><span class="No-Break"><st c="21015">).</st></span></p>
			<p class="callout-heading"><st c="21018">Aqua Security research</st></p>
			<p class="callout"><st c="21041">To learn more</st><a id="_idIndexMarker279"/><st c="21055"> about Aqua Security’s research into the risk of Visual Studio Code’s extensions, please refer to this </st><span class="No-Break"><st c="21158">document: </st></span><a href="https://blog.aquasec.com/can-you-trust-your-vscode-extensions"><span class="No-Break"><st c="21168">https://blog.aquasec.com/can-you-trust-your-vscode-extensions</st></span></a></p>
			<h2 id="_idParaDest-80"><a id="_idTextAnchor081"/><st c="21229">Risk 3 – Working with untrusted code</st></h2>
			<p><st c="21266">Developers often</st><a id="_idIndexMarker280"/><st c="21283"> leverage open sourced code from various sources in their IDEs, including public or untrusted repositories. </st><st c="21391">For example, while researching a new feature or solution to a problem, they might look for open source projects or code snippets that address similar challenges and open them in their development environment to gain insights from them. </st><st c="21627">This practice, while beneficial, can introduce security risks. </st><st c="21690">Loading code from untrusted sources can expose developers to threats such as malicious code execution and compromised dependencies. </st><st c="21822">These threats can potentially steal access keys and tokens from the </st><span class="No-Break"><st c="21890">developer’s environment.</st></span></p>
			<p><st c="21914">Visual Studio Code, along with its extensions, offers multiple ways to execute code. </st><st c="22000">While these methods streamline the development process, they can provide an entry point for exploitation. </st><st c="22106">A notable example is the </st><strong class="source-inline"><st c="22131">launch.json</st></strong><st c="22142"> launch configuration file, which is located either in the project’s root folder or within the developer’s workspace settings. </st><st c="22269">This file allows developers to save debugging </st><span class="No-Break"><st c="22315">setup details:</st></span></p>
			<div>
				<div id="_idContainer078" class="IMG---Figure">
					<img src="image/B19710_04_08.jpg" alt="Figure 4.8 – Launch configuration attributes"/><st c="22329"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="22492">Figure 4.8 – Launch configuration attributes</st></p>
			<p><st c="22536">Within </st><strong class="source-inline"><st c="22544">launch.json</st></strong><st c="22555">, the </st><strong class="source-inline"><st c="22561">preLaunchTask</st></strong><st c="22574"> attribute defines a task to execute before debugging starts, and the </st><strong class="source-inline"><st c="22644">postDebugTask</st></strong><st c="22657"> attribute determines a task to run after the </st><a id="_idIndexMarker281"/><st c="22703">debugging session concludes (</st><span class="No-Break"><em class="italic"><st c="22732">Figure 4</st></em></span><em class="italic"><st c="22741">.8</st></em><st c="22743">). </st><st c="22747">While these attributes are designed to enhance the debugging experience, they can be manipulated by malicious actors. </st><st c="22865">An attacker could modify these tasks to run arbitrary, potentially </st><span class="No-Break"><st c="22932">harmful code.</st></span></p>
			<p class="callout-heading"><st c="22945">Note</st></p>
			<p class="callout"><st c="22950">For further details on launch configuration and its attributes, please refer to this </st><span class="No-Break"><st c="23036">document: </st></span><a href="https://code.visualstudio.com/docs/editor/debugging#_launchjson-attributes"><span class="No-Break"><st c="23046">https://code.visualstudio.com/docs/editor/debugging#_launchjson-attributes</st></span></a></p>
			<p><st c="23120">The risk amplifies when developers work with code from untrusted sources that come with a pre-set </st><strong class="source-inline"><st c="23219">launch.json</st></strong><st c="23230"> file. </st><st c="23237">Such configurations might contain tasks that execute </st><span class="No-Break"><st c="23290">malicious code.</st></span></p>
			<p><st c="23305">To mitigate this risk, Visual Studio Code introduced </st><a id="_idIndexMarker282"/><st c="23359">the </st><strong class="bold"><st c="23363">Workspace Trust</st></strong><st c="23378"> feature in May 2021 (version 1.57). </st><st c="23415">This feature adds an extra security layer when dealing with untrusted code. </st><st c="23491">When developers open such code, they are prompted by the Workspace Trust dialog to specify their trust level for the code. </st><st c="23614">If the code is deemed untrustworthy, Visual Studio Code enters a </st><span class="No-Break"><strong class="bold"><st c="23679">restricted mode</st></strong></span><span class="No-Break"><st c="23694">:</st></span></p>
			<div>
				<div id="_idContainer079" class="IMG---Figure">
					<img src="image/B19710_04_09.jpg" alt="Figure 4.9 – Workspace Trust prompt"/><st c="23696"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="24340">Figure 4.9 – Workspace Trust prompt</st></p>
			<p><st c="24375">This mode</st><a id="_idIndexMarker283"/><st c="24385"> prevents potentially harmful </st><a id="_idIndexMarker284"/><st c="24415">actions by disabling or limiting certain features, including the ability for tasks to run, debugging, workspace settings modification, and privileged extensions (</st><span class="No-Break"><em class="italic"><st c="24577">Figure 4</st></em></span><em class="italic"><st c="24586">.9</st></em><st c="24588">). </st><st c="24592">The responsibility of trusting code that is loaded ultimately lies with the developer. </st><st c="24679">Therefore, it is essential for developers to undergo continuous security training, ensuring they make informed decisions about which code </st><span class="No-Break"><st c="24817">to trust.</st></span></p>
			<p><st c="24826">To edit the Workspace Trust setting, we can always open the Command Palette using </st><em class="italic"><st c="24909">Ctrl</st></em><st c="24913"> + </st><em class="italic"><st c="24916">Shift</st></em><st c="24921"> + </st><em class="italic"><st c="24924">P</st></em><st c="24925"> and type </st><strong class="source-inline"><st c="24935">Workspaces: Manage </st></strong><span class="No-Break"><strong class="source-inline"><st c="24954">Workspace Trust</st></strong></span><span class="No-Break"><st c="24969">.</st></span></p>
			<p><st c="24970">To disable Workspace Trust entirely, we can modify the Visual Studio Code setting by going to </st><strong class="bold"><st c="25065">Settings</st></strong><st c="25073"> | </st><strong class="bold"><st c="25076">Security</st></strong><st c="25084"> | </st><strong class="bold"><st c="25087">Workspace</st></strong><st c="25096"> and unchecking </st><strong class="bold"><st c="25112">Trust: Enabled</st></strong><st c="25126"> (</st><span class="No-Break"><em class="italic"><st c="25128">Figure 4</st></em></span><em class="italic"><st c="25136">.10</st></em><st c="25139">) or we can set the following setting: </st><span class="No-Break"><strong class="source-inline"><st c="25179">security.workspace.trust.enabled: false</st></strong></span></p>
			<div>
				<div id="_idContainer080" class="IMG---Figure">
					<img src="image/B19710_04_10.jpg" alt="Figure 4.10 – Workspace Trust Visual Studio Code setting"/><st c="25218"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="25824">Figure 4.10 – Workspace Trust Visual Studio Code setting</st></p>
			<p><st c="25880">Let us review </st><a id="_idIndexMarker285"/><st c="25895">a less frequent but significant development environment risk – compromised IDE </st><span class="No-Break"><st c="25974">source code.</st></span></p>
			<h2 id="_idParaDest-81"><a id="_idTextAnchor082"/><st c="25986">Risk 4 – Compromised IDE source code</st></h2>
			<p><st c="26023">There is</st><a id="_idIndexMarker286"/><st c="26032"> also a risk of the source code of IDEs being compromised! </st><st c="26091">This is less common, but it does happen. </st><st c="26132">Imagine the implications if the very tools used for software development were compromised. </st><st c="26223">This is not just a hypothetical risk. </st><st c="26261">A recent real-world incident involved a security researcher </st><a id="_idIndexMarker287"/><st c="26321">named </st><strong class="bold"><st c="26327">RyotaK</st></strong><st c="26333">, who discovered and exploited a vulnerability in the Visual Studio Code repository on GitHub. </st><st c="26428">The vulnerability was a result of a code injection flaw and a </st><a id="_idIndexMarker288"/><st c="26490">miswritten </st><strong class="bold"><st c="26501">regex expression (regex)</st></strong><st c="26525"> in a </st><strong class="bold"><st c="26531">continuous integration</st></strong><st c="26553"> (</st><strong class="bold"><st c="26555">CI</st></strong><st c="26557">) script in Visual Studio Code’s official </st><a id="_idIndexMarker289"/><st c="26600">GitHub repository. </st><st c="26619">Exploiting this granted him write access to the repository’s source code. </st><st c="26693">This means he could potentially alter the code that developers around the world rely on for </st><span class="No-Break"><st c="26785">their work.</st></span></p>
			<p><st c="26796">If the IDEs’ source code were maliciously altered without detection, it could lead to widespread distribution of tampered software tools, potentially infecting countless projects with malicious code or backdoors. </st><st c="27010">This could compromise not just individual projects but </st><a id="_idIndexMarker290"/><st c="27065">entire infrastructures if widely adopted tools </st><span class="No-Break"><st c="27112">were affected.</st></span></p>
			<p><st c="27126">To get more details on RyotaK’s findings and the repercussions of such a compromise, you can delve into his blog post here: </st><a href="https://blog.ryotak.net/post/vscode-write-access"><st c="27251">https://blog.ryotak.net/post/vscode-write-access</st></a><st c="27299">. The blog is in Japanese, so you might need help from translation services such as Google Translate if you’re not familiar with </st><span class="No-Break"><st c="27428">the language.</st></span></p>
			<h2 id="_idParaDest-82"><a id="_idTextAnchor083"/><st c="27441">Additional thoughts on hardening of the development environment</st></h2>
			<p><st c="27505">What we </st><a id="_idIndexMarker291"/><st c="27514">have found in our experience is that some of the security hardening practices that we discussed are well known and, in some cases, </st><em class="italic"><st c="27645">common sense</st></em><st c="27657">, but they often remain unimplemented and unmonitored in many environments. </st><st c="27733">This is challenging to solve. </st><st c="27763">When people know what to do </st><em class="italic"><st c="27791">but</st></em><st c="27794"> do not implement them, providing them with tools or some generic security training does not solve the problem. </st><st c="27906">They are deep-rooted. </st><st c="27928">Solving this usually involves some form of advocacy and evangelism within the organization – the hard work needed for </st><span class="No-Break"><st c="28046">culture change.</st></span></p>
			<p><st c="28061">These environment-hardening practices must be seamless if they will ever be implemented. </st><st c="28151">IDEs must be configured by default to auto-update, plugins must be configured by default to auto-update where possible, or at least, the organization should have well-defined endpoint management processes that include developer tools and plugins. </st><st c="28398">If possible, the ability to remove or adjust these security defaults should be removed or </st><span class="No-Break"><st c="28488">highly discouraged.</st></span></p>
			<p><st c="28507">This is a difficult thing to do as developers sometimes may need to disable some capabilities for the sake of performance or backward compatibility. </st><st c="28657">We cannot just take an all-or-nothing approach as there are legitimate reasons why some developers may kick against these security defaults in their environment. </st><st c="28819">We should be understanding and accommodating to valid exceptions with the right mitigations in place. </st><st c="28921">Remember that security measures have to be collaborative in a </st><span class="No-Break"><st c="28983">DevSecOps culture.</st></span></p>
			<h1 id="_idParaDest-83"><a id="_idTextAnchor084"/><st c="29001">Addressing common development security mistakes</st></h1>
			<p><st c="29049">There are</st><a id="_idIndexMarker292"/><st c="29059"> various ways that risks are introduced into modern software when they are developed. </st><st c="29145">Modern software applications are for the most part a </st><em class="italic"><st c="29198">cocktail</st></em><st c="29206"> blend of proprietary code written by in-house developers and third-party components, which can originate from open source repositories, </st><em class="italic"><st c="29343">source-available</st></em><st c="29359"> code, or even commercially licensed code, which is less common but nonetheless exists (</st><span class="No-Break"><em class="italic"><st c="29447">Figure 4</st></em></span><span class="No-Break"><em class="italic"><st c="29456">.11</st></em></span><span class="No-Break"><st c="29459">):</st></span></p>
			<div>
				<div id="_idContainer081" class="IMG---Figure">
					<img src="image/B19710_04_11.jpg" alt="Figure 4.11 – Modern software composition"/><st c="29462"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="29585">Figure 4.11 – Modern software composition</st></p>
			<p class="callout-heading"><st c="29626">Source-available software</st></p>
			<p class="callout"><st c="29652">Source-available software means that the source code of the software is publicly available for viewing. </st><st c="29757">However, it doesn’t necessarily grant the same freedoms as </st><strong class="bold"><st c="29816">open source software</st></strong><st c="29836"> (</st><strong class="bold"><st c="29838">OSS</st></strong><st c="29841">). </st><st c="29845">While </st><a id="_idIndexMarker293"/><st c="29851">you can see the code, there may be restrictions on how you can use, modify, or distribute it. </st><st c="29945">Think of it as a </st><em class="italic"><st c="29962">look but don’t touch</st></em><st c="29982"> approach to sharing </st><span class="No-Break"><st c="30003">software code.</st></span></p>
			<p><st c="30017">Any of these components could introduce risks into the software! </st><st c="30083">There could be security flaws in our </st><em class="italic"><st c="30120">in-house code</st></em><st c="30133">, </st><em class="italic"><st c="30135">third-party code and open source packages</st></em><st c="30176"> could also contain vulnerabilities, plus there is the issue of </st><em class="italic"><st c="30240">exposed secrets</st></em><st c="30255">, which can be a big problem. </st><st c="30285">Identifying and addressing these risks should start in the pre-commit phase. </st><st c="30362">If we catch security problems closer to the final stages of the DevOps cycle, it can lead to the delay </st><a id="_idIndexMarker294"/><st c="30465">of a feature release or even worse, become a technical debt that grows and becomes tougher to fix as time goes on. </st><st c="30580">With this in mind, let us break down the top three risk categories to prioritize in the pre-commit phase, starting with security issues in our </st><span class="No-Break"><st c="30723">in-house code.</st></span></p>
			<h2 id="_idParaDest-84"><a id="_idTextAnchor085"/><st c="30737">Risk 1 – Addressing in-house code vulnerability risk</st></h2>
			<p><st c="30790">Developers are</st><a id="_idIndexMarker295"/><st c="30805"> human and can make security mistakes when writing code. </st><st c="30862">For instance, a developer might forget to sanitize user input before using it in database queries, leaving the door open for SQL injection attacks. </st><st c="31010">In another case, a developer might neglect to implement proper session timeouts, making the application vulnerable to session hijacking. </st><st c="31147">In the</st><a id="_idIndexMarker296"/><st c="31153"> recent </st><strong class="bold"><st c="31161">Storm-0558</st></strong><st c="31171"> Microsoft breach, it was discovered that the developers of the Microsoft 365 mail system assumed certain libraries</st><a id="_idIndexMarker297"/><st c="31286"> that they implemented were fully validating the needed scope, and they did not add the necessary issuer/scope validation. </st><st c="31409">This oversight magnified the impact of the breach when a signing key </st><span class="No-Break"><st c="31478">was compromised.</st></span></p>
			<p class="callout-heading"><st c="31494">Analysis of STORM-0558 breach by Microsoft Security Response Center (MSRC)</st></p>
			<p class="callout"><st c="31569">To read the full analysis of the Storm-0558 breach, please refer to this </st><span class="No-Break"><st c="31643">document: </st></span><a href="https://msrc.microsoft.com/blog/2023/09/results-of-major-technical-investigations-for-storm-0558-key-acquisition/"><span class="No-Break"><st c="31653">https://msrc.microsoft.com/blog/2023/09/results-of-major-technical-investigations-for-storm-0558-key-acquisition/</st></span></a></p>
			<p><st c="31766">The root causes of vulnerabilities in in-house code are diverse, therefore there is no single remedy. </st><st c="31869">Tackling this challenge demands a comprehensive strategy, blending both cultural changes and technological measures. </st><st c="31986">We want to make sure that every time a developer writes code, they are equipped with the knowledge and tools needed to write the most secure code possible. </st><st c="32142">A foundational step to addressing this risk is to equip developers with secure coding training but despite the best training efforts, security oversights are inevitable. </st><st c="32312">To</st><a id="_idIndexMarker298"/><st c="32314"> add an extra layer of mitigation, integrating a </st><strong class="bold"><st c="32363">static application security testing</st></strong><st c="32398"> (</st><strong class="bold"><st c="32400">SAST</st></strong><st c="32404">) solution during the pre-commit phase of DevOps can </st><span class="No-Break"><st c="32458">be beneficial.</st></span></p>
			<h3><st c="32472">Understanding how SAST tools work</st></h3>
			<p><st c="32506">SAST tools </st><a id="_idIndexMarker299"/><st c="32518">analyze application source code, bytecode, or binary code to identify vulnerabilities without running</st><a id="_idIndexMarker300"/><st c="32619"> the program. </st><st c="32633">Because they can be automated, they operate faster than traditional manual reviews. </st><st c="32717">As their accuracy improves, they are becoming the preferred choice over manual code reviews, particularly in organizations that have embraced a DevOps model. </st><st c="32875">SAST tools use various methods to achieve this, each with its own advantages </st><span class="No-Break"><st c="32952">and limitations.</st></span></p>
			<p><st c="32968">One common </st><a id="_idIndexMarker301"/><st c="32980">method is </st><strong class="bold"><st c="32990">syntax and semantic analysis</st></strong><st c="33018">. Here, the tool breaks down the code to understand its structure and patterns. </st><st c="33098">For example, in a situation where user input is directly added to an SQL query in the code, this method would recognize the pattern as a potential SQL injection vulnerability. </st><st c="33274">It does this by parsing the code and building abstract representations, such as </st><strong class="bold"><st c="33354">abstract syntax trees</st></strong><st c="33375"> (</st><strong class="bold"><st c="33377">ASTs</st></strong><st c="33381">), to </st><a id="_idIndexMarker302"/><st c="33388">identify such patterns. </st><st c="33412">While this method can spot many vulnerabilities, it might also flag issues that are not real problems (false positives). </st><st c="33533">It can also be resource-intensive and slow for large </st><span class="No-Break"><st c="33586">code bases.</st></span></p>
			<p><st c="33597">Another approach</st><a id="_idIndexMarker303"/><st c="33614"> is </st><strong class="bold"><st c="33618">data flow analysis</st></strong><st c="33636">, which tracks how data moves through a program and analyzes if the data is being handled insecurely. </st><st c="33738">It uses heuristics and predefined rules to trace the flow of data and identify insecure handling; for example, if a web application’s code accepts user input in a form and then displays it on a web page without cleaning it up first. </st><st c="33971">By mapping out how data travels from the input point to its destination on the web page, data flow analysis can spot this as a </st><a id="_idIndexMarker304"/><st c="34098">potential </st><strong class="bold"><st c="34108">cross-site scripting</st></strong><st c="34128"> (</st><strong class="bold"><st c="34130">XSS</st></strong><st c="34133">) vulnerability and flag it. </st><st c="34163">This method is effective in identifying vulnerabilities related to data handling, such as SQL injection or XSS. </st><st c="34275">It is not effective in detecting logical vulnerabilities such as authentication bypasses that are not directly related to data flow. </st><st c="34408">It might also produce false positives if the tool does not fully understand the data’s </st><span class="No-Break"><st c="34495">life cycle.</st></span></p>
			<p><strong class="bold"><st c="34506">Taint analysis</st></strong><st c="34521"> is a</st><a id="_idIndexMarker305"/><st c="34526"> specialized form of data flow analysis. </st><st c="34567">It tracks user-controlled input to see if it gets processed without validation or sanitization, potentially leading to vulnerabilities. </st><st c="34703">For example, in a chat application where users send messages, if these messages are displayed to other users without checking or sanitizing them, taint analysis would flag this as a potential stored XSS vulnerability, where an attacker’s message could contain malicious scripts that run on another user’s browser. </st><st c="35017">It is effective for finding vulnerabilities related to user input, such as injection attacks. </st><st c="35111">It can produce false positives if the tool does not recognize all sanitization methods. </st><st c="35199">It often uses a combination of heuristics and </st><span class="No-Break"><st c="35245">rule-based checks.</st></span></p>
			<p><st c="35263">Another approach </st><a id="_idIndexMarker306"/><st c="35281">used by SAST tools</st><a id="_idIndexMarker307"/><st c="35299"> is </st><strong class="bold"><st c="35303">control flow analysis</st></strong><st c="35324">, which analyzes the sequence in which different parts of the code execute. </st><st c="35400">It looks for issues such as potential infinite loops or conditions that are always </st><strong class="source-inline"><st c="35483">true</st></strong><st c="35487">/</st><strong class="source-inline"><st c="35489">false</st></strong><st c="35494">. If you think of an e-commerce site that is supposed to check</st><a id="_idIndexMarker308"/><st c="35556"> if a user is logged in before processing a purchase, this method will identify if there is a way in the code that skips this check, leading to potential unauthorized access. </st><st c="35731">This method is effective for identifying logical vulnerabilities such as authentication bypass or missing security controls. </st><st c="35856">It is less effective for identifying data-related vulnerabilities such as SQL injection </st><span class="No-Break"><st c="35944">or XSS.</st></span></p>
			<p><strong class="bold"><st c="35951">Configuration review</st></strong><st c="35972"> is </st><a id="_idIndexMarker309"/><st c="35976">another method used by SAST tools for analysis. </st><st c="36024">It is straightforward in how it works. </st><st c="36063">It analyzes configuration files and settings to ensure secure defaults and settings. </st><st c="36148">It does this by comparing configurations against best practices or known secure configurations. </st><st c="36244">For example, if an application configuration is set up to show detailed error messages, a configuration review would flag this as an information disclosure vulnerability since attackers could gain insights from these messages. </st><st c="36471">This approach is great for catching insecure application settings that might be overlooked during manual reviews. </st><st c="36585">It does not detect security problems in the </st><span class="No-Break"><st c="36629">code’s logic.</st></span></p>
			<p><st c="36642">Most SAST tools use a mix of methods to offer a well-rounded view of possible vulnerabilities. </st><st c="36738">They aim for precise results, considering the specificities of various programming languages and frameworks. </st><st c="36847">Additionally, these tools typically have preset rules or queries for different analysis techniques that we mentioned. </st><st c="36965">Some even allow developers/security teams to create custom rules to spot more unique insecure coding patterns in </st><span class="No-Break"><st c="37078">the code.</st></span></p>
			<h3><st c="37087">Challenges of SAST tools</st></h3>
			<p><st c="37112">SAST tools have </st><a id="_idIndexMarker310"/><st c="37129">benefits, but they also have limitations. </st><st c="37171">One big limitation is that they analyze code without running it, so </st><a id="_idIndexMarker311"/><st c="37239">they don’t always have the full context of the application’s behavior, which can lead to a lot of false positives. </st><st c="37354">A false positive is when a tool wrongly identifies a </st><span class="No-Break"><st c="37407">security issue.</st></span></p>
			<p><st c="37422">Take the example of an application developer who is writing frontend logic. </st><st c="37499">They might not have user input validation and sanitization implemented in their code because this is being handled in the backend code, which might be in a separate repository. </st><st c="37676">The SAST tool that analyzes the code does not have this context, so it flags the missing implementation as </st><span class="No-Break"><st c="37783">a vulnerability.</st></span></p>
			<p><st c="37799">Some SAST tools </st><a id="_idIndexMarker312"/><st c="37816">use simple heuristics or just look for basic patterns to identify vulnerabilities. </st><st c="37899">Tools such as these will struggle with analyzing complex code structures. </st><st c="37973">Just because a piece of code matches a simple pattern does not mean that it is vulnerable. </st><st c="38064">This is</st><a id="_idIndexMarker313"/><st c="38071"> why it is important to test these tools before using them. </st><st c="38131">Some are better than others at avoiding false positives. </st><st c="38188">In fact, some tools can get it wrong as much as 80% of the time! </st><st c="38253">This can frustrate developers. </st><st c="38284">Instead of helping to make their work easier, they have to spend time figuring out which warnings are real and which are not. </st><st c="38410">This might make them want to skip using </st><span class="No-Break"><st c="38450">the tool.</st></span></p>
			<p><st c="38459">Also, some tools just point out identified vulnerabilities without clearly explaining why they have been flagged. </st><st c="38574">Others are better at giving clear reasons and even offer automatic fixes to correct the </st><span class="No-Break"><st c="38662">security issue.</st></span></p>
			<p><st c="38677">In our opinion, these challenges do not diminish the benefits that SAST tools provide. </st><st c="38765">We recommend that security experts and developers work together to fine-tune the configuration, queries, and patterns of your chosen SAST tool and integrate feedback to gradually reduce false positives over time. </st><st c="38978">It is also a good idea to combine this with manual reviews, which we will cover later in </st><a href="B19710_05.xhtml#_idTextAnchor098"><span class="No-Break"><em class="italic"><st c="39067">Chapter 5</st></em></span></a><st c="39076"> of </st><span class="No-Break"><st c="39080">this book.</st></span></p>
			<h3><st c="39090">Understanding SAST integration points in the pre-commit phase</st></h3>
			<p><st c="39152">Properly </st><a id="_idIndexMarker314"/><st c="39162">integrating SAST during the pre-commit stage of DevOps can detect critical vulnerabilities </st><a id="_idIndexMarker315"/><st c="39253">in application code when they are easiest and cheapest to fix, especially while developers are still focused on the task. </st><st c="39375">This integration can be done either through IDE security plugins or as </st><strong class="bold"><st c="39446">pre-commit hooks</st></strong><st c="39462">. Each</st><a id="_idIndexMarker316"/><st c="39468"> method has its unique benefits. </st><st c="39501">The </st><strong class="bold"><st c="39505">IDE plugin integration</st></strong><st c="39527"> provides</st><a id="_idIndexMarker317"/><st c="39536"> developers with immediate feedback on security issues as they write the code. </st><st c="39615">Some plugins even highlight security concerns with squiggly lines, similar to syntax error indications, as illustrated in </st><span class="No-Break"><em class="italic"><st c="39737">Figure 4</st></em></span><em class="italic"><st c="39745">.12</st></em><st c="39748">. This immediate feedback serves as </st><strong class="bold"><st c="39784">just-in-time</st></strong><st c="39796"> (</st><strong class="bold"><st c="39798">JIT</st></strong><st c="39801">) secure </st><a id="_idIndexMarker318"/><st c="39811">coding training, alerting developers to potential security flaws in real time. </st><st c="39890">However, a limitation is that not all SAST providers offer </st><span class="No-Break"><st c="39949">such plugins:</st></span></p>
			<div>
				<div id="_idContainer082" class="IMG---Figure">
					<img src="image/B19710_04_12.jpg" alt="Figure 4.12 – A sample of an IDE extension (Checkov) flagging security issues while code is written"/><st c="39962"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="40844">Figure 4.12 – A sample of an IDE extension (Checkov) flagging security issues while code is written</st></p>
			<p><st c="40943">To </st><a id="_idIndexMarker319"/><st c="40947">understand what pre-commit hooks are, we should first know about </st><strong class="bold"><st c="41012">Git hooks</st></strong><st c="41021"> because a</st><a id="_idIndexMarker320"/><st c="41031"> pre-commit hook</st><a id="_idIndexMarker321"/><st c="41047"> is just one kind of Git hook. </st><st c="41078">Git hooks are scripts that Git executes before or after Git events such as commit, push, and receive. </st><st c="41180">They are used to automate custom workflows tailored to the project or the development environment. </st><st c="41279">These hooks reside in the </st><strong class="source-inline"><st c="41305">.git/hooks</st></strong><st c="41315"> directory of every Git repository. </st><st c="41351">By default, Git provides sample hooks in this directory, but they are inactive (they have a </st><strong class="source-inline"><st c="41443">.</st></strong><span class="No-Break"><strong class="source-inline"><st c="41444">sample</st></strong></span><span class="No-Break"><st c="41451"> extension).</st></span></p>
			<p><st c="41463">There are various types of Git hooks, such as pre-commit, post-commit, pre-push, post-receive, and many others. </st><st c="41576">Each corresponds to a different phase in the Git workflow. </st><st c="41635">The pre-commit hook is one of the many Git hooks. </st><st c="41685">It is triggered right before a commit is recorded, allowing us to implement automated inspection of code that is about to be committed (</st><span class="No-Break"><em class="italic"><st c="41821">Figure 4</st></em></span><span class="No-Break"><em class="italic"><st c="41830">.13</st></em></span><span class="No-Break"><st c="41833">):</st></span></p>
			<div>
				<div id="_idContainer083" class="IMG---Figure">
					<img src="image/B19710_04_13.jpg" alt="Figure 4.13 – Pre-commit hooks are triggered before a commit is recorded"/><st c="41836"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="41959">Figure 4.13 – Pre-commit hooks are triggered before a commit is recorded</st></p>
			<p><st c="42031">Pre-commit hooks are versatile and can run a wide variety of scripts. </st><st c="42102">Any script that can be executed from the command line can be used as a pre-commit hook. </st><st c="42190">Given that most SAST tools are available as command-line tools, integrating them as pre-commit hooks for automated code </st><a id="_idIndexMarker322"/><st c="42310">assessment becomes straightforward. </st><st c="42346">If the pre-commit hook script exits with a nonzero status, the commit is aborted, giving the developer an opportunity to fix issues before re-attempting a </st><span class="No-Break"><st c="42501">commit operation.</st></span></p>
			<p><st c="42518">One challenge</st><a id="_idIndexMarker323"/><st c="42532"> with Git’s default setup is that hooks are local to each repository. </st><st c="42602">However, teams often want to share and enforce consistent hooks across all developers. </st><st c="42689">This is where tools such as the pre-commit framework come in handy, helping manage shared configurations and </st><span class="No-Break"><st c="42798">ensuring uniformity.</st></span></p>
			<p class="callout-heading"><st c="42818">Pre-commit framework versus pre-commit hooks</st></p>
			<p class="callout"><st c="42863">The term </st><em class="italic"><st c="42873">pre-commit hooks</st></em><st c="42889"> can sometimes be mistaken for a tool known as the </st><em class="italic"><st c="42940">pre-commit framework</st></em><st c="42960">. As we discussed earlier, the pre-commit hook is a specific type of Git hook that is triggered right before a commit is recorded. </st><st c="43091">The pre-commit framework is a separate tool designed to simplify the process of setting up and managing pre-commit hooks. </st><st c="43213">Instead of manually writing and managing scripts in the </st><strong class="source-inline"><st c="43269">.git/hooks</st></strong><st c="43279"> directory, the pre-commit framework allows developers to leverage a wide array of existing hooks and easily integrate them into their repositories. </st><st c="43428">With the pre-commit framework, we define the hooks we want in a </st><strong class="source-inline"><st c="43492">.pre-commit-config.yaml</st></strong><st c="43515"> file, and the tool takes care of installing them into the appropriate Git </st><span class="No-Break"><st c="43590">hooks directory.</st></span></p>
			<p><st c="43606">While pre-commit hooks are invaluable, there are times when developers might need to bypass them. </st><st c="43705">This could be due to a perceived false positive or a valid reason to override the hook. </st><st c="43793">Commands such as </st><strong class="source-inline"><st c="43810">git commit --no-verify</st></strong><st c="43832"> allow for such bypasses, but they should be used </st><span class="No-Break"><st c="43882">with caution.</st></span></p>
			<h3><st c="43895">SAST tools that integrate with the pre-commit phase</st></h3>
			<p><st c="43947">Several </st><a id="_idIndexMarker324"/><st c="43956">SAST providers </st><a id="_idIndexMarker325"/><st c="43971">offer integration during the pre-commit stage of DevOps. </st><st c="44028">Some of these providers are exclusively open source, others are purely commercial, and a few provide a basic open source version with an option to upgrade to a full-featured commercial version. </st><span class="No-Break"><em class="italic"><st c="44222">Figure 4</st></em></span><em class="italic"><st c="44230">.14</st></em><st c="44233"> shows an overview of </st><span class="No-Break"><st c="44255">common offerings:</st></span></p>
			<div>
				<div id="_idContainer084" class="IMG---Figure">
					<img src="image/B19710_04_14.jpg" alt="Figure 4.14 – Popular SAST tools and how they integrate in pre-commit"/><st c="44272"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="44699">Figure 4.14 – Popular SAST tools and how they integrate in pre-commit</st></p>
			<p><st c="44768">Later in this </st><a id="_idIndexMarker326"/><st c="44783">chapter, we</st><a id="_idIndexMarker327"/><st c="44794"> will give our recommendation on choosing the right tool. </st><st c="44852">For now, this section aims to introduce you to some of the popular </st><span class="No-Break"><st c="44919">options available.</st></span></p>
			<h3><st c="44937">What about AI pair programming tools?</st></h3>
			<p><st c="44975">AI tools </st><a id="_idIndexMarker328"/><st c="44985">such as GitHub Copilot, Tabnine, and Amazon CodeWhisperer bring the power of </st><strong class="bold"><st c="45062">generative AI</st></strong><st c="45075"> (</st><strong class="bold"><st c="45077">GenAI</st></strong><st c="45082">) to </st><a id="_idIndexMarker329"/><st c="45088">development teams. </st><st c="45107">There is no doubt that they help developers to write code faster and to feel more satisfied with their work. </st><st c="45216">Recent GitHub research found that developers using these tools work 55% faster than those </st><span class="No-Break"><st c="45306">who don’t.</st></span></p>
			<p class="callout-heading"><st c="45316">Source – Research on GitHub Copilot’s impact on developer productivity</st></p>
			<p class="callout"><st c="45387">For a closer look at GitHub’s study, check out this </st><span class="No-Break"><st c="45440">document: </st></span><a href="https://github.blog/2022-09-07-research-quantifying-github-copilots-impact-on-developer-productivity-and-happiness/"><span class="No-Break"><st c="45450">https://github.blog/2022-09-07-research-quantifying-github-copilots-impact-on-developer-productivity-and-happiness/</st></span></a></p>
			<p><st c="45565">However, there are concerns about the security of the code these tools produce. </st><st c="45646">GitHub Copilot, for instance, is based on an</st><a id="_idIndexMarker330"/><st c="45690"> OpenAI </st><strong class="bold"><st c="45698">large language model</st></strong><st c="45718"> (</st><strong class="bold"><st c="45720">LLM</st></strong><st c="45723">). </st><st c="45727">This model was trained on code from publicly available sources, including open source code in GitHub. </st><st c="45829">Some of these code sources are notorious for using outdated APIs and implementing insecure coding patterns. </st><st c="45937">So, there’s a risk that the AI might suggest insecure </st><span class="No-Break"><st c="45991">code snippets.</st></span></p>
			<p><st c="46005">Studies </st><a id="_idIndexMarker331"/><st c="46014">show that many developers think AI-generated code is of high quality, but research suggests otherwise. </st><st c="46117">A recent study evaluated ChatGPT, another OpenAI tool, on 21 programming tasks. </st><st c="46197">It only produced 5 secure programs, while the other 16 had security issues in relation to vulnerabilities that were evaluated. </st><st c="46324">For example, when prompted to create an FTP server using C++, ChatGPT’s code lacked input validation, making it vulnerable to injection attacks. </st><st c="46469">However, on further prompting, ChatGPT did fix its mistakes. </st><st c="46530">This shows that the quality and security of AI-generated code depend on how precisely developers provide carefully </st><span class="No-Break"><st c="46645">crafted prompts.</st></span></p>
			<p><st c="46661">We highly recommend that companies keen on using these tools should prioritize training their developers on providing clear, security-specific prompts. </st><st c="46814">You can call this </st><em class="italic"><st c="46832">secure code prompt </st></em><span class="No-Break"><em class="italic"><st c="46851">engineering training</st></em></span><span class="No-Break"><st c="46871">.</st></span></p>
			<p class="callout-heading"><st c="46872">Further reading – How secure is the code generated by ChatGPT?</st></p>
			<p class="callout"><st c="46935">For more details on the referenced study, check out the paper by researchers from the University of Quebec in </st><span class="No-Break"><st c="47046">Canada: </st></span><a href="https://arxiv.org/pdf/2304.09655v1.pdf"><span class="No-Break"><st c="47054">https://arxiv.org/pdf/2304.09655v1.pdf</st></span></a></p>
			<h2 id="_idParaDest-85"><a id="_idTextAnchor086"/><st c="47092">Risk 2 – Open source component risk</st></h2>
			<p><st c="47128">OSS packages </st><a id="_idIndexMarker332"/><st c="47142">offer </st><a id="_idIndexMarker333"/><st c="47148">flexibility, cost savings, and rapid development advantages. </st><st c="47209">However, they can also introduce risks into a software project. </st><st c="47273">These risks can be because of </st><strong class="bold"><st c="47303">security vulnerabilities</st></strong><st c="47327">, </st><strong class="bold"><st c="47329">package compromise</st></strong><st c="47347">, or </st><span class="No-Break"><strong class="bold"><st c="47352">confusion attacks</st></strong></span><span class="No-Break"><st c="47369">.</st></span></p>
			<p><st c="47370">When developers add a package to a project, they also take on its security risks. </st><st c="47453">Even though many OSS project maintainers prioritize security, the license terms don’t mandate them to ensure it – it is not a responsibility that they are obligated to fulfill. </st><st c="47630">Let us discuss some of these risks and how to address them in the pre-commit phase, starting with </st><span class="No-Break"><st c="47728">security vulnerabilities:</st></span></p>
			<h3><st c="47753">Addressing OSS known vulnerabilities risk in the pre-commit phase</st></h3>
			<p><strong class="bold"><st c="47819">Known vulnerabilities</st></strong><st c="47841"> are</st><a id="_idIndexMarker334"/><st c="47845"> unintentional </st><a id="_idIndexMarker335"/><st c="47860">security gaps in the OSS code (think of these as accidental holes in the components that are used in a ship). </st><st c="47970">When identified by security researchers, they are responsibly disclosed and publicly recorded as </st><strong class="bold"><st c="48067">Common Vulnerabilities and Exposures</st></strong><st c="48103"> (</st><strong class="bold"><st c="48105">CVEs</st></strong><st c="48109">) in</st><a id="_idIndexMarker336"/><st c="48114"> known libraries such as MITRE’s CVE list (</st><a href="https://cve.mitre.org"><st c="48157">https://cve.mitre.org</st></a><st c="48179">) and the </st><strong class="bold"><st c="48190">National Vulnerability Database</st></strong><st c="48221"> (</st><strong class="bold"><st c="48223">NVD</st></strong><st c="48226">) (</st><a href="https://nvd.nist.gov"><st c="48230">https://nvd.nist.gov</st></a><st c="48251">). </st><st c="48255">These</st><a id="_idIndexMarker337"/><st c="48260"> databases can be searched by security tools to identify known vulnerabilities in specific versions of OSS packages. </st><st c="48377">While direct vulnerabilities in the packages that developers choose are concerning, there is another hidden risk: transitive dependencies. </st><st c="48516">These are packages that get automatically included as a dependency of the selected OSS package (</st><span class="No-Break"><em class="italic"><st c="48612">Figure 4</st></em></span><em class="italic"><st c="48621">.15</st></em><st c="48624">). </st><st c="48628">A recent study by the research team at Endor Labs found that 95% of security issues are found in these </st><span class="No-Break"><st c="48731">transitive dependencies:</st></span></p>
			<div>
				<div id="_idContainer085" class="IMG---Figure">
					<img src="image/B19710_04_15.jpg" alt="Figure 4.15 – OSS package dependency"/><st c="48755"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="48905">Figure 4.15 – OSS package dependency</st></p>
			<p class="callout-heading"><st c="48941">The State of Dependency Management report by Endor Labs</st></p>
			<p class="callout"><st c="48997">You can refer to this document to access the </st><span class="No-Break"><st c="49043">report: </st></span><a href="https://www.endorlabs.com/state-of-dependency-management#"><span class="No-Break"><st c="49051">https://www.endorlabs.com/state-of-dependency-management#</st></span></a></p>
			<p><st c="49108">A foundational step to addressing </st><em class="italic"><st c="49143">OSS known vulnerability</st></em><st c="49166"> risk in the pre-commit phase is to </st><em class="italic"><st c="49202">equip developers with knowledge on how to pick safe and secure OSS packages for their projects</st></em><st c="49296">. Some companies are trying out new ways to help developers make these choices. </st><st c="49376">For example, some have started to experiment with the use of LLMs </st><a id="_idIndexMarker338"/><st c="49442">and GenAI to streamline this process. </st><st c="49480">So, instead of mandating developers to read long guidelines on how to pick safe packages, developers can just ask questions such as </st><em class="italic"><st c="49612">Is there a more secure alternative to the OpenSSL library?</st></em><st c="49670">, and they will get a response with explanations. </st><st c="49720">A new tool </st><a id="_idIndexMarker339"/><st c="49731">called </st><strong class="bold"><st c="49738">DroidGPT</st></strong><st c="49746">, made by Endor Labs, is trying to do just this. </st><st c="49795">It aims to make it easier and faster for developers to choose secure open source packages for their projects. </st><st c="49905">But it is still new (and in private preview), and we don’t know yet how well it works in </st><span class="No-Break"><st c="49994">real situations.</st></span></p>
			<p><st c="50010">Another common approach to addressing known vulnerabilities in OSS in the pre-commit phase is to</st><a id="_idIndexMarker340"/><st c="50107"> integrate </st><strong class="bold"><st c="50118">software composition analysis</st></strong><st c="50147"> (</st><strong class="bold"><st c="50149">SCA</st></strong><st c="50152">) tools similar to how we described SAST tools integration. </st><st c="50213">These tools inspect open source components and third-party libraries used in an application to identify known vulnerabilities. </st><st c="50340">They operate by comparing these components against databases of </st><span class="No-Break"><st c="50404">known vulnerabilities.</st></span></p>
			<h4><st c="50426">Challenges of SCA tools</st></h4>
			<p><st c="50450">One of the </st><a id="_idIndexMarker341"/><st c="50462">grave mistakes that we have seen organizations make is to reduce the implementation of DevSecOps to tooling adoption. </st><st c="50580">Implementing DevSecOps effectively is more than just deploying SCA tools; it demands careful planning and a deep understanding of the tools’ capabilities and limitations. </st><st c="50751">To understand the dependencies included in a project, most SCA tools will scan the project for package management files, parse the files to extract dependency information, and perform a vulnerability analysis based on the dependencies listed. </st><st c="50994">For example, when dealing with a .NET Core application that uses the NuGet package manager, an SCA tool would analyze the </st><strong class="source-inline"><st c="51116">.csproj</st></strong><st c="51123"> file to extract dependency data, followed by a vulnerability assessment based on </st><span class="No-Break"><st c="51205">those dependencies.</st></span></p>
			<p><st c="51224">However, solely relying on package manager data to identify dependencies can lead to blind spots. </st><st c="51323">There is often a mismatch between the dependencies declared in package management files and what is actively used in code. </st><st c="51446">Some dependencies might be declared but remain unused in the actual code, known</st><a id="_idIndexMarker342"/><st c="51525"> as </st><strong class="bold"><st c="51529">unused dependencies</st></strong><st c="51548">. There might be dependencies used in the code but not listed in the package manager file, known</st><a id="_idIndexMarker343"/><st c="51644"> as </st><span class="No-Break"><strong class="bold"><st c="51648">phantom dependencies</st></strong></span><span class="No-Break"><st c="51668">.</st></span></p>
			<p><st c="51669">Such discrepancies</st><a id="_idIndexMarker344"/><st c="51688"> can have tangible implications. </st><st c="51721">For one, alerting vulnerabilities in unused dependencies can lead to a barrage of unnecessary alerts, adding to the cognitive burden on developers who are already pressed for time. </st><st c="51902">On the other hand, missing out on scanning phantom dependencies can introduce significant security blind spots, which is </st><span class="No-Break"><st c="52023">even riskier.</st></span></p>
			<p><st c="52036">Alerting vulnerabilities in unused software components (unused dependencies) adds to the noise, which adds to the cognitive burden on developers already working against tight schedules. </st><st c="52223">Not being able to identify and scan phantom dependencies leads to blind spots, which is even </st><span class="No-Break"><st c="52316">more risky.</st></span></p>
			<p><st c="52327">By recognizing these challenges, more mature SCA tools have evolved. </st><st c="52397">These do not just focus on package manager files but integrate this data with direct code analysis to offer a more comprehensive assessment. </st><st c="52538">Our aim here is not to advocate for a specific tool, but we think it is important for teams to be aware of these challenges and factor them into their </st><span class="No-Break"><st c="52689">DevSecOps strategy.</st></span></p>
			<h3><st c="52708">Addressing OSS package compromise risks in pre-commit</st></h3>
			<p><strong class="bold"><st c="52762">Package compromise</st></strong><st c="52781"> is </st><a id="_idIndexMarker345"/><st c="52785">when</st><a id="_idIndexMarker346"/><st c="52789"> attackers compromise and intentionally modify a legitimate OSS package with the goal of impacting downstream consumers of the package (think of these as someone deliberately making holes in components used in building a ship). </st><st c="53017">They might achieve this by hijacking the accounts of project maintainers or exploiting vulnerabilities within package repositories. </st><st c="53149">A notable example is the ESLint attack, where attackers compromised a maintainer’s credentials and used them to insert malicious code into the popular </st><strong class="source-inline"><st c="53300">eslint</st></strong><st c="53306"> package. </st><st c="53316">The inserted code then stole </st><strong class="bold"><st c="53345">Node Package Manager</st></strong><st c="53365"> (</st><strong class="bold"><st c="53367">npm</st></strong><st c="53370">) credentials </st><a id="_idIndexMarker347"/><st c="53385">from the systems of those who added and called the package in </st><span class="No-Break"><st c="53447">their code.</st></span></p>
			<p><st c="53458">Instead of modifying the main package, attackers could also add a malicious package as a dependency. </st><st c="53560">This was the case in the EventStream attack where a malicious package called </st><strong class="source-inline"><st c="53637">flatmap-stream</st></strong><st c="53651"> was added to the </st><strong class="source-inline"><st c="53669">event-stream</st></strong><st c="53681"> package. </st><st c="53691">The malicious package contained an encrypted payload that was tailored to steal Bitcoins from the </st><span class="No-Break"><st c="53789">Copay app.</st></span></p>
			<p class="callout-heading"><st c="53799">ESLint and EventStream attacks</st></p>
			<p class="callout"><st c="53830">For an ESLint </st><a id="_idIndexMarker348"/><st c="53845">attack post-mortem, refer to this </st><span class="No-Break"><st c="53879">link: </st></span><a href="https://eslint.org/blog/2018/07/postmortem-for-malicious-package-publishes/"><span class="No-Break"><st c="53885">https://eslint.org/blog/2018/07/postmortem-for-malicious-package-publishes/</st></span></a></p>
			<p class="callout"><st c="53960">For Snyk’s post-mortem of</st><a id="_idIndexMarker349"/><st c="53986"> the EventStream attack, refer to this </st><span class="No-Break"><st c="54025">link: </st></span><a href="https://snyk.io/blog/a-post-mortem-of-the-malicious-event-stream-backdoor/"><span class="No-Break"><st c="54031">https://snyk.io/blog/a-post-mortem-of-the-malicious-event-stream-backdoor/</st></span></a></p>
			<p><st c="54105">Protecting</st><a id="_idIndexMarker350"/><st c="54116"> against package compromise requires us to establish a secure package management process. </st><st c="54206">This includes ensuring that developers can only download packages from trusted, reputable sources or official repositories and verifying the integrity of these packages through checksums or similar techniques to ensure they have not been altered. </st><st c="54453">Staying updated with security alerts for the packages you use can also be a safeguard. </st><st c="54540">Platforms such as GitHub often issue security advisories. </st><st c="54598">Running packages with minimal permissions can further reduce the potential damage of a compromised package. </st><st c="54706">We will cover secure dependency management later in </st><a href="B19710_06.xhtml#_idTextAnchor122"><span class="No-Break"><em class="italic"><st c="54758">Chapter 6</st></em></span></a><st c="54767"> of this book, so stay tuned </st><span class="No-Break"><st c="54796">for that.</st></span></p>
			<h3><st c="54805">Addressing dependency confusion attacks in pre-commit</st></h3>
			<p><strong class="bold"><st c="54859">Dependency confusion attacks</st></strong><st c="54888"> are </st><a id="_idIndexMarker351"/><st c="54893">deceptive tactics where attackers name malicious packages </st><a id="_idIndexMarker352"/><st c="54951">with similar names to genuine ones and upload them to public package repositories. </st><st c="55034">The goal is to deceive developers into downloading and integrating these malicious packages, thinking they are legitimate ones, thereby introducing vulnerabilities or backdoors into their software projects. </st><st c="55241">A simple typo in the package name could have the developer pulling down malicious code that will end up being distributed to application users. </st><st c="55385">Imagine believing you’re securing a life jacket, but it’s actually </st><span class="No-Break"><st c="55452">a weight.</st></span></p>
			<p><st c="55461">In a recent incident, researchers at Checkmarx, JFrog, and Sonatype tracked a threat actor called RED-LILI that targeted Azure developers with malicious </st><strong class="source-inline"><st c="55615">npm</st></strong><st c="55618"> packages. </st><st c="55629">The group published malicious Azure SDK packages but replaced the </st><strong class="source-inline"><st c="55695">@azure</st></strong><st c="55701"> scope with </st><strong class="source-inline"><st c="55713">azure-</st></strong><st c="55719">, and in some cases, they removed the scope altogether and just published a package with the same name (</st><span class="No-Break"><em class="italic"><st c="55823">Figure 4</st></em></span><span class="No-Break"><em class="italic"><st c="55832">.16</st></em></span><span class="No-Break"><st c="55835">):</st></span></p>
			<div>
				<div id="_idContainer086" class="IMG---Figure">
					<img src="image/B19710_04_16.jpg" alt="Figure 4.16 – Malicious npm packages published by the RED-LILI group"/><st c="55838"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="56388">Figure 4.16 – Malicious npm packages published by the RED-LILI group</st></p>
			<p><st c="56456">What </st><a id="_idIndexMarker353"/><st c="56462">sets this group apart is their sophistication. </st><st c="56509">They automated the entire process, from </st><strong class="source-inline"><st c="56549">npm</st></strong><st c="56552"> account creation to malicious package publishing, even bypassing </st><strong class="bold"><st c="56618">one-time password</st></strong><st c="56635"> (</st><strong class="bold"><st c="56637">OTP</st></strong><st c="56640">) verifications. </st><st c="56658">Also, instead of using a single account to </st><a id="_idIndexMarker354"/><st c="56701">publish multiple malicious packages, they created a unique account for each package, making detection and cleanup more challenging. </st><st c="56833">In just 1 week, they released around 800 </st><span class="No-Break"><st c="56874">such packages!</st></span></p>
			<p class="callout-heading"><st c="56888">RED-LILI attack</st></p>
			<p class="callout"><st c="56904">To read more </st><a id="_idIndexMarker355"/><st c="56918">about the RED-LILI supply chain threat actor, please refer to this </st><span class="No-Break"><st c="56985">page: </st></span><a href="https://github.com/checkmarx/red-lili"><span class="No-Break"><st c="56991">https://github.com/checkmarx/red-lili</st></span></a></p>
			<p><st c="57028">Dependency confusion attacks can also take other forms. </st><st c="57085">For example, the target could be private packages used within an organization instead of OSS packages. </st><st c="57188">Here is an example </st><span class="No-Break"><st c="57207">of this:</st></span></p>
			<p><st c="57215">Imagine a company named </st><em class="italic"><st c="57240">TechCorp</st></em><st c="57248"> that uses a private package called </st><strong class="source-inline"><st c="57284">SecureLogin</st></strong><st c="57295"> for its internal applications. </st><st c="57327">This package is version </st><strong class="source-inline"><st c="57351">1.5</st></strong><st c="57354"> and is not available to the public. </st><st c="57391">An attacker learns about </st><strong class="source-inline"><st c="57416">SecureLogin</st></strong><st c="57427"> through some leaked documentation or insider information. </st><st c="57486">They then create a malicious package, also named </st><strong class="source-inline"><st c="57535">SecureLogin</st></strong><st c="57546">, but give it a higher version number – say, </st><strong class="source-inline"><st c="57591">2.0</st></strong><st c="57594">. This malicious package contains code that, when executed, sends sensitive user data to the attacker’s server. </st><st c="57706">The attacker uploads this malicious </st><strong class="source-inline"><st c="57742">SecureLogin</st></strong><st c="57753"> version </st><strong class="source-inline"><st c="57762">2.0</st></strong><st c="57765"> to a public package repository. </st><st c="57798">Now, when TechCorp’s developers fetch updates for their packages, the package manager sees the </st><em class="italic"><st c="57893">newer</st></em><st c="57898"> version </st><strong class="source-inline"><st c="57907">2.0</st></strong><st c="57910"> of </st><strong class="source-inline"><st c="57914">SecureLogin</st></strong><st c="57925"> and might automatically download and integrate it, thinking it’s a legitimate update from their own team (marked as </st><em class="italic"><st c="58042">3</st></em><st c="58043"> in </st><span class="No-Break"><em class="italic"><st c="58047">Figure 4</st></em></span><em class="italic"><st c="58055">.17</st></em><st c="58058">). </st><st c="58062">Once integrated, the malicious code activates, compromising</st><a id="_idIndexMarker356"/><st c="58121"> the company’s applications and sending sensitive data to </st><span class="No-Break"><st c="58179">the attacker:</st></span></p>
			<div>
				<div id="_idContainer087" class="IMG---Figure">
					<img src="image/B19710_04_17.jpg" alt="Figure 4.17 – Dependency confusion targeting private packages"/><st c="58192"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="58403">Figure 4.17 – Dependency confusion targeting private packages</st></p>
			<p><st c="58464">This is not an unusual attack. </st><st c="58496">Alex Birsan documented how he performed exactly this style of dependency confusion attack to breach large companies such as Apple and Microsoft </st><span class="No-Break"><st c="58640">here: </st></span><a href="mailto:https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610"><span class="No-Break"><st c="58646">https://medium.com/@alex.birsan/dependency-confusion-4a5d60fec610</st></span></a></p>
			<p><st c="58711">In the attack, he scanned the public repositories of target organizations, specifically looking for package management files such as </st><strong class="source-inline"><st c="58845">package.json</st></strong><st c="58857">. From these files, he identified names of private packages that the organizations used internally but were not available on public package repositories. </st><st c="59011">He then created higher versions of the same package names on public repositories and waited for them to </st><span class="No-Break"><st c="59115">be downloaded.</st></span></p>
			<p><st c="59129">To address the risks of dependency confusion, we need a clear plan. </st><st c="59198">Firstly, developers should undergo secure development training, emphasizing the importance of version pinning and teaching them to recognize signs of dependency confusion. </st><st c="59370">Tools such as </st><strong class="source-inline"><st c="59384">npm</st></strong><st c="59387">’s </st><strong class="source-inline"><st c="59391">package-lock.json</st></strong><st c="59408"> or Python’s </st><strong class="source-inline"><st c="59421">Pipfile.lock</st></strong><st c="59433"> can help make sure the right package versions are installed. </st><st c="59495">If internal packages are used, it is wise to prevent downloads from public sources. </st><st c="59579">When considering a new dependency, it’s beneficial to meticulously review its history, the credibility of its maintainers, the contribution process, and its</st><a id="_idIndexMarker357"/><st c="59735"> recent changes. </st><st c="59752">This diligence in package selection and the associated security practices should be integral components of any security training strategy. </st><st c="59891">All of these are part of a comprehensive dependency management strategy that we will cover later in </st><a href="B19710_06.xhtml#_idTextAnchor122"><span class="No-Break"><em class="italic"><st c="59991">Chapter 6</st></em></span></a><st c="60000"> of </st><span class="No-Break"><st c="60004">this book.</st></span></p>
			<h2 id="_idParaDest-86"><a id="_idTextAnchor087"/><st c="60014">Risk 3 – Exposed secret risk</st></h2>
			<p><st c="60043">To enhance</st><a id="_idIndexMarker358"/><st c="60054"> their functionality, modern applications frequently interface with various services, such as databases, cloud storage, and third-party APIs. </st><st c="60196">As a result, developers often handle secrets such as authentication tokens, passwords, and API keys during the coding process to enable and test </st><span class="No-Break"><st c="60341">these integrations.</st></span></p>
			<p><st c="60360">A common mistake is accidentally committing these secrets into VCSs such as Git. </st><st c="60442">Once pushed, especially to public repositories, these secrets can be accessed by malicious actors, leading to potential data breaches or unauthorized access. </st><st c="60600">This is also a risk in private repositories where internal threats are just as dangerous as external threats. </st><st c="60710">Keep in mind that private repositories may become public in the future. </st><st c="60782">A recent example is the accidental leak of</st><a id="_idIndexMarker359"/><st c="60824"> Azure Storage </st><strong class="bold"><st c="60839">shared access signature</st></strong><st c="60862"> (</st><strong class="bold"><st c="60864">SAS</st></strong><st c="60867">) tokens by Microsoft AI researchers in their public GitHub repository. </st><st c="60940">This leak led to the breach of 38 TB of </st><span class="No-Break"><st c="60980">private data.</st></span></p>
			<p class="callout-heading"><st c="60993">Note – Analysis of leak in Microsoft’s AI GitHub repository</st></p>
			<p class="callout"><st c="61053">To read more about the breach, please refer to this </st><span class="No-Break"><st c="61106">document: </st></span><a href="https://www.wiz.io/blog/38-terabytes-of-private-data-accidentally-exposed-by-microsoft-ai-researchers"><span class="No-Break"><st c="61116">https://www.wiz.io/blog/38-terabytes-of-private-data-accidentally-exposed-by-microsoft-ai-researchers</st></span></a></p>
			<p><st c="61217">The challenge of managing secrets in code is multifaceted. </st><st c="61277">It is not just about avoiding committing them, but also about securely storing, accessing, and rotating them. </st><st c="61387">A holistic approach is required to tackle this risk. </st><st c="61440">A clear process should be implemented for secret management, and development teams should be educated on secret management within the Azure ecosystem. </st><st c="61591">We will cover secret management in a DevOps process with Azure Key Vault later in </st><span class="No-Break"><st c="61673">this book.</st></span></p>
			<p><st c="61683">In the pre-commit </st><a id="_idIndexMarker360"/><st c="61702">phase, secret scanning tools, similar to SAST tools, can be integrated to detect secrets or sensitive information in code bases. </st><st c="61831">They scan the code for patterns that match common secret formats, such as Azure service keys or </st><span class="No-Break"><st c="61927">connection strings.</st></span></p>
			<p><st c="61946">These tools operate by using pattern matching, entropy checks, and sometimes ML to identify potential secrets in the code. </st><st c="62070">For instance, a string that looks like an Azure service key would be flagged. </st><st c="62148">They can be seamlessly integrated into the pre-commit phase, similar to SAST tools, to catch potential leaks before they are committed to </st><span class="No-Break"><st c="62286">source control.</st></span></p>
			<h1 id="_idParaDest-87"><a id="_idTextAnchor088"/><st c="62301">Choosing the right developer-first security tooling</st></h1>
			<p class="author-quote"><st c="62353">The best tools make it easier for engineers to do their work or make their work more enjoyable.</st></p>
			<p><st c="62449">Tooling plays a</st><a id="_idIndexMarker361"/><st c="62465"> critical role in implementing DevSecOps. </st><st c="62507">Selecting the right tools for the pre-commit phase should be a joint decision involving all teams in the software development process. </st><st c="62642">To simplify management and roll out at scale, it is advisable to adopt tools that provide a platform-first approach with a developer-first focus. </st><st c="62788">This may not always be possible due to technological stack support limitations or </st><span class="No-Break"><st c="62870">even budget.</st></span></p>
			<p><st c="62882">Developer-first security tooling refers to security tools and solutions that prioritize the needs of developers in the software development process. </st><st c="63032">These categories of tools focus on providing developers with the necessary capabilities to develop secure applications from the beginning and integrate well with standard </st><span class="No-Break"><st c="63203">development workflows.</st></span></p>
			<p><st c="63225">Developers tend to prefer tools that enhance their productivity and make their work easier and more enjoyable. </st><st c="63337">Surveys from Stack Overflow and JetBrains in 2020 showed that developers value tools that are easy to use, integrate well with their environment, and support their preferred languages and frameworks. </st><st c="63537">Work with them to select the best tools for </st><em class="italic"><st c="63581">them</st></em><st c="63585">. It is pointless to choose tools that will not </st><span class="No-Break"><st c="63633">be used.</st></span></p>
			<p><st c="63641">Besides meeting developers’ needs, tools in this phase should also promote collaboration among all stakeholders. </st><st c="63755">This ensures everyone takes part in the collective responsibility of security. </st><st c="63834">For example, tools should allow easy sharing of security findings </st><a id="_idIndexMarker362"/><st c="63900">among teams. </st><st c="63913">If a team has created a great query for detecting a vulnerable coding pattern, your tool should allow an easy roll-out of the custom query to other teams in </st><span class="No-Break"><st c="64070">your organization.</st></span></p>
			<p><st c="64088">Emphasis should be on choosing tools that deliver both </st><em class="italic"><st c="64144">useful</st></em><st c="64150"> and </st><em class="italic"><st c="64155">actionable</st></em><st c="64165"> feedback. </st><st c="64176">Many tools might give information, but if it is not actionable, it is of little value. </st><st c="64263">Actionable feedback is crucial as it educates developers on the reasons behind security flags and how to avoid them in </st><span class="No-Break"><st c="64382">the future.</st></span></p>
			<h1 id="_idParaDest-88"><a id="_idTextAnchor089"/><st c="64393">Hands-on exercise 1 – Performing code review, dependency checks, and secret scanning on the IDE</st></h1>
			<p><st c="64489">To complete </st><a id="_idIndexMarker363"/><st c="64502">this hands-on exercise, you need to have completed the hands-on exercise (</st><em class="italic"><st c="64576">Hands-on exercise 1 – Provisioning the lab VM</st></em><st c="64622">) from the previous chapter where we provisioned the lab VM. </st><st c="64684">In this exercise, we will be performing </st><a id="_idIndexMarker364"/><st c="64724">code reviews, checking dependency vulnerabilities, and scanning for secrets within our code. </st><st c="64817">This is an important </st><a id="_idIndexMarker365"/><st c="64838">phase of shifting security left as we get to identify and fix many vulnerabilities before committing </st><span class="No-Break"><st c="64939">the code.</st></span></p>
			<p><st c="64948">In this exercise, we will use the </st><strong class="source-inline"><st c="64983">eShopOnWeb</st></strong><st c="64993"> application. </st><st c="65007">This application is related to eShopOnContainers application which focuses on containers and microservices. </st><st c="65115">eShopOnWeb on the other hand focuses on traditional web application development. </st><span class="No-Break"><em class="italic"><st c="65196">Figure 4</st></em></span><em class="italic"><st c="65204">.18</st></em><st c="65207"> shows the reference architecture of the </st><span class="No-Break"><st c="65248">eShopOnContainers application:</st></span></p>
			<div>
				<div id="_idContainer088" class="IMG---Figure">
					<img src="image/B19710_03_15.jpg" alt="Figure 4.18 – eShopOnContainers reference architecture (Source: https://learn.microsoft.com/en-us/dotnet/architecture/cloud-native/introduce-eshoponcontainers-reference-app)"/><st c="65278"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="65814">Figure 4.18 – eShopOnContainers reference architecture (Source: https://learn.microsoft.com/en-us/dotnet/architecture/cloud-native/introduce-eshoponcontainers-reference-app)</st></p>
			<p><st c="65987">Following are the tasks that we will complete in </st><span class="No-Break"><st c="66037">this exercise:</st></span></p>
			<ul>
				<li><strong class="bold"><st c="66051">Task 1</st></strong><st c="66058">: Connecting to the lab VM using </st><span class="No-Break"><st c="66092">Azure Bastion</st></span></li>
				<li><strong class="bold"><st c="66105">Task 2</st></strong><st c="66112">: Configuring Snyk on Visual </st><span class="No-Break"><st c="66142">Studio Code</st></span></li>
				<li><strong class="bold"><st c="66153">Task 3</st></strong><st c="66160">: Importing </st><strong class="source-inline"><st c="66173">eShopOnWeb</st></strong><st c="66183"> to your Visual Studio </st><span class="No-Break"><st c="66206">Code workspace</st></span></li>
			</ul>
			<h2 id="_idParaDest-89"><a id="_idTextAnchor090"/><st c="66220">Task 1 – Connecting to the lab VM using Azure Bastion</st></h2>
			<p><st c="66274">The aim of this task is</st><a id="_idIndexMarker366"/><st c="66298"> to use the Bastion service to </st><a id="_idIndexMarker367"/><st c="66329">establish a connection with the </st><span class="No-Break"><st c="66361">lab VM:</st></span></p>
			<ol>
				<li><st c="66368">On the Azure portal home page, in the search box, type </st><strong class="source-inline"><st c="66424">DevSecOps-LabVM</st></strong><st c="66439"> and select the </st><strong class="source-inline"><st c="66455">DevSecOps-LabVM</st></strong><st c="66470"> VM when </st><span class="No-Break"><st c="66479">it appears:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer089" class="IMG---Figure">
					<img src="image/B19710_04_19.jpg" alt="Figure 4.19 – Selecting the DevSecOps-LabVM VM"/><st c="66490"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="66715">Figure 4.19 – Selecting the DevSecOps-LabVM VM</st></p>
			<ol>
				<li value="2"><st c="66761">In</st><a id="_idIndexMarker368"/><st c="66764"> the </st><strong class="bold"><st c="66769">DevSecOps-LabVM</st></strong><st c="66784"> window, in </st><a id="_idIndexMarker369"/><st c="66796">the </st><strong class="bold"><st c="66800">Connect</st></strong><st c="66807"> section, click on </st><strong class="bold"><st c="66826">Connect</st></strong><st c="66833"> | </st><strong class="bold"><st c="66836">Go </st></strong><span class="No-Break"><strong class="bold"><st c="66839">to Bastion</st></strong></span><span class="No-Break"><st c="66849">:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer090" class="IMG---Figure">
					<img src="image/B19710_04_20.jpg" alt="Figure 4.20 – Selecting the option to connect to the VM using Bastion"/><st c="66851"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="67638">Figure 4.20 – Selecting the option to connect to the VM using Bastion</st></p>
			<ol>
				<li value="3"><st c="67707">In the </st><strong class="bold"><st c="67715">DevSecOps-LabVM | Bastion</st></strong><st c="67740"> window, configure the following and click </st><span class="No-Break"><st c="67783">on </st></span><span class="No-Break"><strong class="bold"><st c="67786">Connect</st></strong></span><span class="No-Break"><st c="67793">:</st></span><ul><li><span class="No-Break"><strong class="bold"><st c="67795">Username</st></strong></span><span class="No-Break"><st c="67803">: </st></span><span class="No-Break"><strong class="source-inline"><st c="67806">azureuser</st></strong></span></li><li><strong class="bold"><st c="67815">Authentication </st></strong><span class="No-Break"><strong class="bold"><st c="67831">Type</st></strong></span><span class="No-Break"><st c="67835">: </st></span><span class="No-Break"><strong class="bold"><st c="67838">Password</st></strong></span></li><li><strong class="bold"><st c="67846">Password</st></strong><st c="67855">: Enter the password that you specified during the </st><span class="No-Break"><st c="67907">template deployment</st></span></li><li><strong class="bold"><st c="67926">Open in new browser </st></strong><span class="No-Break"><strong class="bold"><st c="67947">tab</st></strong></span><span class="No-Break"><st c="67950">: Selected</st></span></li><li><span class="No-Break"><st c="67961">Click </st></span><span class="No-Break"><strong class="bold"><st c="67968">Connect</st></strong></span></li></ul></li>
			</ol>
			<div>
				<div id="_idContainer091" class="IMG---Figure">
					<img src="image/B19710_04_21.jpg" alt="Figure 4.21 – Configuring the VM credentials and initiating a connection to the VM"/><st c="67975"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="68145">Figure 4.21 – Configuring the VM credentials and initiating a connection to the VM</st></p>
			<ol>
				<li value="4"><st c="68227">If prompted, enable</st><a id="_idIndexMarker370"/><st c="68247"> a pop-up window </st><a id="_idIndexMarker371"/><st c="68264">for the connection to be successful. </st><st c="68301">Also, click to allow clipboard access </st><span class="No-Break"><st c="68339">if prompted:</st></span></li>
			</ol>
			<p><st c="68351">Now that you have access </st><a id="_idIndexMarker372"/><st c="68377">to the lab VM, let us perform code review, dependency checks, secret scanning, and </st><strong class="bold"><st c="68460">software bill of materials</st></strong><st c="68486"> (</st><strong class="bold"><st c="68488">SBOM</st></strong><st c="68492">) generation within </st><span class="No-Break"><st c="68513">the IDE.</st></span></p>
			<h2 id="_idParaDest-90"><a id="_idTextAnchor091"/><st c="68521">Task 2 – Configuring Snyk on Visual Studio Code</st></h2>
			<p><st c="68569">In this task, we will</st><a id="_idIndexMarker373"/><st c="68591"> set up our scanning tool within </st><a id="_idIndexMarker374"/><st c="68624">Visual Studio Code. </st><st c="68644">We</st><a id="_idIndexMarker375"/><st c="68646"> will be using Snyk (</st><a href="http://snyk.io"><span class="No-Break"><st c="68667">snyk.io</st></span></a><span class="No-Break"><st c="68675">):</st></span></p>
			<ol>
				<li><st c="68678">On the Desktop of the lab VM, you will find Visual Studio Code. </st><st c="68743">This was pre-installed for you. </st><st c="68775">Go ahead and open Visual </st><span class="No-Break"><st c="68800">Studio Code.</st></span></li>
				<li><st c="68812">There are several open source and commercial tools you can use in your IDE to perform code scanning, dependency checks, secrets scanning, and SBOM generation. </st><st c="68972">The</st><a id="_idIndexMarker376"/><st c="68975"> choice of the source code analysis tool depends on several things, including the programming language in use, whether the tool is open source or </st><a id="_idIndexMarker377"/><st c="69121">commercial, the accuracy of the tool, availability as an extension with preferred IDEs, and so on. </st><st c="69220">It is therefore important for you to review which tool will work for your use cases and have proper </st><strong class="bold"><st c="69320">proofs of concept</st></strong><st c="69337"> (</st><strong class="bold"><st c="69339">POCs</st></strong><st c="69343">) done</st><a id="_idIndexMarker378"/><st c="69350"> before going forward with a particular tool. </st><st c="69396">The </st><strong class="bold"><st c="69400">Open Worldwide Application Security Project</st></strong><st c="69443"> (</st><strong class="bold"><st c="69445">OWASP</st></strong><st c="69450">) (</st><a href="https://owasp.org/www-community/Source_Code_Analysis_Tools"><st c="69454">https://owasp.org/www-community/Source_Code_Analysis_Tools</st></a><st c="69513">) shows</st><a id="_idIndexMarker379"/><st c="69521"> a list of some of the tools available in the market, platforms supported, and programming languages scanned. </st><st c="69631">For this exercise, we will </st><a id="_idIndexMarker380"/><st c="69658">be using Snyk, which scans for open source security, code security, and </st><strong class="bold"><st c="69730">Infrastructure as Code</st></strong><st c="69752"> (</st><span class="No-Break"><strong class="bold"><st c="69754">IaC</st></strong></span><span class="No-Break"><st c="69757">) security.</st></span></li>
				<li><st c="69769">Let’s install the Snyk Visual Studio Code extension by going to </st><strong class="bold"><st c="69834">Extensions</st></strong><st c="69844"> (</st><em class="italic"><st c="69846">Ctrl</st></em><st c="69850"> + </st><em class="italic"><st c="69853">Shift</st></em><st c="69858"> + </st><em class="italic"><st c="69861">X</st></em><st c="69862">) and entering </st><strong class="source-inline"><st c="69877">Snyk</st></strong><st c="69881"> in the search bar. </st><st c="69901">Click on the first instance of Snyk, as shown in the following screenshot, and </st><span class="No-Break"><st c="69980">then </st></span><span class="No-Break"><strong class="bold"><st c="69985">Install</st></strong></span><span class="No-Break"><st c="69992">:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer092" class="IMG---Figure">
					<img src="image/B19710_04_22.jpg" alt="Figure 4.22 – Installing Snyk Visual Studio Code extension"/><st c="69994"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="70691">Figure 4.22 – Installing Snyk Visual Studio Code extension</st></p>
			<ol>
				<li value="4"><st c="70749">Next, let’s configure the Snyk Visual Studio Code extension. </st><st c="70811">We configure the extension</st><a id="_idIndexMarker381"/><st c="70837"> from the extension settings, which can be accessed by clicking on the Snyk logo on the left and clicking on the</st><a id="_idIndexMarker382"/><st c="70949"> settings icon, then </st><span class="No-Break"><strong class="bold"><st c="70970">Extension Settings</st></strong></span><span class="No-Break"><st c="70988">:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer093" class="IMG---Figure">
					<img src="image/B19710_04_23.jpg" alt="Figure 4.23 – Snyk extension settings"/><st c="70990"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="71503">Figure 4.23 – Snyk extension settings</st></p>
			<ol>
				<li value="5"><st c="71540">Now, let’s configure the Synk extension </st><span class="No-Break"><st c="71581">as follows:</st></span><ul><li><strong class="bold"><st c="71592">Advanced: Additional Parameters</st></strong> <span class="No-Break"><st c="71624">to </st></span><span class="No-Break"><strong class="source-inline"><st c="71628">--all-projects</st></strong></span></li><li><strong class="bold"><st c="71642">Advanced: Automatic Dependency Management</st></strong> <span class="No-Break"><st c="71684">is checked</st></span></li><li><strong class="bold"><st c="71695">Advanced Auto Scan Open Source Security</st></strong> <span class="No-Break"><st c="71735">is checked:</st></span></li></ul></li>
			</ol>
			<div>
				<div id="_idContainer094" class="IMG---Figure">
					<img src="image/B19710_04_24.jpg" alt="Figure 4.24 – Snyk advanced extension settings"/><st c="71747"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="72486">Figure 4.24 – Snyk advanced extension settings</st></p>
			<ol>
				<li value="6"><st c="72532">Check </st><a id="_idIndexMarker383"/><st c="72539">the </st><strong class="bold"><st c="72543">Code Quality</st></strong><st c="72555">, </st><strong class="bold"><st c="72557">Code Security</st></strong><st c="72570">, </st><strong class="bold"><st c="72572">Infrastructure As Code</st></strong><st c="72594">, and </st><strong class="bold"><st c="72600">Open Source Security</st></strong> <span class="No-Break"><st c="72620">Snyk features:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer095" class="IMG---Figure">
					<img src="image/B19710_04_25.jpg" alt="Figure 4.25 – Snyk features extension settings"/><st c="72635"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="72963">Figure 4.25 – Snyk features extension settings</st></p>
			<ol>
				<li value="7"><st c="73009">Lastly, make sure </st><strong class="bold"><st c="73028">Snyk: Scanning Mode</st></strong><st c="73047"> is set to </st><strong class="bold"><st c="73058">auto</st></strong><st c="73062"> and </st><strong class="bold"><st c="73067">Snyk: Severity</st></strong><st c="73081"> is checked</st><a id="_idIndexMarker384"/><st c="73092"> for </st><strong class="bold"><st c="73097">critical</st></strong><st c="73105">, </st><strong class="bold"><st c="73107">high</st></strong><st c="73111">, </st><strong class="bold"><st c="73113">medium</st></strong><st c="73119">, and </st><strong class="bold"><st c="73125">low</st></strong><st c="73128">, as </st><a id="_idIndexMarker385"/><st c="73133">shown in the </st><span class="No-Break"><st c="73146">following screenshot:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer096" class="IMG---Figure">
					<img src="image/B19710_04_26.jpg" alt="Figure 4.26 – Snyk scanning and severity extension settings"/><st c="73167"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="73349">Figure 4.26 – Snyk scanning and severity extension settings</st></p>
			<ol>
				<li value="8"><st c="73408">For Synk to scan your projects, you must be authenticated with Snyk using your Snyk API token. </st><st c="73504">Click on the Snyk icon, then select </st><strong class="bold"><st c="73540">Trust workspace </st></strong><span class="No-Break"><strong class="bold"><st c="73556">and connect</st></strong></span><span class="No-Break"><st c="73567">:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer097" class="IMG---Figure">
					<img src="image/B19710_04_27.jpg" alt="Figure 4.27 – Setting up Snyk code extension authentication"/><st c="73569"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="73996">Figure 4.27 – Setting up Snyk code extension authentication</st></p>
			<ol>
				<li value="9"><st c="74055">Clicking </st><strong class="bold"><st c="74065">Trust workspace and connect</st></strong><st c="74092"> will take </st><a id="_idIndexMarker386"/><st c="74103">you to the Snyk web application</st><a id="_idIndexMarker387"/><st c="74134"> for authentication. </st><span class="No-Break"><st c="74155">Click </st></span><span class="No-Break"><strong class="bold"><st c="74161">Authenticate</st></strong></span><span class="No-Break"><st c="74173">:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer098" class="IMG---Figure">
					<img src="image/B19710_04_28.jpg" alt="Figure 4.28 – Snyk web application authentication"/><st c="74175"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="74326">Figure 4.28 – Snyk web application authentication</st></p>
			<ol>
				<li value="10"><st c="74375">After successful authentication, you will receive the confirmation as follows. </st><st c="74455">Close the browser and go back to Visual </st><span class="No-Break"><st c="74495">Studio Code:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer099" class="IMG---Figure">
					<img src="image/B19710_04_29.jpg" alt="Figure 4.29 – Snyk successful authentication"/><st c="74507"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="74589">Figure 4.29 – Snyk successful authentication</st></p>
			<p><st c="74633">We can now</st><a id="_idIndexMarker388"/><st c="74644"> proceed to </st><em class="italic"><st c="74656">Task 3</st></em><st c="74662"> after successfully configuring </st><a id="_idIndexMarker389"/><st c="74694">the </st><span class="No-Break"><st c="74698">Snyk extension.</st></span></p>
			<p class="callout-heading"><st c="74713">Visual Studio Code extension authentication</st></p>
			<p class="callout"><st c="74757">Please note, if the above steps cannot successfully configure your Synk extension, you may need to manually set the token by </st><span class="No-Break"><st c="74883">following these:</st></span></p>
			<ul>
				<li class="callout"><a href="https://docs.snyk.io/scm-ide-and-ci-cd-integrations/snyk-ide-plugins-and-extensions/visual-studio-code-extension/visual-studio-code-extension-authentication"><span class="No-Break"><st c="74899">https://docs.snyk.io/scm-ide-and-ci-cd-integrations/snyk-ide-plugins-and-extensions/visual-studio-code-extension/visual-studio-code-extension-authentication</st></span></a></li>
				<li class="callout"><a href="https://docs.snyk.io/getting-started/how-to-obtain-and-authenticate-with-your-snyk-api-token"><span class="No-Break"><st c="75056">https://docs.snyk.io/getting-started/how-to-obtain-and-authenticate-with-your-snyk-api-token</st></span></a></li>
			</ul>
			<h2 id="_idParaDest-91"><a id="_idTextAnchor092"/><st c="75149">Task 3 – Importing eShopOnWeb to your Visual Studio Code workspace</st></h2>
			<p><st c="75216">In this task, we will </st><a id="_idIndexMarker390"/><st c="75239">import the application we will be working on </st><span class="No-Break"><st c="75284">going forward:</st></span></p>
			<ol>
				<li><st c="75298">We will be</st><a id="_idIndexMarker391"/><st c="75309"> reviewing </st><strong class="source-inline"><st c="75320">eShopOnWeb</st></strong><st c="75330"> application for security vulnerabilities in your Visual Studio Code editor. </st><st c="75407">Navigate to </st><strong class="bold"><st c="75419">EXPLORER</st></strong><st c="75427"> on the left pane of your Visual Studio Code editor and click on </st><span class="No-Break"><strong class="bold"><st c="75492">Clone Repository</st></strong></span><span class="No-Break"><st c="75508">:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer100" class="IMG---Figure">
					<img src="image/B19710_04_30.jpg" alt="Figure 4.30 – Clone Repository"/><st c="75510"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="75838">Figure 4.30 – Clone Repository</st></p>
			<ol>
				<li value="2"><st c="75868">Paste </st><a id="_idIndexMarker392"/><st c="75875">the </st><strong class="source-inline"><st c="75879">eShopOnWeb</st></strong><st c="75889"> repository (</st><a href="https://github.com/PacktPublishing/eShopOnWeb_DevSecOps"><st c="75902">https://github.com/PacktPublishing/eShopOnWeb_DevSecOps</st></a><st c="75958">) to clone from GitHub, then select the </st><strong class="bold"><st c="75999">Clone from URL </st></strong><span class="No-Break"><strong class="bold"><st c="76014">https://github.com/PacktPublishing/eShopOnWeb_DevSecOps</st></strong></span><span class="No-Break"><st c="76069"> option:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer101" class="IMG---Figure">
					<img src="image/B19710_04_31.jpg" alt="Figure 4.31 – Clone from GitHub"/><st c="76077"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="76209">Figure 4.31 – Clone from GitHub</st></p>
			<ol>
				<li value="3"><st c="76240">You will be</st><a id="_idIndexMarker393"/><st c="76252"> required to select a folder as the repository destination. </st><st c="76312">Click </st><strong class="bold"><st c="76318">New folder</st></strong><st c="76328">, name the folder </st><strong class="source-inline"><st c="76346">eShop</st></strong><st c="76351">, and then click </st><strong class="bold"><st c="76368">Select as </st></strong><span class="No-Break"><strong class="bold"><st c="76378">Repository Destination</st></strong></span><span class="No-Break"><st c="76400">:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer102" class="IMG---Figure">
					<img src="image/B19710_04_32.jpg" alt="Figure 4.32 – Selecting a folder as the repository destination"/><st c="76402"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="76702">Figure 4.32 – Selecting a folder as the repository destination</st></p>
			<ol>
				<li value="4"><st c="76764">A popup</st><a id="_idIndexMarker394"/><st c="76772"> will </st><a id="_idIndexMarker395"/><st c="76778">appear on the bottom-right corner of Visual Studio Code showing the status of the cloning. </st><st c="76869">After completion, you will be asked to open the cloned repository; </st><span class="No-Break"><st c="76936">click </st></span><span class="No-Break"><strong class="bold"><st c="76942">Open</st></strong></span><span class="No-Break"><st c="76946">:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer103" class="IMG---Figure">
					<img src="image/B19710_04_33.jpg" alt="Figure 4.33 – Opening cloned repository"/><st c="76948"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="77055">Figure 4.33 – Opening cloned repository</st></p>
			<ol>
				<li value="5"><st c="77094">You will be asked if you trust the authors of the files in the folder. </st><st c="77166">Select </st><strong class="bold"><st c="77173">Yes, I trust </st></strong><span class="No-Break"><strong class="bold"><st c="77186">the authors</st></strong></span><span class="No-Break"><st c="77197">:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer104" class="IMG---Figure">
					<img src="image/B19710_04_34.jpg" alt="Figure 4.34 – Trusting the authors of files"/><st c="77199"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="77601">Figure 4.34 – Trusting the authors of files</st></p>
			<ol>
				<li value="6"><st c="77644">Snyk will </st><a id="_idIndexMarker396"/><st c="77655">then</st><a id="_idIndexMarker397"/><st c="77659"> send a notification (in the bottom-right corner of Visual Studio Code) asking </st><strong class="bold"><st c="77738">Trust folders and continue</st></strong><st c="77764"> or </st><strong class="bold"><st c="77768">Don’t trust folders</st></strong><st c="77787">. Select </st><strong class="bold"><st c="77796">Trust folders </st></strong><span class="No-Break"><strong class="bold"><st c="77810">and continue</st></strong></span><span class="No-Break"><st c="77822">.</st></span></li>
				<li><st c="77823">Snyk will then start analyzing the files and give the number of security issues in the bottom-left corner of your Visual Studio </st><span class="No-Break"><st c="77952">Code editor:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer105" class="IMG---Figure">
					<img src="image/B19710_04_35.jpg" alt="Figure 4.35 – Snyk showing the number of security issues"/><st c="77964"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="78003">Figure 4.35 – Snyk showing the number of security issues</st></p>
			<ol>
				<li value="8"><st c="78059">Click on the number of problems; this will then show the details of security vulnerabilities found </st><span class="No-Break"><st c="78159">by Snyk:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer106" class="IMG---Figure">
					<img src="image/B19710_04_36.jpg" alt="Figure 4.36 – List of security issues found on eShop"/><st c="78167"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="79438">Figure 4.36 – List of security issues found on eShop</st></p>
			<ol>
				<li value="9"><st c="79490">Go through </st><a id="_idIndexMarker398"/><st c="79502">the </st><a id="_idIndexMarker399"/><st c="79506">list of code security, configuration, and code quality issues to understand some of the </st><span class="No-Break"><st c="79594">issues found:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer107" class="IMG---Figure">
					<img src="image/B19710_04_37.jpg" alt="Figure 4.37 – Code security, configuration, and code quality on eShop"/><st c="79607"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="80738">Figure 4.37 – Code security, configuration, and code quality on eShop</st></p>
			<p><st c="80807">Review the list of errors generated for code security, configuration, and code quality. </st><st c="80896">Select one code security error to understand details about the vulnerability, the line of code that is vulnerable, and suggestions to fix </st><span class="No-Break"><st c="81034">the vulnerabilities.</st></span></p>
			<h1 id="_idParaDest-92"><a id="_idTextAnchor093"/><st c="81054">Hands-on exercise 2 – Installing and configuring Git pre-commit hooks on the IDE</st></h1>
			<p><st c="81135">In this exercise, we </st><a id="_idIndexMarker400"/><st c="81157">will install and configure Git pre-commit hooks. </st><st c="81206">As we discussed earlier, a pre-commit hook is a specific type of Git hook that is triggered right before a commit is recorded. </st><st c="81333">We will be using the pre-commit framework (</st><a href="https://pre-commit.com"><st c="81376">https://pre-commit.com</st></a><st c="81399">). </st><st c="81403">The </st><a id="_idIndexMarker401"/><st c="81407">pre-commit framework allows developers to leverage a wide array </st><a id="_idIndexMarker402"/><st c="81471">of existing hooks and easily integrate them into their repositories. </st><st c="81540">A list of supported hooks can be found here: </st><a href="https://pre-commit.com/hooks.html"><st c="81585">https://pre-commit.com/hooks.html</st></a><st c="81618">. The hooks are defined in a </st><strong class="source-inline"><st c="81647">.pre-commit-config.yaml</st></strong><st c="81670"> file, and the tool takes care of installing them into the appropriate Git </st><span class="No-Break"><st c="81745">hooks directory.</st></span></p>
			<p><st c="81761">Following are the tasks that we will complete in </st><span class="No-Break"><st c="81811">this exercise:</st></span></p>
			<ul>
				<li><strong class="bold"><st c="81825">Task 1</st></strong><st c="81832">: Installing pre-commit framework on Visual </st><span class="No-Break"><st c="81877">Studio Code</st></span></li>
				<li><strong class="bold"><st c="81888">Task 2</st></strong><st c="81895">: Configuring </st><strong class="source-inline"><st c="81910">detect-private key</st></strong><st c="81928"> and </st><strong class="source-inline"><st c="81933">detect-secrets</st></strong><st c="81947"> pre-commit hooks on Visual </st><span class="No-Break"><st c="81975">Studio Code</st></span></li>
			</ul>
			<h2 id="_idParaDest-93"><a id="_idTextAnchor094"/><st c="81986">Task 1 – Installing pre-commit framework on Visual Studio Code</st></h2>
			<p><st c="82049">In this task, we </st><a id="_idIndexMarker403"/><st c="82067">will set up a </st><a id="_idIndexMarker404"/><st c="82081">pre-commit framework tool within Visual </st><span class="No-Break"><st c="82121">Studio Code:</st></span></p>
			<ol>
				<li><st c="82133">Install the pre-commit package manager using </st><strong class="source-inline"><st c="82179">pip</st></strong><st c="82182">. Run the following command on your Visual </st><span class="No-Break"><st c="82225">Studio terminal:</st></span><pre class="source-code">
<strong class="bold"><st c="82241">pip install pre-commit</st></strong></pre></li>				<li><st c="82264">Run </st><strong class="source-inline"><st c="82269">pre-commit --version</st></strong><st c="82289"> to show what version of pre-commit </st><span class="No-Break"><st c="82325">was installed:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer108" class="IMG---Figure">
					<img src="image/B19710_04_38.jpg" alt="Figure 4.38 – Pre-commit version installed"/><st c="82339"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="82455">Figure 4.38 – Pre-commit version installed</st></p>
			<h2 id="_idParaDest-94"><a id="_idTextAnchor095"/><st c="82497">Task 2 – Configuring detect-private key and detect-secrets pre-commit hooks on Visual Studio Code</st></h2>
			<p><st c="82595">In this task, we </st><a id="_idIndexMarker405"/><st c="82613">will configure two pre-commit hooks. </st><st c="82650">Review </st><a id="_idIndexMarker406"/><st c="82657">the list of </st><a id="_idIndexMarker407"/><st c="82669">supported hooks on </st><a href="https://pre-commit.com/hooks.html"><st c="82688">https://pre-commit.com/hooks.html</st></a><st c="82721">. You can configure more than one hook in the </st><strong class="source-inline"><st c="82767">.pre-commit-config.yaml</st></strong><st c="82790"> file. </st><st c="82797">In this task, we will be configuring the </st><strong class="source-inline"><st c="82838">detect-private-key</st></strong><st c="82856"> from </st><a href="https://github.com/pre-commit/pre-commit-hooks"><st c="82862">https://github.com/pre-commit/pre-commit-hooks</st></a><st c="82908"> and </st><strong class="source-inline"><st c="82913">detect-secrets</st></strong> <span class="No-Break"><st c="82927">from </st></span><a href="http://github.com/Yelp/detect-secrets"><span class="No-Break"><st c="82933">github.com/Yelp/detect-secrets</st></span></a><span class="No-Break"><st c="82963">:</st></span></p>
			<ol>
				<li><st c="82965">Create a file within the root directory of the </st><strong class="source-inline"><st c="83012">eShoponWeb</st></strong><st c="83022"> application and name </st><span class="No-Break"><st c="83044">it </st></span><span class="No-Break"><strong class="source-inline"><st c="83047">.pre-commit-config.yaml</st></strong></span><span class="No-Break"><st c="83070">.</st></span></li>
				<li><st c="83071">Add the following script in the </st><strong class="source-inline"><st c="83104">.</st></strong><span class="No-Break"><strong class="source-inline"><st c="83105">pre-commit-config.yaml</st></strong></span><span class="No-Break"><st c="83128"> file:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer109" class="IMG---Figure">
					<img src="image/B19710_04_39.jpg" alt="Figure 4.39 – Configuring pre-commit hooks"/><st c="83134"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="83343">Figure 4.39 – Configuring pre-commit hooks</st></p>
			<ol>
				<li value="3"><st c="83385">Let’s now install the Git hook scripts by running </st><span class="No-Break"><strong class="source-inline"><st c="83436">pre-commit install</st></strong></span><span class="No-Break"><st c="83454">:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer110" class="IMG---Figure">
					<img src="image/B19710_04_40.jpg" alt="Figure 4.40 – Installing Git hook scripts"/><st c="83456"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="83568">Figure 4.40 – Installing Git hook scripts</st></p>
			<ol>
				<li value="4"><st c="83609">We will now run the hooks against all files available in the </st><span class="No-Break"><strong class="source-inline"><st c="83671">eShoponWeb</st></strong></span><span class="No-Break"><st c="83681"> directory:</st></span></li>
			</ol>
			<div>
				<div id="_idContainer111" class="IMG---Figure">
					<img src="image/B19710_04_41.jpg" alt="Figure 4.41 – Running Git hooks against all files"/><st c="83692"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><st c="84601">Figure 4.41 – Running Git hooks against all files</st></p>
			<p><st c="84650">We see that</st><a id="_idIndexMarker408"/><st c="84662"> both pre-commit hooks failed becaus</st><a id="_idTextAnchor096"/><st c="84698">e a private key was detected, and secrets were found in several locations listed. </st><st c="84781">It is best practice to fix errors and then commit </st><span class="No-Break"><st c="84831">the changes.</st></span></p>
			<p><st c="84843">Since we have configured these two pre-commit hooks, this will prevent commits from happening if there are any private keys </st><span class="No-Break"><st c="84968">and secrets.</st></span></p>
			<h1 id="_idParaDest-95"><a id="_idTextAnchor097"/><st c="84980">Summary</st></h1>
			<p><st c="84988">In this chapter, we examined two primary security concerns for this development phase. </st><st c="85076">First, we looked at ensuring a secure development environment or workspace. </st><st c="85152">This means making sure that tools and platforms where coding occurs, such as IDEs, are safe from vulnerabilities. </st><st c="85266">We also touched on the risks of malicious IDE extensions and the challenges when dealing with untrusted code. </st><st c="85376">We highlighted the need for measures to counteract any potential IDE breaches. </st><st c="85455">Second, we tackled common coding errors that can lead to security issues. </st><st c="85529">We introduced tools such as secret scanning to detect exposed sensitive data, SAST to find code vulnerabilities, and SCA to check third-party components for security risks. </st><st c="85702">With this knowledge, you’re now better equipped to handle security challenges before committing code in the DevOps process. </st><st c="85826">Up to this point in the book, our DevSecOps discussion has not focused on Azure. </st><st c="85907">That is because there has not been much Azure-specific content to discuss up to the pre-commit stage. </st><st c="86009">This will change in the next chapter, where we will discuss the integration of security in source control, with an Azure tooling focus. </st><st c="86145">See </st><span class="No-Break"><st c="86149">you there!</st></span></p>
		</div>
	<div id="charCountTotal" value="86159"/></body></html>