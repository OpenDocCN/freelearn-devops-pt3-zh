<html><head></head><body><div id="sbo-rt-content"><div id="_idContainer166">
			<h1 id="_idParaDest-156"><a id="_idTextAnchor157"/><a href="B17124_07_Final_SK_ePub.xhtml#_idTextAnchor157"><em class="italic">Chapter 7</em></a>: AWS Compute Services</h1>
			<p>In the old days, traditional on-premises environments consisted of a wide range of <em class="italic">servers</em> that used to host a varied gamut of applications, websites, and other services. These <em class="italic">servers</em> were physical hardware such as your home desktop computer but were designed with more robust components (such as CPU, memory and storage) to host applications for end user consumption. </p>
			<p>A <strong class="bold">server</strong> is a term given to an application running on computer hardware that grants access to a set of services, either to other applications or end users. A physical computer can host more than one "server" offering – for example, a computer may offer email services and web services on the same physical hardware.</p>
			<p>However, traditionally, you were limited in the number of servers you could configure your physical computer to host. This was primarily because of limited memory, storage, and, more importantly, the fact that applications would conflict with one another when accessing the underlying resources. These resources could be shared libraries and runtime environments, as well as access to physical hardware such as memory, storage, and so on.</p>
			<p>With the advent of virtualization, it then became possible to configure <strong class="bold">Virtual Machines </strong>(<strong class="bold">VMs</strong>) on a single physical host – each VM would offer one or more services and usually, these services were related to each other to avoid any conflicts. So, for example, you could have one virtual server offering email services and another offering file-sharing services.</p>
			<p><strong class="bold">Amazon Web Services</strong> (<strong class="bold">AWS</strong>) offers VMs in the cloud, which we call <strong class="bold">Elastic Compute Cloud</strong> or <strong class="bold">EC2</strong>. In this chapter, we will look at the core offering of the EC2 services, which allows us to host applications, websites, and other compute-intensive processing services on AWS. This chapter will also cover other forms of compute offerings, including a lightweight alternative to EC2, known as Lightsail, containers, and serverless offerings such as Lambda. </p>
			<p>The following topics will be covered in this chapter:</p>
			<ul>
				<li>Introduction to <strong class="bold">Elastic Compute Service</strong> (<strong class="bold">Amazon EC2</strong>)</li>
				<li>Learning about Amazon <strong class="bold">Elastic Block Storage</strong> (<strong class="bold">EBS</strong>) and instance backed store</li>
				<li>Learning about EC2 pricing options</li>
				<li>Implementing Shared File Storage with <strong class="bold">Amazon Elastic File System</strong> (<strong class="bold">Amazon EFS</strong>)</li>
				<li>Introduction to <strong class="bold">Virtual Private Servers</strong> (<strong class="bold">VPS</strong>) with Amazon Lightsail</li>
				<li>Introduction to Amazon <strong class="bold">Elastic Container Services</strong> (ECS) and Kubernetes</li>
				<li>Overview of additional storage options in AWS</li>
			</ul>
			<h1 id="_idParaDest-157"><a id="_idTextAnchor158"/>Introduction to Amazon EC2</h1>
			<p><strong class="bold">Amazon EC2</strong> is one of AWS's flagship offerings and allows you to launch and set up virtual servers in the cloud. These are very similar to <a id="_idIndexMarker626"/>setting up and configuring <strong class="bold">VMs</strong> in your on-premises environment, which you would <a id="_idIndexMarker627"/>configure on a hypervisor such as VMware or Hyper-V. </p>
			<p>A hypervisor, as discussed in <a href="B17124_01_Final_SK_ePub.xhtml#_idTextAnchor015"><em class="italic">Chapter 1</em></a>, <em class="italic">What Is Cloud Computing?</em>, is a piece of software that allows you to create virtual resources such as virtual servers. Depending on the capacity of the underlying hardware, you can then host multiple virtual servers on the same physical hardware. These virtual servers are granted access to actual physical hardware via the hypervisor, which carves out virtualized representations of the physical hardware components (CPU, memory, storage, and so on) into smaller virtual components, that are then presented to your virtual servers. You can access hypervisor software such as VMware and Hyper-V to create your virtual servers, selecting the virtual components and configuring them as required. Each virtual server, otherwise known as a VM, can then have an operating system installed and configured, along with any required applications.</p>
			<p>Amazon EC2, however, abstracts the underlying hypervisor layer from the customer, so you do not have direct access to the hypervisor itself. Using a self-service portal or API access, you can <a id="_idIndexMarker628"/>launch virtual servers, which we term as <strong class="bold">EC2 instances</strong>, in your AWS <a id="_idIndexMarker629"/>account and specifically, within your <strong class="bold">Virtual Private Cloud</strong> (<strong class="bold">VPC</strong>) (discussed in the previous chapter).</p>
			<p>Traditionally, on a VMware or Hyper-V management console, you would spin up a virtual server by specifying the exact amount of CPU and memory to configure your virtual server with. </p>
			<p>With AWS, you choose from a wide selection of available EC2 instance types and families. An EC2 instance family refers to the generic use case of the EC2 instance types contained within the family. For example, the <em class="italic">general-purpose </em>family is designed for handling workloads that require a balance of compute, memory, and networking resources. Within this <em class="italic">general-purpose</em> family, you have several EC2 instance types that refer to the underlying hardware of the host computer used for your instance. These EC2 instance types offer different combinations of compute, memory, and storage <a id="_idIndexMarker630"/>capabilities. So, for example, within the <em class="italic">general-purpose</em> family, you have instance types such as <strong class="bold">M5</strong> and <strong class="bold">T2</strong>. The <strong class="bold">T2</strong> instance type runs on Intel Xeon processors, offers a burstable CPU, and is designed to offer a balance of compute, memory, and network resources. The <strong class="bold">M5</strong> instance type runs on Intel Xeon® Platinum 8175M processors and offers up to 384 GiB of memory and up to 25 Gbps network bandwidth using Enhanced Networking.</p>
			<p>Within each EC2 instance type, you also have instance sizes. When selecting an EC2 instance for your application, you need to identify the family, the type, and select the size of the instance. For example, within the <strong class="bold">T2</strong> instance type, you have several sizes, such as <strong class="source-inline">t2.micro</strong> and <strong class="source-inline">t2.xlarge</strong>. The <strong class="source-inline">t.2micro</strong> instance size, only comes with 1 GiB of memory and 1 vCPU, whereas <strong class="source-inline">t2.xlarge</strong> comes with 16 GiB of memory and 4 vCPUs.</p>
			<p>We will discuss the EC2 instance families, types, and sizes in more detail shortly. Suffice to say that you have access to a very large selection of EC2 instance types and sizes to meet the requirements of your applications. </p>
			<p>In addition to your EC2 instance type, which defines CPU, memory, and other hardware-related components, you also need to attach a block storage device such as an EBS volume or an instance-store volume, as discussed in the <em class="italic">Learning about Amazon Elastic Block Storage and instance backed store</em> section in this chapter. At the very least, you will need one EBS volume to host the operating system and make the server bootable into a fully functioning server. We'll review different types of block storage for EC2 instances later in this chapter.</p>
			<p>In addition <a id="_idIndexMarker631"/>to specifying the instance type and family, you also need to choose a particular <strong class="bold">Amazon Machine Image</strong> (<strong class="bold">AMI</strong>) to configure your EC2 instance with. AMIs are snapshots that contain base operating systems, utilities, and any applications you want to configure your EC2 instance with. We'll look at AMIs in more detail shortly.</p>
			<p>An important point to note here is that EC2 instances are Region-specific. More appropriately, EC2 instances are tied into the Availability Zone you launch them in. When you choose to launch a new EC2 instance, you must specify the subnet of a VPC in which to launch that EC2 instance. The subnet will be tied to a given Availability Zone, as discussed in the previous chapter. So, ultimately, you dictate which Availability Zone the EC2 instances gets launched into.</p>
			<p>The following <a id="_idIndexMarker632"/>diagram shows a high-level infrastructure architecture and the key features that support the Amazon EC2 service:</p>
			<div>
				<div id="_idContainer130" class="IMG---Figure">
					<img src="Images/B17124_07_01.jpg" alt="Figure 7.1 – EC2 instance components&#13;&#10;" width="1185" height="527"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.1 – EC2 instance components</p>
			<p>Some key features <a id="_idIndexMarker633"/>in the preceding diagram of EC2 instances include the following:</p>
			<ul>
				<li>EC2 instances are VMs built out of the physical host located in the same Availability Zone.</li>
				<li>With network and storage virtualization technologies, each EC2 instance is allocated at least one elastic network interface (virtual network card or virtual <strong class="bold">network interface card</strong> (<strong class="bold">NIC</strong>)) for data. You can have additional virtual NICs for configuring <a id="_idIndexMarker634"/>multi-homed devices.</li>
				<li>An EC2 instance can be configured to have a portion of the instance store volume (attached locally to the host that it runs on) or EBS volumes, which are attached to a storage array in the same Availability Zone.</li>
			</ul>
			<p>As shown in the preceding diagram, the EC2 instance that was deployed in <strong class="bold">Availability Zone 2A</strong> has a single elastic network interface and two EBS volumes attached, one as the root volume (C Drive on Windows Servers) that's 30 GB in size and another as the data volume that's 60 GB in size. We will discuss block storage volumes later in this chapter.</p>
			<p>In the next section, we will <a id="_idIndexMarker635"/>look at AMIs. AMIs are VM images that are <em class="italic">like</em> your on-premises <strong class="bold">virtual hard disk</strong> (<strong class="bold">VHD</strong>) images. These VHDs are disk image file formats that contain the contents of a hard drive, including the operating system files as well as any applications that you wish to configure a server with. AMIs are much more than simple VHDs however, as they are also comprised of snapshots, permissions, and mappings that specify the volumes to attach to the instance when it's launched. On AWS, when you launch an instance, you need to select an AMI to configure that instance with. For example, an AMI can contain a Linux operating system image and any additional application to configure an instance as a web server.</p>
			<h2 id="_idParaDest-158"><a id="_idTextAnchor159"/>Amazon Machine Images (AMIs)</h2>
			<p>Traditionally, when you are launching a new VM on your on-premises VMware or Hyper-V host, you would specify a particular operating system image (such as an <strong class="source-inline">.iso</strong> file). This would <a id="_idIndexMarker636"/>contain the operating system files necessary to install your VM. You may have also modified the machine image with any additional applications and/or utilities. </p>
			<p>AMIs are the AWS equivalent of VM images, containing the baseline operating system and any additional applications.  </p>
			<p>AMIs are Amazon EBS snapshots or a template of the root volume (for instance, store-backed AMIs). These snapshots or templates contain the operating system and any necessary applications. In addition, AMIs contain information on block device mappings that specify the volumes to attach to the instance when it is launched.</p>
			<p>Amazon offers several pre-configured AMIs as part of its <strong class="bold">Quick Start AMIs</strong> and these include standard <a id="_idIndexMarker637"/>operating systems, such as the official versions of various Linux distributions, including <strong class="bold">Red Hat Enterprise Linux</strong> (<strong class="bold">RHEL</strong>), Ubuntu, SUSE, and even Amazon's flavor <a id="_idIndexMarker638"/>called Amazon Linux. In addition, you also have access to several editions of Microsoft's Windows Server operating system and even macOS, which runs on a physical Apple Mac Mini in the backend:</p>
			<div>
				<div id="_idContainer131" class="IMG---Figure">
					<img src="Images/B17124_07_02.jpg" alt="Figure 7.2 – AMIs&#13;&#10;" width="1145" height="623"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.2 – AMIs</p>
			<p>As shown in the <a id="_idIndexMarker639"/>preceding screenshot, for each AMI, you also have details of the release number, whether the root device type is <strong class="bold">EBS</strong> or <strong class="bold">Instance</strong>, the type of virtualization architecture, the volume type (for example, SSD), and if the AMI supports Enhanced Networking.  </p>
			<p>AMIs offered as part of the Quick Start AMIs come with any necessary licensing built into the cost of the EC2 instance that you deploy that AMI on. While you do not need a separate licensing contract to be drawn up to spin up these servers, the hourly charge you pay to Amazon will include the licensing cost. </p>
			<p>Note, however, that the licensing that comes with any AMI is only for what is already bundled as part of the image. Any additional configurations or the installation of additional applications may carry further licensing requirements that need to be procured separately.</p>
			<p>When you select a particular AMI as part of configuring a new EC2 instance, the image is extracted to the <a id="_idIndexMarker640"/>instance's newly attached block storage volume and made bootable. This, in turn, configures the EC2 instance as a fully functioning server.</p>
			<p>Some additional points to be aware of about AMIs include the following:</p>
			<ul>
				<li>AMIs are Region-specific. This means that if you want to launch a particular instance configuration in a Region, the AMI must be available in that Region.</li>
				<li>AMIs can be copied across Regions if you need to launch a specific configuration in a Region and the required AMI is not available in that Region. For more details on how to create and copy AMIs, refer to the Amazon documentation at <a href="https://aws.amazon.com/premiumsupport/knowledge-center/copy-ami-region/">https://aws.amazon.com/premiumsupport/knowledge-center/copy-ami-region/</a>.</li>
			</ul>
			<p>In addition to the Quick Start AMIs, you have other sources to obtain these machine images. These include the following:</p>
			<ul>
				<li><strong class="bold">AWS Marketplace</strong>: This is a software store managed by AWS where third-party vendors <a id="_idIndexMarker641"/>can sell their applications, often bundled as ready-to-use AMIs. Companies such as F5, Citrix, Oracle, and McAfee, among many others, sell their solutions, which can be launched with Amazon EC2 instances. Pricing is according to the owner of the AMI, plus the cost of the specific EC2 instance type you are running the AMI on. You can review <a id="_idIndexMarker642"/>the AWS Marketplace offering at <a href="https://aws.amazon.com/marketplace">https://aws.amazon.com/marketplace</a>.</li>
				<li><strong class="bold">Community AMIs</strong>: It is possible to make your AMIs public and thus make them accessible <a id="_idIndexMarker643"/>to the wider community via the Community AMI link. There are thousands of different AMIs designed to address specialized software and operating system bundles that are not generally available via the Quick Start AMIs or Marketplace. You can often find a more specific Linux distribution here such as CentOS, which is a very popular AMI that businesses use to host applications. Community AMIs are free to use but you pay for the EC2 instance <a id="_idIndexMarker644"/>charge. In addition, many AMIs are provided "as-is," with no additional support, so caution would be required when selecting a Community AMI.</li>
			</ul>
			<h3>Creating your own AMIs</h3>
			<p>In addition to obtaining AMIs from AWS or the Marketplace, you can create your own AMIs. This involves <a id="_idIndexMarker645"/>creating an image of a running EC2 instance you have that creates a snapshot of the EBS volume attached to the instance. You can then use the image (AMI) to launch new EC2 instances.</p>
			<p>You generally create an AMI because you want to store a copy of a specific configuration that needs to be deployed across multiple EC2 instances in your account or even globally. Rather than having to manually configure every new instance to meet your specific requirements, you can configure one EC2 instance just the way you need it (with the right operating system patches, applications, anti-virus software, and so on) and then create an AMI of it. Then, when it comes to launching more EC2 instances with the same configuration, you can simply launch new instances with that AMI. This is also known as <strong class="bold">prebaking an AMI</strong> and is often <a id="_idIndexMarker646"/>used as a strategy to quickly provision new instances and minimize manual errors or misconfigurations. </p>
			<p>In this section, we looked at AMIs and how they are used to provision new EC2 instances with an operating system and any required applications. We also discussed how you can obtain AMIs and, if necessary, create your own. In the next section, we will discuss the different types of EC2 instances you can deploy.</p>
			<h2 id="_idParaDest-159"><a id="_idTextAnchor160"/>Exploring EC2 instance types</h2>
			<p>AWS offers a wide <a id="_idIndexMarker647"/>selection of EC2 instances that come with <a id="_idIndexMarker648"/>different virtual hardware configurations, called <strong class="bold">instance types</strong>. An EC2 instance type defines a particular specification of the virtual hardware components <a id="_idIndexMarker649"/>of the EC2 instance, such as the amount of processing power in terms of <strong class="bold">Virtual CPUs</strong> (<strong class="bold">vCPUs</strong>) and memory, the type of storage, and networking configuration. Depending on your application requirements, you can select an appropriate EC2 instance type from the wide selection available.</p>
			<p>As we mentioned earlier, EC2 instances are broken down by <em class="italic">families</em> and within each <em class="italic">family</em>, there are <em class="italic">i</em><em class="italic">nstance types</em>. These instance types are then broken down further by <strong class="bold">instance size</strong>, which comes with specific configurations of virtualized hardware. The following are the core EC2 instance families:</p>
			<ul>
				<li><strong class="bold">General purpose</strong>: Designed for a balance of compute, memory, and networking resources and ideal for a wide range of workload types.</li>
				<li><strong class="bold">Compute optimized</strong>: Designed for high-performance processing. Ideal for batch <a id="_idIndexMarker650"/>processing workloads, media transcoding, high-performance web servers, and <strong class="bold">high-performance computing</strong> (<strong class="bold">HPC</strong>).</li>
				<li><strong class="bold">Memory-optimized</strong>: Designed to deliver fast performance for workloads that process large datasets in memory.</li>
				<li><strong class="bold">Accelerated computing</strong>: Designed with hardware accelerators, or co-processors, to perform complex functions. Ideal for floating-point number calculations, graphics processing, or data pattern matching.</li>
				<li><strong class="bold">Storage-optimized</strong>: Designed for computing that requires high sequential read and write access to very large datasets on local storage.</li>
			</ul>
			<p>Within each family, you have several EC2 instance types. So, for example, under the <em class="italic">general-purpose</em> family, you have instance types such as <strong class="bold">T2</strong>, <strong class="bold">M5</strong>, and <strong class="bold">A1</strong>. You can review the <a id="_idIndexMarker651"/>various instance types in the Amazon documentation at <a href="https://aws.amazon.com/ec2/instance-types/">https://aws.amazon.com/ec2/instance-types/</a>.</p>
			<p>The <strong class="bold">M5</strong> instance type, for example, is powered by Intel Xeon® Platinum 8175M processors. It is <a id="_idIndexMarker652"/>ideal for applications that require a balance of compute, memory, and network resources. Additional features of this type include the fact that it offers up to 25 Gbps network bandwidth using Enhanced Networking and is powered by the AWS Nitro System, which is Amazon's architecture design that offers a combination of dedicated hardware and a lightweight hypervisor.</p>
			<p>Within the <strong class="bold">M5</strong> instance type, there are different instance sizes, from which you get to choose an appropriate size for your specific application needs. The following is a screenshot of some of the instance sizes that fall under the M5 instance type:</p>
			<div>
				<div id="_idContainer132" class="IMG---Figure">
					<img src="Images/B17124_07_03.jpg" alt="Figure 7.3 – Sample selection of M5 instance sizes&#13;&#10;" width="1013" height="254"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.3 – Sample selection of M5 instance sizes</p>
			<p>When you review <a id="_idIndexMarker653"/>the list of instance sizes, it stands to reason that the higher the vCPU and memory, the more performance that's offered by the instance size. Depending on your application requirements, you then select the most appropriate size that matches your requirements.</p>
			<h3>Dedicated categories</h3>
			<p>In addition to the standard instances that you can deploy on AWS, you can also opt for <strong class="bold">Dedicated Instances</strong> and <strong class="bold">Dedicated Hosts</strong>. These options allow you to fulfill any compliance or regulatory requirements that state that you cannot use EC2 instances deployed on <a id="_idIndexMarker654"/>shared hosting, which is the default deployment option. Note that even though your EC2 instance may run on shared hardware with other customers, the underlying infrastructure offers isolation, and you cannot access other customers' EC2 instances unless you've been granted the necessary level of access by those other customers.</p>
			<p>A <strong class="bold">Dedicated Instance</strong> is an EC2 instance that is deployed in your VPC on physical hardware that is <a id="_idIndexMarker655"/>dedicated to you and not shared with other customers.  </p>
			<p>A <strong class="bold">Dedicated Host</strong> is a physical host dedicated for your use alone and gives you additional control <a id="_idIndexMarker656"/>and management capabilities over how instances are placed on a physical server. In addition, dedicated hosts can help address certain third-party licensing terms based on a per-CPU core/socket basis.  </p>
			<p>In the next section, we will look at the block storage options that are available for your EC2 instances. Block storage allows you to attach block volumes to your EC2 instances, much like you would attach a hard disk to your physical servers. The root volume hosts the operating system to boot your virtual server from, and additional volumes can host data and applications for your servers.</p>
			<h1 id="_idParaDest-160"><a id="_idTextAnchor161"/>Learning about Amazon EBS and instance backed store</h1>
			<p>Like virtual servers in your on-premises environment, EC2 instances require accessible block <a id="_idIndexMarker657"/>storage volume to host the instance operating <a id="_idIndexMarker658"/>system, data, and applications that need to run on the server. AWS offers <a id="_idIndexMarker659"/>two types <a id="_idIndexMarker660"/>of block storage options: <strong class="bold">Elastic Block Store</strong> and <strong class="bold">instance store volumes</strong>.</p>
			<h2 id="_idParaDest-161"><a id="_idTextAnchor162"/>Amazon Elastic Block Store</h2>
			<p>Amazon Elastic Block Store offers a high-performance block storage service for your EC2 instances. These act as virtual hard drives for your virtual servers deployed in the cloud. Amazon EBS is a network storage service similar in nature <a id="_idIndexMarker661"/>to the way you would attach a storage volume from a <strong class="bold">Storage Area Network</strong> (<strong class="bold">SAN</strong>) to your VMs deployed on VMware, in an on-premises environment.</p>
			<p>You would provision the required EBS volume, such as 8 GB, 30 GB, 1,000 GB, or whatever size you require, and attach it to your EC2 instance. EC2 instances require a root volume (or a system drive on Windows machines, such as the "C" drive) to host the operating system and certain applications. In addition, you can attach multiple EBS volumes for other purposes, such as storing data (for example, data volume).</p>
			<p>When configuring your EC2 instance with an EBS volume, you need to select the type of volume, the amount of storage you wish to provision, and if you want to configure encryption <a id="_idIndexMarker662"/>on your EBS volume. There are different types of EBS volumes to choose from and they fall into the following categories: <strong class="bold">Solid State Drives</strong> (<strong class="bold">SSDs</strong>) and <strong class="bold">Hard Disk Drives</strong> (<strong class="bold">HDDs</strong>).</p>
			<p>SSDs are <a id="_idIndexMarker663"/>optimized for transactional workloads involving frequent read/write operations with small I/O sizes, and they can be used to boot up your EC2 instances. These types of drives include the following:</p>
			<ul>
				<li><strong class="bold">gp2</strong>: This is the default EBS volume that you can attach to an EC2 instance. The volume runs <a id="_idIndexMarker664"/>on SSDs and is suitable for general workloads such as transaction operations, low-latency interactive operations, and is suitable as boot volumes. The volume size can range from 1 GB to 16 TB, is designed to deliver up to 99.9% of durability, and has a maximum IOPS of 16,000. gp2 volumes also offer a baseline performance of 3 IOPS/GB (minimum 100 IOPS), which can burst up to 3,000 IOPS for volumes smaller than 1 TB.</li>
				<li><strong class="bold">gp3</strong>: This is the <a id="_idIndexMarker665"/>latest version of the general-purpose SSD-based EBS volumes. Compared to gp2, gp3 volumes offer a baseline performance of 3,000 IOPS and 125 Mbps at any volume size. You can provision performance for an additional fee of up to 16000 IOPS. The size of the volume can range from 1 GB to 16 TB. gp3 volumes are ideal for running single-instance databases such as Microsoft SQL Server, Cassandra, MySQL, and Oracle DB and can be used as boot volumes.</li>
				<li><strong class="bold">io1</strong>: This provisioned IOPS SSD offering high-performance EBS storage is ideal for critical, I/O intensive <a id="_idIndexMarker666"/>database and application workloads. io1 offers a baseline performance of 50 IOPS/GB to a maximum of 64,000 IOPS and provides up to 1,000 MB/s of throughput per volume. Note, however, that to achieve the maximum of 64,000 IOPS and 1,000 MB/s of throughput, the volume must be attached to an EC2 instance built on the AWS Nitro system. io1 volumes can also be used as boot volumes and the volume size can range from 4 GB to 16 TB.</li>
				<li><strong class="bold">io2</strong>: The latest <a id="_idIndexMarker667"/>generation of the Provisioned IOPS SSD, this offers high performance, as well as a 100X durability of 99.999% with 10X higher IOPS to storage ratio of 500 IOPS for every provisioned GB. io2 is ideal for business-critical, I/O intensive database applications, including SAP HANA, Oracle, Microsoft SQL Server, and IBM DB2. io2 volumes can also be used as boot volumes and the volume size can range from 4 GB to 16 TB. Like io1, to achieve the maximum of 64,000 IOPS and 1,000 MB/s of throughput, the volume must be attached to an EC2 instance built on the AWS Nitro system.</li>
				<li><strong class="bold">io2 Block Express</strong>: Currently in preview, this high-performance block storage offers 4x higher throughput, IOPS, and a capacity of io2 volumes. Designed for the most <a id="_idIndexMarker668"/>demanding applications, it offers 4,000 MB/s of throughput per volume, up to 256,000 IOPS and 1,000 IOPS/GB, as well as 99.999% durability. Volume sizes can range from 4 GB to 16 TB.</li>
			</ul>
			<p>HDDs are optimized for large streaming workloads where the dominant performance attribute is throughput. These drives include the following:</p>
			<ul>
				<li><strong class="bold">st1</strong>: This is a low-cost HDD volume that's ideal for frequently accessed, throughput-intensive <a id="_idIndexMarker669"/>workloads and capable of working with large datasets and large I/O sizes. Typical workloads include MapReduce, Kafka, log processing, data warehouses, and ETL jobs. st1 can burst up to 250 MB/s per TB, has a baseline throughput of 40 MB/s per TB, and the maximum throughput is 500 MB/s per volume. The volume size can range from 125 GB to 16 TB; however, it cannot be used as a boot volume.</li>
				<li><strong class="bold">sc1</strong>: This is also known as Cold HDD and offers the lowest cost per GB of all EBS volume types. It is <a id="_idIndexMarker670"/>ideal for less frequently accessed workloads with large, cold datasets. sc1 can burst up to 80 MB/s per TB, has a baseline throughput of 12 MB/s per TB, and offers a maximum throughput of 250 MB/s per volume. The volume size can range from 125 GB to 16 TB; however, it cannot be used as a boot volume.</li>
			</ul>
			<p>Some additional features <a id="_idIndexMarker671"/>of EBS volumes include the following:</p>
			<ul>
				<li>EBS volumes can be detached from one EC2 instance and attached to another. So, for example, if you have an EC2 instance with a single root volume and the instance has some sort of failure, you can detach the root volume and attach it to another EC2 instance as a data volume to extract any information as required. This makes EBS volumes very versatile and flexible.  </li>
				<li>Data stored on EBS volumes is persistent and can exist beyond the life of an EC2 instance.</li>
				<li>You can also take <em class="italic">snapshots of your EBS volume</em>, which are point-in-time backups of your data stored on the volume. <em class="italic">The first snapshot is always a full backup and additional snapshots are incremental backups of changes</em>. Snapshots can then be used to create new volumes as required with the data intact. In addition, you can copy snapshots to other Regions. This means that if you need to <a id="_idIndexMarker672"/>share some data with a colleague in another Region, you simply copy the snapshot to the required Region, and it will be made available within your AWS account in that Region. You can also copy snapshots to other AWS accounts.</li>
			</ul>
			<p>In this section, we looked at the different types of EBS volumes backed by both HDD and SDD technologies. We also looked at their use cases. EBS volumes are attached to your EC2 instances over a storage area network connection, usually using the ISCSI protocol. In the next section, we will look at EC2 instance store volumes. These volumes are directly attached to the physical host that your EC2 instance has been deployed on.</p>
			<h2 id="_idParaDest-162"><a id="_idTextAnchor163"/>AWS EC2 instance store volumes</h2>
			<p>Amazon EBS volumes are storage volumes that are mounted on your EC2 instances over a network from <a id="_idIndexMarker673"/>a storage array, whereas instance store volumes are carved out of the local storage drives that are physically attached to the host that the EC2 instance runs on.</p>
			<p>The primary benefit of attaching instance store volumes to your EC2 instance is the ultra-high throughput you get, as well as reduced latency in accessing your data. However, there is a downside to instance store volumes, namely around data persistence. The data in an instance store persists only during the lifetime of its associated instance while in the running state. If the instance is stopped, terminated, and placed into a hibernate state, then the data on the attached instance store is lost. Equally, if the underlying disk experiences some failure, then the data will be lost in such situations. The reason behind this is that when your instance experiences any of these states, every block of storage in the instance store is reset, so any data is lost.</p>
			<p>Due to this, data on an instance store volume is considered temporary and to be used as such. It is ideal for information that changes frequently and can be used as buffers, caches, or for holding temporary content. Instance store volumes are also cheaper than EBS volumes. </p>
			<p class="callout-heading">Important Note</p>
			<p class="callout">If an EC2 instance with an instance store volume is restarted, the data is not lost. This is because a reboot is not the same as a shutdown and then a cold start. </p>
			<p>In this section, we looked at the different storage options for EC2 instances. We discussed the key features and options for Amazon EBS and identified typical use cases of where we would use which type of EBS volume. We also summarized some additional features, such as being able to encrypt your block storage or take regular snapshots as backups and for replication.</p>
			<p>We then discussed <a id="_idIndexMarker674"/>instance store volumes and compared them with EBS, identifying use cases for instance store volumes and how data on an instance store volume is considered temporary. Instance store volumes are also known as ephemeral storage. </p>
			<p>In the next section, we will discuss the different pricing options available to launch your EC2 instances. Depending on your use case, one set of pricing options might work out more cost-effectively than another, and this next section discusses some important concepts to be aware of.</p>
			<h1 id="_idParaDest-163"><a id="_idTextAnchor164"/>Learning about EC2 pricing options</h1>
			<p>The Amazon EC2 service is a cloud offering that enables you to deploy virtual servers (EC2 instances) in the cloud. Traditionally, in an on-premises environment, if you needed to deploy a new <a id="_idIndexMarker675"/>physical server, you would have to make a capital investment for a few thousand dollars to procure the necessary hardware and software and then configure your server with any necessary applications.  </p>
			<p>On AWS, EC2 instances can be procured on an hourly basis, which means that you only pay for the hours that the server is running. If you turn off the server but keep it in your account (as opposed to terminating it and releasing its capacity back to AWS), then you do not pay <a id="_idIndexMarker676"/>any charges while the EC2 instance is in this stopped state. This pricing approach is what we call the <strong class="bold">On-Demand Pricing Option</strong> and is the default option when purchasing EC2 instances on AWS. </p>
			<p>Let's look at these various pricing options in detail.</p>
			<h2 id="_idParaDest-164"><a id="_idTextAnchor165"/>On-Demand Instance Pricing Option</h2>
			<p>As we've already discussed, this is the <strong class="bold">default option</strong> for procuring/launching an EC2 instance. You <a id="_idIndexMarker677"/>pay an hourly charge based on the instance type, the operating system (with any applications pre-installed), and the Region <a id="_idIndexMarker678"/>that you launch it in. You are charged based on the number of hours that the EC2 instance is in the <strong class="bold">running state</strong>. This means that you are not billed for the hours that the EC2 instance is in the <strong class="bold">stopped state</strong>. The <strong class="bold">On-Demand Pricing Option</strong> does not require any long-term commitment or upfront payments. You can increase or decrease your compute capacity depending on your application demand and you only pay per hour consumed. </p>
			<p>The <strong class="bold">On-Demand Pricing Option</strong> is ideal for users who need the flexibility to consume compute resources when required and without any long-term commitment. They are ideal for test/dev environments or for applications that have short, spiky, or unpredictable workloads. An important benefit of the On-Demand pricing model is that Amazon will not interrupt your consumption in any way. So, your EC2 instances will continue to exist in your account (even in the stopped state) unless you terminate (release) them. In terms of pricing, the On-Demand Pricing Option is low cost but compared to the other pricing options, it can turn out to be the most expensive, especially if you plan to keep the instances running 24/7, 365 days a year. In such cases, alternative pricing options may be more suitable.</p>
			<h2 id="_idParaDest-165"><a id="_idTextAnchor166"/>Reserved Instance Pricing Option</h2>
			<p>This pricing option rewards customers with a significant discount (up to 72% off the On-Demand Pricing Option) who commit to a 1-year or 3-year agreement to run specific instance <a id="_idIndexMarker679"/>types within a given Region. You can achieve very discounted hourly rates compared to the On-Demand price for <a id="_idIndexMarker680"/>the same instance. Reserved Pricing Options are not actual EC2 instances that you procure; rather, they are pricing agreements that give you the right to run a specific EC2 configuration, in a specified Region, for a specified duration (1 year to 3 years) at a specific discounted rate. Once you launch a matching EC2 instance in the given Region, the Reserved pricing model is applied instead <a id="_idIndexMarker681"/>of the On-Demand rate. There are two types of Reserved Pricing Options:</p>
			<ul>
				<li><strong class="bold">Standard Reserved Pricing Option</strong>: This provides the most discount with up to 72% off the On-Demand instance price. They can be purchased on a 1-year or 3-year term and you can change the certain configurations of the EC2 instance during its life, such as the Availability Zone it is placed in, the instance size, and its network type.</li>
				<li><strong class="bold">Convertible Reserved Pricing Option</strong>: This offers even more flexibility, including the ability to change instance families, operating systems, or even tenancies over the Reserved term. The downside of the Convertible Reserved Pricing Option is that the maximum discount is only up to 54% compared to the On-Demand Instance rate.</li>
			</ul>
			<p>Here is an <a id="_idIndexMarker682"/>example of a standard 1-year reserved instance pricing for a t2.micro, Linux EC2 instance in the N. Virginia Region at the time of writing this training guide:</p>
			<div>
				<div id="_idContainer133" class="IMG---Figure">
					<img src="Images/B17124_07_04.jpg" alt="Figure 7.4 – t.2micro Reserved Instance Pricing Option in N. Virginia Region, standard 1-year term&#13;&#10;" width="1097" height="358"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.4 – t.2micro Reserved Instance Pricing Option in N. Virginia Region, standard 1-year term</p>
			<p>Next, we will look at the different payment options available for EC2 instances that have been purchased under the Reserved pricing model.</p>
			<h3>Payment options for Reserved Instances</h3>
			<p>You can choose to pay all or some of the total cost of your Reserved Instance upfront and depending on how you pay for your Reserved Instances, you get varying levels of the discounted rate. They are as follows:</p>
			<ul>
				<li><strong class="bold">All Upfront</strong>: This is where you pay for the entire term of the Reserved Instance upfront, right at the beginning of the contract. You do not get a monthly hourly bill and you benefit from the maximum available discount.</li>
				<li><strong class="bold">Partial Upfront</strong>: This is where you make some upfront payment and then are charged a discounted hourly rate for the term and billed monthly.</li>
				<li><strong class="bold">No Upfront</strong>: There is where you do not make any upfront payment, but you still get some discount compared to the On-Demand rate. You get a better discount by going with either the <strong class="bold">Partial Upfront</strong> or <strong class="bold">All-Upfront</strong> option.</li>
			</ul>
			<p>An important <a id="_idIndexMarker683"/>point to note here is that while you benefit from a massive discount for your Reserved Instance, you are charged for the whole term, regardless of whether you have the EC2 instance in a running state or not. This means that for some use cases such as if you need an EC2 instance for unpredictable usage patterns and short durations, but without any interruptions, then the On-Demand pricing option might work out more cost-effectively. You would need to carefully compare the total cost of purchasing a Reserved Instance versus the On-Demand option to figure out which is more cost-effective.</p>
			<h3>Reserved Instance Marketplace</h3>
			<p>Sometimes, your business needs change, or perhaps, the project that you originally purchased <a id="_idIndexMarker684"/>your reserved instances for ends earlier than anticipated. Whatever your reasons, you can resell your <a id="_idIndexMarker685"/>Standard Reserved Instances on the <strong class="bold">Reserved Instance Marketplace</strong> to other AWS customers if you no longer need them. This enables you to recoup some of the costs that you may have incurred from your original purchase. </p>
			<p>Because you are reselling your Reserved Instances, the remaining term will be less than what it was originally bought for. This also means that if you need a Reserved Instance for less than the standard contract length, you may wish to check out the Reserved Instance Marketplace to see if you can find one that fits your requirements.</p>
			<p>Note that only Standard Reserved Instances can be listed in the Marketplace. You cannot list Convertible Reserved Instances in the Marketplace. Furthermore, to list your Reserved Instance, you must ensure that you have paid for the Reserved Instance and that you owned the Reserved Instance for longer than 30 days. </p>
			<h2 id="_idParaDest-166"><a id="_idTextAnchor167"/>Spot Instance Pricing Option</h2>
			<p>Amazon almost always has spare compute capacity. One way to encourage the uptake of this spare capacity is by offering customers the option to launch Spot Instances at discounts <a id="_idIndexMarker686"/>up to 90% off the On-Demand price. However, Spot Instances are not suitable for all applications. They are ideal for <a id="_idIndexMarker687"/>workloads that are stateless or can be interrupted. For example, certain use cases such as data analysis, batch jobs, and background processing, can be run whenever there is available capacity, and depending on the application design architecture, those EC2 instances can be interrupted and then resumed later when capacity is available. In other words, if the application is stateless and workflows are not sensitive to interruptions, then if there are any interruptions, the application workflow simply waits for available compute capacity to continue with its operations.</p>
			<p>You might be wondering why there would be any interruptions. Well, simply put, Amazon will try to meet supply and demand for compute capacity based on the best possible price they can get. When you purchase a Spot Instance, you are made aware of the current spot price. You would then place a maximum offer price, which needs to be higher than the prevailing spot price. Now, if demand were to increase, Amazon can increase the spot price rate and if your offer price falls below this, then another customer can be offered this capacity at the higher spot price instead, and your workloads will be interrupted. Spot Instances can also be interrupted if, for instance, supply of capacity reduces due to excessive uptake of Spot Instances by customers.  </p>
			<p>The following are some of the reasons for Spot Instance interruptions:</p>
			<ul>
				<li><strong class="bold">Price</strong>: Where the spot price goes above your maximum offer price.</li>
				<li><strong class="bold">Capacity</strong>: If there is not enough unused EC2 instances to meet the demand for On-Demand instances.</li>
				<li><strong class="bold">Constraints</strong>: This includes the launch group or Availability Zone group, resulting in Spot Instance termination when such constraints cannot be met.</li>
			</ul>
			<p>When Amazon attempts to interrupt your Spot Instance, you are provided with a warning interruption notice, which is issued 2 minutes before Amazon EC2 stops or terminates your Spot Instance. These interruption notices are made available via CloudWatch Events and as items in the instance metadata on the Spot Instance.</p>
			<p>With regards to Amazon CloudWatch Events (discussed in <a href="B17124_13_Final_SK_ePub.xhtml#_idTextAnchor317"><em class="italic">Chapter 13</em></a>, <em class="italic">Management and Governance on AWS</em>), you can create targets such as Lambda functions or Amazon <strong class="bold">Simple Notification</strong> (<strong class="bold">SNS</strong>) topics, which can process the Spot interruption notices when they happen. We will discuss SNS in detail in <a href="B17124_10_Final_SK_ePub.xhtml#_idTextAnchor249"><em class="italic">Chapter 10</em></a>, <em class="italic">Application Integration Services</em>, but essentially, you can create an email subscription to an SNS topic so that when a 2-minute interruption notice is generated, this message can be forwarded to you via the SNS topic via email.  </p>
			<p>The instance <a id="_idIndexMarker688"/>metadata contains data about your EC2 instance, divided into categories; for example, hostname, IP address information, events, and security groups. It is accessible from within the EC2 instance itself, available at <strong class="source-inline">http://169.254.169.254/latest/meta-data/</strong>. The <strong class="source-inline">169.254.169.254</strong> IP address is a link-local address and is valid only from the instance.  </p>
			<p>Previously, the <a id="_idIndexMarker689"/>only behavior following an interruption from Amazon was to terminate your Spot Instance. However, you may lose data when that happens. More recently, alternative behaviors have become available, such as stopping your Spot Instance or placing the instance into a hibernate state. When an instance is placed into a hibernate state, the EBS volumes are preserved, and instance memory (RAM) is preserved on the root volume. Furthermore, the private IP addresses of the instance are also preserved. This option means that when the Spot service resumes your instance if, for example, the capacity becomes available or the spot rises fall before your maximum offer price, then your instance can continue from the state it was stopped at.</p>
			<h3>Spot Fleets</h3>
			<p>A <strong class="bold">Spot Fleet</strong> is a collection <a id="_idIndexMarker690"/>of Spot Instances, and optionally <a id="_idIndexMarker691"/>On-Demand instances. AWS will launch Spot Instances as part of the fleet if there is available capacity and if your maximum offer price is higher than the spot price. The Spot Fleet will attempt to maintain its target capacity if Spot Instances are terminated. What you can also do is include a few On-Demand instances as part of your Spot Fleet. This means that you always have some capacity for minimum application requirements. As demand for your application increases, Spot Instances are added to the fleet at the discounted rate, assuming there is capacity, or your offer price is higher than the spot price.</p>
			<p>In this section, we looked at different EC2 instance pricing options. We examined the default On-Demand <a id="_idIndexMarker692"/>pricing model and compared it with the Reserved pricing model and Spot pricing options.  </p>
			<p>In the next section, we will move on to discuss another storage option for your EC2 instances, known as <strong class="bold">Elastic File System</strong> (<strong class="bold">EFS</strong>).</p>
			<h1 id="_idParaDest-167"><a id="_idTextAnchor168"/>Implementing Shared File Storage with Amazon EFS</h1>
			<p>In our earlier discussion, we looked at Amazon EBS. These block storage volumes <a id="_idIndexMarker693"/>are directly attached to a specific EC2 instance and act as virtual hard drives for your EC2 instance. In general, an EBS volume can only be attached to one specific EC2 instance at a given time. This means that if you deploy 20 EC2 instances, each one <a id="_idIndexMarker694"/>of the instances will have one or more EBS volumes attached. This is perfectly fine if the data between those volumes does not need to be shared across those EC2 instances.</p>
			<p>There are multiple use cases for sharing data across EC2 instances. These include file shares or data that needs to be shared across multiple applications and web servers. In those cases, using EBS volumes would create a messy architecture of having to somehow replicate data between those individual EBS volumes.</p>
			<p>Amazon offers the <strong class="bold">EFS</strong> solution, which allows you to create and mount <a id="_idIndexMarker695"/>file shares across multiple EC2 instances. These instances can then update the data on the file share, which is visible to all other EC2 instances that have mounted the same share if the necessary permissions have been set.</p>
			<p>Some key <a id="_idIndexMarker696"/>features of EFS include the following:</p>
			<ul>
				<li>Can be used by Linux-based EC2 instances as a centralized file storage solution.</li>
				<li>Can also be accessed from on-premises servers over a VPN or the Direct Connect service.</li>
				<li>EFS Volumes can grow and shrink on demand. This is unlike EBS volumes, where you need to provision storage before you can use it.</li>
				<li>EFS volumes are regionally-based and can be made available across Availability Zones for high availability and durability.</li>
				<li>Note that <a id="_idIndexMarker697"/>EFS Volumes cannot be used as boot/root volumes of your EC2 instance and cannot be used with Windows EC2 instances.</li>
			</ul>
			<p>In this <a id="_idIndexMarker698"/>section, we examined an alternative storage solution for your Linux-based EC2 instance, where the requirement is to share files and data across a fleet of instances. Amazon <a id="_idIndexMarker699"/>EFS is a file-level storage solution and can be used to mount file shares on multiple EC2 instances across multiple Availability Zones in each Region. </p>
			<p>In the next section, we will look at an alternative compute solution known as Amazon Lightsail, which allows us to easily deploy individual VPSes in the cloud.</p>
			<h1 id="_idParaDest-168"><a id="_idTextAnchor169"/>Learning about VPSes with Amazon Lightsail</h1>
			<p>In addition to Amazon EC2, AWS also offers a more lightweight solution to deploy virtual servers <a id="_idIndexMarker700"/>preconfigured with the most common application stacks for a wide range of use cases. Rather than picking individual <a id="_idIndexMarker701"/>components of your EC2 instances, such as the instance type and storage, and then installing all the necessary application layers, Amazon Lightsail offers blueprints that will automatically configure your servers with various common use case applications and utilities required to get up and running.</p>
			<p>A common application stack includes your chosen operating system, along with apps such as WordPress, Drupal, Plesk, LAMP, and more. Deploying Amazon Lightsail is also relatively straightforward, with guided steps to get your deployment up and running. </p>
			<p>The best part about Lightsail is you have a fixed monthly fee based on the instance type and the associated operating system and applications that have been deployed. However, for more complex configurations and enterprise-grade production environments, you will probably still need to design and deploy EC2 instances. </p>
			<p>Prices for Amazon Lightsail start from as little as $3.50 per month. This gives you a Linux virtual <a id="_idIndexMarker702"/>server with 512 MB memory, 1 vCPU, a 20 GB SSD disk, and up to 1 TB of data transfer. Additional configurations <a id="_idIndexMarker703"/>include opting for a static IP address, DNS management, and SSH/RDS access to your virtual server.</p>
			<p>As your needs change over time, you can easily upgrade to EC2 instances, which involves taking a snapshot of your instance and following a step-by-step process to upgrade to EC2 using a wizard.</p>
			<p>In this section, we reviewed Amazon's Lightsail offering, which can be used for smaller-scale application deployments and predictable pricing structures. In the next section, we will look at other compute options available on AWS.</p>
			<h1 id="_idParaDest-169"><a id="_idTextAnchor170"/>Introduction to Amazon ECS and Kubernetes</h1>
			<p>So far, we have been looking at hardware virtualization and using hypervisors to build VMs such as EC2 instances that we can run various applications on. Different applications often have specific requirements, and many <a id="_idIndexMarker704"/>applications will not be able to run together in the same VM due to incompatibility with the underlying libraries or runtime environments.</p>
			<p>Traditional virtualization technologies involve using bare-metal hardware, upon which you configure a hypervisor. This hypervisor, as we discussed previously, allows you to essentially <em class="italic">carve</em> out physical hardware components (CPU, memory, storage, and so on) into smaller virtual components that allow you to then deploy VMs, or in the case of AWS, EC2 instances. Each EC2 instance, however, will need to host a guest operating system (Linux or Windows, for example), shared libraries and system files, and your application. </p>
			<p>As shown in the following diagram, VMs take up a lot of resources because they need to run the guest operating system, along with all the system files, utilities, and libraries:</p>
			<div>
				<div id="_idContainer134" class="IMG---Figure">
					<img src="Images/B17124_07_05.jpg" alt="Figure 7.5 – Hypervisor architecture hosting VMs&#13;&#10;" width="411" height="481"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.5 – Hypervisor architecture hosting VMs</p>
			<p>You will <a id="_idIndexMarker705"/>note that each VM requires its own guest OS, as well <a id="_idIndexMarker706"/>as the necessary libraries, system files, and runtime environments. An alternative <a id="_idIndexMarker707"/>solution is to consider a technology known as <strong class="bold">Docker</strong>. </p>
			<p>Docker is built <a id="_idIndexMarker708"/>on the concept of containerization, which is essentially <strong class="bold">operating system virtualization</strong>. Applications are run in isolated user spaces known as <strong class="bold">containers</strong>, which share the same underlying operating system. This is <a id="_idIndexMarker709"/>made possible because the container will host all the necessary dependencies required by the application, including binaries, libraries, configuration files, and runtime environments. The container is abstracted from the host operating system's container with limited access to the OS, which allows us to run several containers on the same bare-metal hardware.</p>
			<p>Containerization also <a id="_idIndexMarker710"/>offers less overhead during startups <a id="_idIndexMarker711"/>since they share the same underlying OS rather than each container have an operating system to boot up from, which is how VMs work. The following diagram illustrates this concept:</p>
			<div>
				<div id="_idContainer135" class="IMG---Figure">
					<img src="Images/B17124_07_06.jpg" alt="Figure 7.6 – Docker concepts&#13;&#10;" width="413" height="484"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.6 – Docker concepts</p>
			<p>Some of the added features of using Docker include the fact that you run multiple applications on the same bare-metal hardware, all sharing the same underlying OS via the Docker engine. This keeps the code base for the application much smaller compared to a VM that also has to host the operating system.</p>
			<p>Amazon offers <strong class="bold">ECS</strong>, which is a fully managed container orchestration <a id="_idIndexMarker712"/>service that allows you to deploy Docker-style <a id="_idIndexMarker713"/>applications. Amazon ECS can help you deploy and manage multiple Docker containers <a id="_idIndexMarker714"/>in the cloud rather than having to manually spin up EC2 instances and deploy the Docker solution on each.  </p>
			<p>The following diagram illustrates the core components of Amazon ECS:</p>
			<div>
				<div id="_idContainer136" class="IMG---Figure">
					<img src="Images/B17124_07_07.jpg" alt="Figure 7.7 – Amazon ECS architecture&#13;&#10;" width="1003" height="537"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.7 – Amazon ECS architecture</p>
			<p>The Amazon ECS architecture comes with the following core components and features:</p>
			<ol>
				<li><strong class="bold">ECS Cluster</strong>: This is <a id="_idIndexMarker715"/>a logical grouping of tasks or services.</li>
				<li><strong class="bold">Task</strong> – This is <a id="_idIndexMarker716"/>a Docker container termed as a "task" in Amazon ECS. In Amazon ECS, a "task" is essentially a container.</li>
				<li><strong class="bold">Task Definition</strong>: Each ECS task is created from a task definition. A task definition <a id="_idIndexMarker717"/>specifies the Docker image to use, the amount of CPU and memory to use with each task or each container within a task, the launch type to use (discussed later), and the IAM role that your tasks should use, among others.</li>
				<li><strong class="bold">Elastic Container Registry</strong> (<strong class="bold">ECR</strong>): This is where Docker images are stored on AWS. You <a id="_idIndexMarker718"/>can also store your images on Docker Hub or a private registry. Amazon ECR hosts your images in a highly available and high-performance architecture. When the task starts, it reviews the task definition and pulls down the Docker image required from the registry.</li>
				<li><strong class="bold">ECS Service</strong>: This allows you to define a specified number of instances of a task <a id="_idIndexMarker719"/>definition simultaneously in an Amazon ECS cluster. Should one of your tasks fail, the ECS service will replace it to maintain the desired number of tasks in the service.</li>
				<li><strong class="bold">ECS Container instances</strong>: Your tasks run on EC2 instances, within which you <a id="_idIndexMarker720"/>run your Docker container.</li>
			</ol>
			<p>However, there are two types of ECS deployments, which we will discuss next.</p>
			<h2 id="_idParaDest-170"><a id="_idTextAnchor171"/>Amazon ECS comes in two deployment options</h2>
			<p>Let's take <a id="_idIndexMarker721"/>a look at these deployment options:</p>
			<ul>
				<li><strong class="bold">Amazon Fargate (Fargate launch type)</strong>: This enables you to set up your ECS <a id="_idIndexMarker722"/>environment without having to spin up an EC2 instance, provision and scale clusters, or patch and update virtual servers yourself. You simply package your application and specify your CPU, memory, and network requirements and AWS takes care of the heavy lifting for you. AWS will place the ECS tasks on the cluster, scale as required, and fully manage the entire environment for you.</li>
				<li><strong class="bold">EC2 launch type</strong>: In some cases, you may require direct access to the underlying <a id="_idIndexMarker723"/>EC2 instances that run your container services. In this case, you must manage a cluster of EC2 instances (patch and update them) and schedule the placement of containers on the servers.</li>
			</ul>
			<p>In this section, we learned about Amazon ECS. In the next section, we will look at an orchestration service known as Amazon Elastic Service for Kubernetes.</p>
			<h1 id="_idParaDest-171"><a id="_idTextAnchor172"/>Amazon Elastic Kubernetes Service (Amazon EKS)</h1>
			<p>Kubernetes is another open source container orchestration solution. It groups containers <a id="_idIndexMarker724"/>that make up an application into logical units for easy management and discovery. Kubernetes takes care of scaling and managing your containers, taking care of failover options to ensure your application keeps running.  </p>
			<p><strong class="bold">Amazon EKS</strong> is AWS's offering to help you deploy, manage, and scale containerized applications using Kubernetes on AWS.</p>
			<p>In this section, we looked at the basics of containerization and how it can be used to effectively <a id="_idIndexMarker725"/>deploy and manage your application stack. We discussed the <strong class="bold">ECS</strong> and its two different launch types – the Fargate and EC2 launch types. We also looked at Amazon's take on Kubernetes as a container orchestration tool that uses Kubernetes.</p>
			<p>In the next section, we will look at some additional compute solutions available from AWS.</p>
			<h1 id="_idParaDest-172"><a id="_idTextAnchor173"/>Learning about additional compute services on AWS</h1>
			<p>In this section, we will <a id="_idIndexMarker726"/>look at some additional compute services available on AWS and their use cases.</p>
			<h2 id="_idParaDest-173"><a id="_idTextAnchor174"/>Serverless option – AWS Lambda</h2>
			<p>So far, we have only looked at server-based computer resources except for AWS ECS Fargate. When <a id="_idIndexMarker727"/>we say serverless, we do not mean that the compute resource is running without any servers. Ultimately, servers will house the CPU that offers compute capabilities. The term serverless is just used to mean that the customer does not need to manage any actual servers as this falls within the responsibility of AWS.</p>
			<p>AWS Lambda is a <a id="_idIndexMarker728"/>serverless offering from AWS that allows you to run code and perform <a id="_idIndexMarker729"/>some tasks. AWS Lambda is known as a <strong class="bold">Function as a Service</strong> (<strong class="bold">FaaS</strong>) solution that can be used to build an entirely serverless architecture comprised of storage, databases, and network capabilities where you do not manage any underlying servers.</p>
			<p>To use Lambda, you must create a function using a supporting programming language, such as Python or Node.js, and upload this function to AWS Lambda. You then need to define a trigger that will execute the code. For example, you can create a Lambda function that gets triggered when you upload an image to an S3 bucket. Your function could be used to add a watermark to a copy of the image and place it in another bucket, which is then used to serve a web application that allows customers to purchase stock photos. This way, the preview images have watermarks on them, and users will need to complete a purchase before they get the original image.</p>
			<p>The important thing to remember here is that Lambda functions are executed when they're triggered by another AWS service, so they do not run independently. Lambda functions can also be triggered on a schedule. An example of this is if you have a fleet of development servers that your dev team needs to work on. Because this is a short project, we decided to opt for On-Demand EC2 instances. However, you want to try and save on costs, so you create a Lambda function to stop the EC2 instances at 6 P.M. and another Lambda function to start up the EC2 instances again at 8 A.M. This automation sequence made possible by scheduling Lambda functions can help you save on costs.  </p>
			<p>An important point to remember is that with Lambda, you pay only for the compute time your Lambda functions consumes and there is no charge when your code is not running. </p>
			<h2 id="_idParaDest-174"><a id="_idTextAnchor175"/>AWS Batch</h2>
			<p>AWS Batch can be <a id="_idIndexMarker730"/>used to run thousands of batch computing jobs on AWS. AWS Batch <a id="_idIndexMarker731"/>will set up and provision the necessary compute resources to fulfill your batch requests. There is no need to deploy server clusters as AWS takes care of this for you. You can schedule and execute your batch jobs across a wide range of compute services, such as EC2 and ECS. With AWS Batch, you pay for the resources that AWS creates, such as EC2 instances or ECS clusters.</p>
			<h2 id="_idParaDest-175"><a id="_idTextAnchor176"/>AWS Outposts</h2>
			<p>It is possible to run several AWS Services such as EC2 instances, RDS databases, and host Amazon S3 storage <a id="_idIndexMarker732"/>buckets on-premises. You get to use the same <a id="_idIndexMarker733"/>AWS tools and hardware both in the cloud and on-premises, which helps build a complete hybrid solution. AWS Outposts is ideal when you want to run AWS resources with very low latency connections to your on-premises application or if you require local data processing due to any compliance and regulatory requirements.</p>
			<p>AWS Outposts comes in two flavors:</p>
			<ul>
				<li><strong class="bold">VMware Cloud on AWS Outposts</strong>: This allows you to utilize the same VMware <a id="_idIndexMarker734"/>tools to manage the infrastructure that you use with your on-premises resources.</li>
				<li><strong class="bold">AWS native variant of AWS Outposts</strong>: This allows you to use the same AWS <a id="_idIndexMarker735"/>APIs that you use with the AWS cloud-hosted services.</li>
			</ul>
			<p>You can get AWS Outposts delivered to your local on-premises location as a 42U rack and can scale from 1 rack to 96 racks to create pools of compute and storage capacity. You can also get smaller racks with 1U and 2U rack-mountable servers for locations with limited space or capacity requirements.</p>
			<p>In this section, we looked at additional compute services on AWS, including the very popular AWS Lambda services, which offers compute capabilities delivered in a <strong class="bold">FaaS</strong> model.</p>
			<p>We also <a id="_idIndexMarker736"/>discussed AWS Outposts, which allows you to host AWS infrastructure on-premises and address use cases such as very low latency connectivity or local data processing needs.</p>
			<p>In the next section, we will look at some additional storage options available on AWS.</p>
			<h1 id="_idParaDest-176"><a id="_idTextAnchor177"/>Understanding additional storage options in AWS</h1>
			<p>In addition to <a id="_idIndexMarker737"/>the previously discussed storage options for your compute needs, you have a couple of additional storage solutions that have been designed for specific use cases. </p>
			<h2 id="_idParaDest-177"><a id="_idTextAnchor178"/>Amazon FSx for Lustre</h2>
			<p>Amazon FSx for Lustre is a fully managed filesystem for compute-intensive workloads and <a id="_idIndexMarker738"/>designed for applications that require <a id="_idIndexMarker739"/>high-performance and low latency connectivity, offering millions of IOPS and hundreds of gigabits per second throughput rates.</p>
			<p>Amazon FSx for Lustre is designed to be integrated with Amazon S3. You store data in S3 and retrieve it when you need to perform compute-intensive workloads against the data. Later, you copy the data back to S3 for long-term storage.</p>
			<h2 id="_idParaDest-178"><a id="_idTextAnchor179"/>Amazon FSx for Windows File Server</h2>
			<p>Microsoft Windows servers can be configured to offer a file-sharing solution similar to EFS. Amazon EC2 instances running Microsoft Windows may need a common filesystem to share <a id="_idIndexMarker740"/>various types of data <a id="_idIndexMarker741"/>for end users or applications. For example, if you host virtual desktops in the cloud, you may need a central file sharing solution to allow your users to share files using mapped drives.</p>
			<p>Instead of manually building out a file share solution using EC2 instances and EBS volumes running the Windows operating system, you can use AWS FSx for Windows File Server. This is a fully managed native Microsoft Windows filesystem that offers support for the SMB protocol and Windows NTFS, <strong class="bold">Active Directory</strong> (<strong class="bold">AD</strong>) integration, and <strong class="bold">Distributed File System</strong> (<strong class="bold">DFS</strong>). By opting for FSx for Windows File Server, you benefit from <a id="_idIndexMarker742"/>a fully managed file sharing solution for all your <a id="_idIndexMarker743"/>Windows-based applications and can configure advanced file sharing solutions using DFS.</p>
			<p>In this <a id="_idIndexMarker744"/>section, we reviewed two additional storage options for your compute needs; AWS FSx for Lustre, which is <a id="_idIndexMarker745"/>designed for high-performance computing needs offering millions of IOPS, and AWS FSx for Windows File Server, which offers a fully managed Microsoft Windows file share solution.</p>
			<p>In the next section, we will look at how to securely access EC2 instances we deploy in our VPC with <a id="_idIndexMarker746"/>the help of <strong class="bold">bastion hosts</strong>. Bastion hosts are servers designed to allow secure connections from external networks such as the internet, from which you can then access the web and application servers that have been deployed in your VPC.</p>
			<h1 id="_idParaDest-179"><a id="_idTextAnchor180"/>Securing your VPC with bastion hosts</h1>
			<p>The use of bastion hosts (or jump boxes) is used to provide secure access to EC2 instances <a id="_idIndexMarker747"/>located in the private and public subnets of your <strong class="bold">virtual private cloud</strong> (<strong class="bold">VPC</strong>). These bastion hosts (you can have one or multiple hosts deployed for redundancy) can be used as management servers and are designed to allow you to remotely connect to them via SSH or RDP protocols. Once you have established connectivity to your bastion hosts, you can then log onto backend EC2 instances acting as web or application servers.</p>
			<p>Bastion hosts are EC2 instances that do not host any unnecessary applications, other than those required to allow connections to backend EC2 instances. These servers are hardened and secured to reduce attack surfaces and thus minimize the chances of penetration. However, you still need to manage these instances as you would any other application or web server. The onus is on you to ensure that the EC2 instances are highly secured, patched, and updated regularly. Amazon also offers an alternative solution known as <strong class="bold">Session Manager</strong>, which is a feature of the <strong class="bold">AWS Systems Manager</strong> service offering. <strong class="bold">Session Manager</strong> enables you to manage your EC2 instances and on-premises instances via an interactive browser shell or the AWS CLI tools, without the need to open inbound ports or maintain bastion hosts and SSH keys. It also offers a fully auditable instance management service recording instance access details. We will discuss AWS Systems Manager and Session Manager in <a href="B17124_13_Final_SK_ePub.xhtml#_idTextAnchor317"><em class="italic">Chapter 13</em></a>, <em class="italic">Management and Governance on AWS</em>.</p>
			<p>In the following diagram, we can see how an administrator can connect to the bastion hosts in a <a id="_idIndexMarker748"/>public subnet and from there administer backend EC2 instances running an application.</p>
			<div>
				<div id="_idContainer137" class="IMG---Figure">
					<img src="Images/B17124_07_08.jpg" alt="Figure 7.8 – Securing access to your VPC using bastion hosts&#13;&#10;" width="687" height="597"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.8 – Securing access to your VPC using bastion hosts</p>
			<p>In the preceding diagram, the administrator connects to the bastion hosts from the internet and then from that Bastion Host, establishes a secure connection to backend EC2 instances. The security of this architecture can be improved by restricting the source of the remote traffic to the Bastion Host. For example, rather than having the remote access open to the entire internet, we can restrict the source IP address or IP range of that connection to the administrator's corporate office network IP range. This way, the <a id="_idIndexMarker749"/>administrator can only access the Bastion Host if they were working from within the corporate office's network.  </p>
			<p>In this section, we briefly looked at bastion hosts and how they can be used to securely access other EC2 instances in your VPC. Bastion hosts are standard EC2 instances themselves, but you would configure them to only serve as an entry point into your VPC for administrative access. Furthermore, you would harden the bastion hosts by installed the necessary security updates and tools, and ensuring that unnecessary applications are removed. Access to bastion hosts can also be restricted to specific source IP addresses or even only from your corporate data center via a VPN link.</p>
			<h1 id="_idParaDest-180"><a id="_idTextAnchor181"/>Exercise 7.1 – Expanding ProductionVPC so that it includes two public subnets and two private subnets</h1>
			<p>In this exercise, we will expand the architecture of <strong class="bold">ProductionVPC</strong> that we built in the previous chapter <a id="_idIndexMarker750"/>so that it includes an additional public subnet in another Availability Zone and two private subnets – one in each Availability Zone. This will enable us to design an architecture that can offer high availability in case of a single Availability Zone outage.  </p>
			<p>We will be extending the VPC to fulfill our design specifications, as shown in the following diagram:</p>
			<div>
				<div id="_idContainer138" class="IMG---Figure">
					<img src="Images/B17124_07_09.jpg" alt="Figure 7.9 – VPC with public and private subnets across two Availability Zones&#13;&#10;" width="607" height="455"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.9 – VPC with public and private subnets across two Availability Zones</p>
			<p>Log in to <a id="_idIndexMarker751"/>your AWS account as the root user and on the main AWS Management Console, search for <strong class="source-inline">VPC</strong> in the search box. Click on the <strong class="source-inline">VPC</strong> link to open the VPC Console. Once in the console, ensure that you are in the us-east-1 Region, where you created <strong class="bold">ProductionVPC</strong> in the previous chapter. If necessary, navigate to the us-east-1 Region by selecting it from the drop-down list.</p>
			<p><strong class="bold">Review your current VPC</strong>:</p>
			<ol>
				<li value="1">On the left-hand menu in <strong class="bold">VPC console</strong>, click on <strong class="bold">Subnets</strong>. You will see that there is one <strong class="bold">Public Subnet One</strong> that is associated with ProductionVPC, which you created in the previous chapter. You will also see other subnets, but these are associated with the default VPC in the us-east-1 Region, as per the following screenshot:<div id="_idContainer139" class="IMG---Figure"><img src="Images/B17124_07_10.jpg" alt="Figure 7.10 – ProductionVPC with a single public subnet&#13;&#10;" width="1400" height="352"/></div><p class="figure-caption">Figure 7.10 – ProductionVPC with a single public subnet</p></li>
				<li>Next, click on the <strong class="bold">Route Tables</strong> link from the left-hand menu. Using the VPC Wizard, your <a id="_idIndexMarker752"/>ProductionVPC has been configured with a main route table and a public route table. From the following screenshot, you can see that the main route table associated with the ProductionVPC has a route table ID of <strong class="bold">rtb-0d6fb017c417d8e1b</strong>. You can tell it is the main route table because this is indicated in the <strong class="bold">Main</strong> column with a <strong class="bold">Yes</strong>. This main route table is designed to be associated with all private subnets in your VPC. <p>If you click on the <strong class="bold">Main Route Table ID</strong> link in the console, the bottom pane will provide additional information about the route table. Furthermore, if you click on the <strong class="bold">Routes</strong> tab of the bottom pane, you will note that currently, there is only one route: the <strong class="bold">local route</strong>. This local route is designed for traffic to flow within the VPC. The main route table does not offer any direct access to the internet now. This is a best practice because, for subnets that need direct access to the internet, you should ideally create a separate <strong class="bold">public route table</strong> and attach any <em class="italic">public subnets</em> to it:</p><div id="_idContainer140" class="IMG---Figure"><img src="Images/B17124_07_11.jpg" alt="Figure 7.11 – ProductionVPC main route table configuration&#13;&#10;" width="1566" height="731"/></div><p class="figure-caption">Figure 7.11 – ProductionVPC main route table configuration</p></li>
				<li>Next, in the top pane, you will notice that the wizard has already created a public <a id="_idIndexMarker753"/>route table (with a <strong class="bold">Route table ID</strong> of <strong class="bold">rtb-0452c63c6d2aa3a88</strong>). We know this is the public route table because, in the preceding screenshot, you can see a <strong class="bold">No</strong> in the <strong class="bold">Main</strong> column. It also has one subnet associated with it: <strong class="bold">Public Subnet One</strong>.</li>
				<li>If you click on the <strong class="bold">Route Table ID</strong> link of the public route table, the bottom pane will offer additional information, as per the following screenshot. Specifically, if you click on the <strong class="bold">Routes</strong> tab of the public route table, you will see two routes: one local route and a route to the internet. Routes to the internet are denoted with a destination of <strong class="bold">0.0.0.0/0</strong>. In this case, the route to the internet has a target, which is the <strong class="bold">internet gateway</strong>. This internet gateway gives the subnet direct access to send traffic to the internet and receive <a id="_idIndexMarker754"/>traffic from the internet if the security groups and/or <strong class="bold">Network Access Control Lists</strong> (<strong class="bold">NACLs</strong>) permit the traffic:</li>
			</ol>
			<div>
				<div id="_idContainer141" class="IMG---Figure">
					<img src="Images/B17124_07_12.jpg" alt="Figure 7.12 – ProductionVPC with public route table configuration&#13;&#10;" width="1531" height="775"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.12 – ProductionVPC with public route table configuration</p>
			<p>You will also notice that AWS does not create a name tag for your route tables by default. This can sometimes make it difficult to identify your resources. You can easily add name <a id="_idIndexMarker755"/>tags to make resources easy to identify. Using your mouse, simply hover over the area in the <strong class="bold">Name</strong> column next to the <strong class="bold">Public Route</strong> table until you notice an edit icon. Click on this edit icon and in the <strong class="bold">Edit Name</strong> text box that appears, type in <strong class="source-inline">Public Route Table</strong>. Perform the same action for the main route table, making sure to tag the route table with the name <strong class="bold">Main Route Table</strong>. This will make it easy to identify your route tables, as per the following screenshot:</p>
			<div>
				<div id="_idContainer142" class="IMG---Figure">
					<img src="Images/B17124_07_13.jpg" alt="Figure 7.13 – Tagging your route tables&#13;&#10;" width="1460" height="277"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.13 – Tagging your route tables</p>
			<p>When you create new subnets, they are automatically associated with the main route table. This technically makes them private subnets. If you need to create a public subnet, you need to remember to disassociate the subnet from the main route table and attach it to a route table that offers public internet access via the internet gateway.  </p>
			<p>While you can configure a direct route to the internet in the main route table that sends traffic via the internet gateway, this is not advisable. You want to ensure that some subnets offer only internal private access without direct exposure to the internet. Since EC2 <a id="_idIndexMarker756"/>instances deployed as backend services require internet access to download software updates, for example, you can set up NAT gateways in the public subnets to facilitate this requirement. You would then need to configure the <strong class="bold">Main Route</strong> table with a route to the internet via this NAT gateway, which acts as a proxy for any internet requests from your backend EC2 instances. These backend EC2 instances do not require public IP addresses and can still communicate with the internet via the NAT gateway.</p>
			<h2 id="_idParaDest-181"><a id="_idTextAnchor182"/>Setting up additional subnets</h2>
			<p>In this part of the exercise, we will be expanding our VPC to include multiple public and private subnets. We <a id="_idIndexMarker757"/>wish to host two public subnets and two private subnets across two Availability Zones. We wish to do this because we want to offer high availability so that if one Availability Zone fails or is offline, we can access duplicate copies of our resources in the other Availability Zone.</p>
			<p>You already have one public subnet in your VPC. This has been configured with a name of <strong class="bold">Public Subnet One</strong> and has been placed in the <strong class="bold">us-east-1a</strong> Availability Zone as per the following screenshot:</p>
			<div>
				<div id="_idContainer143" class="IMG---Figure">
					<img src="Images/B17124_07_14.jpg" alt="Figure 7.14 – Public Subnet One in the us-east-1a Availability Zone&#13;&#10;" width="1575" height="720"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.14 – Public Subnet One in the us-east-1a Availability Zone</p>
			<p>As part of this <a id="_idIndexMarker758"/>exercise, we will create another public subnet in the <strong class="bold">us-east-1b</strong> Availability Zone:</p>
			<ol>
				<li value="1">From the left-hand menu in your VPC console, click on <strong class="bold">Subnets</strong>.</li>
				<li>Click on the <strong class="bold">Create subnet</strong> button in the top right-hand corner.</li>
				<li>In the <strong class="bold">Create subnet</strong> wizard that appears, choose <strong class="bold">ProductionVPC</strong> from the list of VPCs available.</li>
				<li>Under <strong class="bold">Subnet settings</strong>, provide a subnet name such as <strong class="source-inline">Public Subnet Two</strong>.</li>
				<li>Next, under <strong class="bold">Availability Zone</strong>, ensure you select <strong class="bold">us-east-1b</strong>. This is because we want the second public subnet to be placed in a different Availability Zone from the first public subnet.</li>
				<li>For the IPv4 CIDR block, provide a block address of <strong class="source-inline">10.0.2.0/24</strong>. This CIDR block is on a separate range from the CIDR block of the first public subnet but is still a subset of the VPC's CIDR range.</li>
				<li>Finally, as per the following screenshot, click on <strong class="bold">Create subnet</strong>:</li>
			</ol>
			<div>
				<div id="_idContainer144" class="IMG---Figure">
					<img src="Images/B17124_07_15.jpg" alt="Figure 7.15 – Creating Public Subnet Two&#13;&#10;" width="894" height="836"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.15 – Creating Public Subnet Two</p>
			<p>The wizard will <a id="_idIndexMarker759"/>create the subnet and display a successful creation message.</p>
			<p>If you click on the checkbox next to the newly created subnet, the bottom pane will provide information about the subnet. Click on the <strong class="bold">Route table</strong> tab. You will notice that this newly created subnet has been automatically associated with <strong class="bold">main route table</strong>, as shown in the following screenshot:</p>
			<div>
				<div id="_idContainer145" class="IMG---Figure">
					<img src="Images/B17124_07_16.jpg" alt="Figure 7.16 – Newly created subnet associated with main route table&#13;&#10;" width="1203" height="362"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.16 – Newly created subnet associated with main route table</p>
			<p>Because we <a id="_idIndexMarker760"/>want this subnet to be a public subnet, we need to change its association from the main route table to the public route table, as follows:</p>
			<ol>
				<li value="1">Click on the <strong class="bold">Edit route table association</strong> button, as shown in the preceding screenshot.</li>
				<li>In the <strong class="bold">Edit route table association</strong> dialog box that appears, select <strong class="bold">Public Route Table</strong> from the <strong class="bold">Route table ID</strong> drop-down list, as shown in the following screenshot:<div id="_idContainer146" class="IMG---Figure"><img src="Images/B17124_07_17.jpg" alt="Figure 7.17 – Edit route table association&#13;&#10;" width="897" height="664"/></div><p class="figure-caption">Figure 7.17 – Edit route table association</p></li>
				<li>Click <strong class="bold">Save</strong>.</li>
			</ol>
			<p>At this point, both <a id="_idIndexMarker761"/>public subnets have been correctly configured. Next, we'll create two private subnets, one in <strong class="bold">us-east-1a</strong> and the other in <strong class="bold">us-east-1b</strong>. </p>
			<h2 id="_idParaDest-182"><a id="_idTextAnchor183"/>Creating private subnets</h2>
			<p>Follow <a id="_idIndexMarker762"/>these steps to create the aforementioned private subnets:</p>
			<ol>
				<li value="1">While still in the VPC console, click on the <strong class="bold">Subnets</strong> link from the left-hand menu.</li>
				<li>In the <strong class="bold">Create subnet</strong> dialog box that appears, select <strong class="bold">ProductionVPC</strong> from the <strong class="bold">VPC ID</strong> drop-down list.</li>
				<li>Next, in the <strong class="bold">Subnet settings</strong> section, type <strong class="source-inline">Private Subnet One</strong> in the <strong class="bold">Subnet name</strong> text box.</li>
				<li>Under <strong class="bold">Availability Zone</strong>, select <strong class="bold">us-east-1a</strong> – this is the same zone where we placed <strong class="bold">Public Subnet One</strong>. This way, any frontend web resources in <strong class="bold">Public Subnet One</strong> can <a id="_idIndexMarker763"/>access any backend resources in <strong class="bold">Private Subnet One</strong>, allowing those resources to be in the same Availability Zone.</li>
				<li>For the IPv4 CIDR block, provide the IP CIDR range of <strong class="source-inline">10.0.3.0/24</strong> – this CIDR block does not conflict with any of the other subnets and is still a subset range of the main VPC's IP range.</li>
				<li>Finally, click the <strong class="bold">Create subnet</strong> button at the bottom of the page, as per the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer147" class="IMG---Figure">
					<img src="Images/B17124_07_18.jpg" alt="Figure 7.18 – Private Subnet One settings&#13;&#10;" width="899" height="847"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.18 – Private Subnet One settings</p>
			<p>You will <a id="_idIndexMarker764"/>receive a success message. Next, we will perform the same steps we did previously, but this time to create the second private subnet in <strong class="bold">us-east-1b</strong>:</p>
			<ol>
				<li value="1">Click <strong class="bold">Create subnet</strong>.</li>
				<li>Select <strong class="bold">ProductionVPC</strong> from the VPC ID drop-down list.</li>
				<li>For the subnet name, type in <strong class="source-inline">Private Subnet Two</strong>.</li>
				<li>Under <strong class="bold">Availability Zone</strong>, select <strong class="bold">us-east-1b</strong>.</li>
				<li>For the IPv4 CIDR block, type in <strong class="source-inline">10.0.4.0/24</strong> as the CIDR block range for this subnet.</li>
				<li>Click the <strong class="bold">Create subnet</strong> button at the bottom of the page.</li>
			</ol>
			<p>At this <a id="_idIndexMarker765"/>point, you have a VPC configured with two public subnets and two private subnets.</p>
			<p class="callout-heading">Note</p>
			<p class="callout">You do not need to associate the two private subnets to the main route tables manually, as this is done for you by default.  </p>
			<p>To check this, perform the following steps:</p>
			<ol>
				<li value="1">Select <strong class="bold">Route Tables</strong> from the left-hand menu. </li>
				<li>From the top pane, click on the checkbox next to the main route table.</li>
				<li>In the bottom pane, you will notice that both private subnets are associated with the main route table (not explicitly) but by default instead, as shown in the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer148" class="IMG---Figure">
					<img src="Images/B17124_07_19.jpg" alt="Figure 7.19 – Private subnet route table associations&#13;&#10;" width="1586" height="828"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.19 – Private subnet route table associations</p>
			<p>In this exercise, we expanded our <strong class="bold">ProductionVPC</strong> to include two public subnets and two <a id="_idIndexMarker766"/>private subnets across two Availability Zones. This will enable us to deploy duplicate workloads in each Availability Zone to design for high availability. </p>
			<p>In the next exercise, we will deploy our first custom security group in <strong class="bold">ProductionVPC</strong>. This security group will be used to define what types of traffic we will allow inbound to an EC2 instance that will be deployed in the third exercise.  </p>
			<h1 id="_idParaDest-183"><a id="_idTextAnchor184"/>Exercise 7.2 – Creating a Bastion Host security group</h1>
			<p>In this <a id="_idIndexMarker767"/>exercise, we will create a custom security group that will be used by an EC2 instance. This will act as a Bastion Host, as previously discussed in this chapter. Let's get started: </p>
			<ol>
				<li value="1">Log in to your AWS account and navigate to the VPC console. Ensure you are in the <strong class="bold">us-east-1</strong> Region. From the left-hand menu, confirm that <strong class="bold">ProductionVPC</strong> is available in this Region.</li>
				<li>Select the <strong class="bold">Security Groups</strong> link from the left-hand menu, which is located under the <strong class="bold">Security</strong> category, as shown in the following screenshot:<div id="_idContainer149" class="IMG---Figure"><img src="Images/B17124_07_20.jpg" alt="Figure 7.20 – Selecting Security Groups from the VPC console&#13;&#10;" width="216" height="419"/></div><p class="figure-caption">Figure 7.20 – Selecting Security Groups from the VPC console</p></li>
				<li>Click <a id="_idIndexMarker768"/>on the <strong class="bold">Create security group</strong> button on the top right-hand corner of the screen.</li>
				<li>Under <strong class="bold">Basic details</strong>, provide a name for your security group; for example, <strong class="source-inline">BastionHost-SG</strong>.</li>
				<li>Next, provide an appropriate description, such as <strong class="source-inline">Allow Remote Access to Bastion Host Server</strong>.</li>
				<li>Under <strong class="bold">VPC</strong>, make sure your select <strong class="bold">ProductionVPC</strong> from the drop-down list.</li>
				<li>Next, under the <strong class="bold">Inbound rules</strong> section, click the <strong class="bold">Add rule</strong> button.</li>
				<li>Select <strong class="bold">RDP</strong> for the type of rule. <strong class="bold">RDP</strong> is a remote access protocol that's used to connect to Microsoft Windows servers and desktops. RDP uses the TCP (6) protocol and operates on port <strong class="source-inline">3389</strong>.</li>
				<li>Under the <strong class="bold">Source</strong> column, ensure that <strong class="bold">Custom</strong> is selected and in the text box, type in <strong class="source-inline">0.0.0.0/0</strong>. This IP block represents all external networks, including the internet.</li>
				<li>Next, click on the <strong class="bold">Create security group</strong> button on the bottom right-hand corner of the page.</li>
			</ol>
			<p>You will <a id="_idIndexMarker769"/>receive a successful creation message to confirm that the security group has now been created. We will use this security group in the next exercise to ensure that we can connect to our EC2 instance over the <strong class="bold">Remote Desktop Protocol</strong> (RDP), which operates on port <strong class="source-inline">3389</strong>.</p>
			<h1 id="_idParaDest-184"><a id="_idTextAnchor185"/>Exercise 7.3 – Launching an EC2 instance</h1>
			<p>In this <a id="_idIndexMarker770"/>exercise, we will launch a Windows-based EC2 instance in <strong class="bold">Public Subnet One</strong> of our <strong class="bold">ProductionVPC</strong>. We will use this EC2 instance as a Bastion Host, allowing us to configure other EC2 instances in the VPC:  </p>
			<ol>
				<li value="1">Log in to your AWS account and from the <strong class="bold">Services</strong> drop-down list, select <strong class="bold">EC2</strong> under the <strong class="bold">Compute</strong> category, as shown in the following screenshot:<div id="_idContainer150" class="IMG---Figure"><img src="Images/B17124_07_21.jpg" alt="Figure 7.21 – Accessing the EC2 console&#13;&#10;" width="1035" height="412"/></div><p class="figure-caption">Figure 7.21 – Accessing the EC2 console</p></li>
				<li>From the <strong class="bold">Regions</strong> list in the top right-hand corner, ensure that you are in the <strong class="bold">US East N.Virgina (us-east-1)</strong> Region.</li>
				<li>On the <strong class="bold">EC2</strong> dashboard, you will note that there are <strong class="source-inline">0</strong> Instances in the running state.</li>
				<li>Click on <a id="_idIndexMarker771"/>the <strong class="bold">Instances (running)</strong> link, as shown in the following screenshot. This will bring up the <strong class="bold">Instances</strong> console:<div id="_idContainer151" class="IMG---Figure"><img src="Images/B17124_07_22.jpg" alt="Figure 7.22 – EC2 dashboard&#13;&#10;" width="1131" height="433"/></div><p class="figure-caption">Figure 7.22 – EC2 dashboard</p></li>
				<li>From the <strong class="bold">Instances</strong> console, select the <strong class="bold">Launch instances</strong> button from the top right-hand corner of the screen.</li>
				<li>You will now be presented with <strong class="bold">Step 1: Choose an Amazon Machine Image (AMI)</strong>. From the list of available AMIs, select <strong class="bold">Microsoft Windows Server 2016 Base - ami-05ce3abcaf51f14b2</strong>.</li>
				<li>In <strong class="bold">Step 2: Choose an Instance Type</strong>, ensure that the checkbox next to the <strong class="bold">t2.micro</strong> instance is selected. This instance type is available as part of your Free Tier offering.</li>
				<li>Next, click <a id="_idIndexMarker772"/>the <strong class="bold">Next: Configure Instance Details</strong> button in the bottom right-hand corner of the screen.</li>
				<li>In <strong class="bold">Step 3: Configure Instance Details</strong>, choose the following options:<ul><li>For <strong class="bold">Network</strong>, select <strong class="bold">ProductionVPC</strong>.</li><li>For <strong class="bold">Subnet</strong>, select the <strong class="bold">Public Subnet One</strong> subnet.</li><li>For <strong class="bold">Auto-assign Public IP</strong>, select <strong class="bold">Enable</strong>.</li><li>Leave all the remaining settings as their default values and click the <strong class="bold">Next: Add Storage</strong> button in the bottom right-hand corner of the screen.</li></ul></li>
				<li>In <strong class="bold">Step 4: Add Storage</strong>, accept the default root volume size and click on the <strong class="bold">Next: Add Tags</strong> button in the bottom right-hand corner of the screen.</li>
				<li>In <strong class="bold">Step 5: Add Tags</strong>, provide a key-value combination to tag the EC2 instance with a name, as shown in the following screenshot. For <strong class="bold">Key</strong>, type in <strong class="source-inline">Name</strong>, and for <strong class="bold">Value</strong>, type in <strong class="source-inline">Windows-BastionSrv</strong>:<div id="_idContainer152" class="IMG---Figure"><img src="Images/B17124_07_23.jpg" alt="Figure 7.23 – Step 5: Add Tags&#13;&#10;" width="1178" height="347"/></div><p class="figure-caption">Figure 7.23 – Step 5: Add Tags</p></li>
				<li>Next, click the <strong class="bold">Next: Configure Security Group</strong> button in the bottom right-hand corner of the screen.</li>
				<li>In <strong class="bold">Step 6: Configure Security Group</strong>, click on the <strong class="bold">Select an existing security group</strong> option under the <strong class="bold">Assign a security group</strong> heading.</li>
				<li>Next, from <a id="_idIndexMarker773"/>the list in the <strong class="bold">Security Group ID</strong> column, select the security group ID that corresponds to the newly created <strong class="bold">BastionHost-SG</strong>, which we set up in the previous exercise.</li>
				<li>Finally, click on the <strong class="bold">Review and Launch</strong> button in the bottom right-hand corner of the screen.</li>
				<li>You will then be presented with <strong class="bold">Step 7: Review Instance Launch</strong>. Review the settings you have defined and then click on the <strong class="bold">Launch</strong> button in the bottom right-hand corner of the screen.</li>
				<li>At this point, you will be presented with another dialog box, requesting you to either select an existing EC2 key pair or create a new key pair.</li>
			</ol>
			<p><strong class="bold">Key pairs</strong> are cryptographically encrypted public/private keys that are used to encrypt the credentials <a id="_idIndexMarker774"/>required to authenticate against the EC2 instance operating system so that you can remotely access them. </p>
			<p>For Microsoft Windows-based EC2 instances, the public key of the keys pair is used to encrypt the <em class="italic">Administrator</em> password. You then use the private key to decrypt the password to remotely access the Windows machine. For Linux-based EC2 instances, the private key can be used to establish a <strong class="bold">Secure Socket Shell</strong> (<strong class="bold">SSH</strong>) connection. Establishing SSH <a id="_idIndexMarker775"/>connections to your Linux-based EC2 instance allows you to work on the server remotely using the Linux shell interface. Let's take a look:</p>
			<ol>
				<li value="1">In the <strong class="bold">Select an existing key pair or create a new key pair</strong> dialog box, select the option to <strong class="bold">Create a new key pair</strong>, from the drop-down list.</li>
				<li>Next, provide a key pair name. For example, I am naming my key <strong class="source-inline">USEC2Keys</strong>.</li>
				<li>Click on the <strong class="bold">Download Key Pair</strong> button, which will download the private key in <strong class="source-inline">.pem</strong> format into your load <strong class="source-inline">Downloads</strong> folder. Make sure that you copy and save the keys in a safe location or on the desktop for easy access.</li>
				<li>Next, click on the <strong class="bold">Launch Instances</strong> button to launch your EC2 instance.</li>
				<li>On the <strong class="bold">Launch Status</strong> page, click on the <strong class="bold">View Instances</strong> button at the bottom right-hand corner of the page.</li>
			</ol>
			<p>At this point, you will <a id="_idIndexMarker776"/>be redirected to the instances console and will be able to see your EC2 instance, as per the following screenshot:</p>
			<div>
				<div id="_idContainer153" class="IMG---Figure">
					<img src="Images/B17124_07_24.jpg" alt="Figure 7.24 – Successfully launched the Windows BastionSRV EC2 instance&#13;&#10;" width="1570" height="198"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.24 – Successfully launched the Windows BastionSRV EC2 instance</p>
			<p>It will take a few minutes for the server to fully launch and become accessible. Look out for the <strong class="bold">Status Check</strong> column, as per the preceding screenshot, and ensure that AWS has completed all its checks; you will receive a <strong class="bold">2/2 checks passed</strong> message in the <strong class="bold">Status check</strong> column.</p>
			<p>You can now remotely connect to the Windows Server using the Microsoft Remote Desktop client. If you are performing these labs from a laptop or desktop using Microsoft Windows, then the <strong class="bold">remote desktop client</strong> will already be installed on your machine. Simply click the <strong class="bold">Start</strong> button and search for the <strong class="source-inline">Remote Desktop Connection</strong> app. If you are performing these labs on a macOS-based computer, you will need to download the Microsoft Remote Desktop client from the Apple Play Store.</p>
			<p>To connect to your new Windows Bastion Host server, follow these steps:</p>
			<ol>
				<li value="1">From the EC2 instances console, click on the checkbox next to the EC2 instance you have just launched.</li>
				<li>In the bottom pane, make a note of the EC2 instance's public IP address.</li>
				<li>Next, with the <a id="_idIndexMarker777"/>EC2 instance still selected, click on the <strong class="bold">Actions</strong> menu from the top right-hand corner of the screen, and then on the <strong class="bold">Security</strong> sub-menu. From here, select the <strong class="bold">Get Windows password</strong> link, as per the following screenshot:<div id="_idContainer154" class="IMG---Figure"><img src="Images/B17124_07_25.jpg" alt="Figure 7.25 – The Get Windows password option for your EC2 instance&#13;&#10;" width="1546" height="359"/></div><p class="figure-caption">Figure 7.25 – The Get Windows password option for your EC2 instance</p></li>
				<li>You will be presented with the <strong class="bold">Get Windows password</strong> page. Here, you need to browse for the EC2 key pairs you previously downloaded using the <strong class="bold">Browse</strong> button. Select the key pair from the location where you stored a copy of it; you should also find that it is still in the <strong class="source-inline">Downloads</strong> folder.</li>
				<li>Upon selecting the key, you will note that the text box below the <strong class="bold">Browse</strong> button gets populated with the encrypted key, as per the following screenshot:<div id="_idContainer155" class="IMG---Figure"><img src="Images/B17124_07_26.jpg" alt="Figure 7.26 – Decrypting your key pairs&#13;&#10;" width="997" height="807"/></div><p class="figure-caption">Figure 7.26 – Decrypting your key pairs</p></li>
				<li>Click on the <strong class="bold">Decrypt Password</strong> button in the bottom right-hand corner of the screen; you will <a id="_idIndexMarker778"/>be provided with the Windows Administrator password. Make a note of this password.</li>
				<li>Next, launch your <strong class="bold">Remote Desktop Connection</strong> application.</li>
				<li>In the <strong class="bold">Remote Desktop Connection</strong> app, type in the public IP address of your Windows Bastion Server in the text box, next to the <strong class="bold">Computer:</strong> field, as per the following screenshot:<div id="_idContainer156" class="IMG---Figure"><img src="Images/B17124_07_27.jpg" alt="Figure 7.27 – Remote Desktop Connection client&#13;&#10;" width="405" height="249"/></div><p class="figure-caption">Figure 7.27 – Remote Desktop Connection client</p></li>
				<li>Click the <strong class="bold">Connect</strong> button.</li>
				<li>You will be <a id="_idIndexMarker779"/>prompted to provide your security credentials in the Windows Security dialog box, as per the following screenshot:<div id="_idContainer157" class="IMG---Figure"><img src="Images/B17124_07_28.jpg" alt="Figure 7.28 – Windows Security – Enter your credentials&#13;&#10;" width="452" height="308"/></div><p class="figure-caption">Figure 7.28 – Windows Security – Enter your credentials</p></li>
				<li>For <strong class="bold">Username</strong>, type in <strong class="source-inline">Administrator</strong>.</li>
				<li>For <strong class="bold">Password</strong>, type in the password you decrypted earlier, and then click <strong class="bold">OK</strong>.</li>
				<li>If the password has been correctly typed in, you will be prompted with a <strong class="bold">Remote Desktop Connection</strong> security prompt, informing you that the connection to the remote computer cannot be authenticated due to its security certificate. This <a id="_idIndexMarker780"/>warning message can be ignored and you can proceed to log in to the server, as per the following screenshot:<div id="_idContainer158" class="IMG---Figure"><img src="Images/B17124_07_29.jpg" alt="Figure 7.29 – RDP certificate warning dialog box&#13;&#10;" width="387" height="395"/></div><p class="figure-caption">Figure 7.29 – RDP certificate warning dialog box</p></li>
				<li>Click on the <strong class="bold">Yes</strong> button to proceed with the remote connection.</li>
				<li>The Remote Desktop client should now connect you to the remote Windows Server, as per the following screenshot:</li>
			</ol>
			<div>
				<div id="_idContainer159" class="IMG---Figure">
					<img src="Images/B17124_07_30.jpg" alt="Figure 7.30 – Remote Bastion Host Server&#13;&#10;" width="1376" height="884"/>
				</div>
			</div>
			<p class="figure-caption">Figure 7.30 – Remote Bastion Host Server</p>
			<p>In this exercise, you were able to launch a new EC2 instance that will act as our Bastion Host server. You will <a id="_idIndexMarker781"/>be able to remotely connect to the Windows EC2 instance using the RPD client and can now perform any operation, as required, on this server.</p>
			<p class="callout-heading">Important Note</p>
			<p class="callout">As part of ending this exercise, you should terminate your EC2 instances to ensure you do not go over the billing alarm threshold you configured in <a href="B17124_04_Final_SK_ePub.xhtml#_idTextAnchor068"><em class="italic">Chapter 4</em></a>, <em class="italic">Identity and Access Management</em>. To terminate your EC2 instances, from the EC2 dashboard, click on <strong class="bold">Instances</strong> from the left-hand menu. Next, select the checkbox next to the <strong class="bold">Windows BastionSrv</strong> EC2 instance you launched. Then, from the top right-hand menu, click on the <strong class="bold">Instance state</strong> drop-down menu and select <strong class="bold">Terminate instance</strong>. You will be prompted to confirm that you wish to terminate your EC2 instances. Go ahead and click the <strong class="bold">Terminate</strong> button.  </p>
			<p>In the next <a id="_idIndexMarker782"/>exercise, we will demonstrate the Amazon ECS service while focusing on the Fargate launch type with a simple example.</p>
			<h1 id="_idParaDest-185"><a id="_idTextAnchor186"/>Exercise 7.4 – Launching an application on Amazon Fargate</h1>
			<p>In this exercise, you will <a id="_idIndexMarker783"/>launch a task on ECS, which <a id="_idIndexMarker784"/>is essentially a Docker container:</p>
			<ol>
				<li value="1">Log in to your AWS account as <strong class="bold">Alice</strong> and in the top search bar in the AWS Management Console, type in <strong class="source-inline">ECS</strong>. </li>
				<li>From the search results, select <strong class="bold">Elastic Container Service</strong>.</li>
				<li>You will be presented with the ECS splash screen, as per the following screenshot:<div id="_idContainer160" class="IMG---Figure"><img src="Images/B17124_07_31.jpg" alt="Figure 7.31 – Amazon ECS&#13;&#10;" width="1608" height="640"/></div><p class="figure-caption">Figure 7.31 – Amazon ECS</p></li>
				<li>From the left-hand menu, select <strong class="bold">Clusters</strong>.</li>
				<li>In the right-hand pane, click the <strong class="bold">Create cluster</strong> button.</li>
				<li>You will be prompted to select the cluster template. You will be deploying a Fargate cluster, so go ahead and select the <strong class="bold">Network only</strong> option design for use with either AWS Fargate or an external instance capacity.</li>
				<li>Click the <strong class="bold">Next step</strong> button at the bottom of the page.</li>
				<li>On the <a id="_idIndexMarker785"/>next screen, name your cluster <strong class="source-inline">MyCluster</strong>.</li>
				<li>Next, click <a id="_idIndexMarker786"/>the <strong class="bold">Create</strong> button at the bottom of the page.</li>
				<li>You will see a notification once the cluster has been created. Click the <strong class="bold">View Cluster</strong> button.</li>
				<li>Next, from the left-hand menu, click on <strong class="bold">Task Definition</strong>.</li>
				<li>In the right-hand pane, click the <strong class="bold">Create new Task Definition</strong> button.</li>
				<li>You will then be prompted to select the launch type's compatibility, as per the following screenshot:<div id="_idContainer161" class="IMG---Figure"><img src="Images/B17124_07_32.jpg" alt="Figure 7.32 – ECS task definition&#13;&#10;" width="971" height="735"/></div><p class="figure-caption">Figure 7.32 – ECS task definition</p></li>
				<li>Select the <a id="_idIndexMarker787"/>Fargate type and click the <strong class="bold">Next step</strong> button at the bottom of the page.</li>
				<li>Provide a <a id="_idIndexMarker788"/>name for your task definition; for example, <strong class="source-inline">fargate-task</strong>.</li>
				<li>Scroll further down and under <strong class="bold">Task size</strong>, set <strong class="bold">Task memory (GB)</strong> to <strong class="bold">1GB</strong>.</li>
				<li>Next, set <strong class="bold">Task CPU (vCPU)</strong> to <strong class="bold">0.5 vCPU</strong>.</li>
				<li>Next, under <strong class="bold">Container Definitions</strong>, click the <strong class="bold">Add container</strong> button.</li>
				<li>You will be selecting an existing container here, so in the <strong class="bold">Add container</strong> dialog box, for <strong class="bold">Container name</strong>, type in <strong class="source-inline">nginx</strong>.</li>
				<li>Similarly, for <strong class="bold">Image</strong>, ensure you type in <strong class="source-inline">nginx</strong>, as per the following screenshot:<div id="_idContainer162" class="IMG---Figure"><img src="Images/B17124_07_33.jpg" alt="Figure 7.33 – Fargate launch container&#13;&#10;" width="855" height="305"/></div><p class="figure-caption">Figure 7.33 – Fargate launch container</p></li>
				<li>Next, for <strong class="bold">Port mappings</strong>, type in <strong class="source-inline">80</strong> for the <strong class="bold">Container</strong> port.</li>
				<li>Scroll toward the bottom and click the <strong class="bold">Add</strong> button. This will take you back to the <strong class="bold">Create new Task Definition</strong> page. Scroll toward the bottom and click on the <strong class="bold">Create</strong> button.</li>
				<li>After a <a id="_idIndexMarker789"/>few seconds, you should find <a id="_idIndexMarker790"/>that your task definition has been created.</li>
				<li>Click on the <strong class="bold">View task definition</strong> button. This will take you back to the ECS dashboard.</li>
				<li>Next, click on the <strong class="bold">Clusters</strong> link from the left-hand menu. You will see that your <strong class="bold">MyCluster</strong> cluster is now available. Click on the <strong class="bold">MyCluster</strong> link.</li>
				<li>Next, click on the <strong class="bold">Task</strong> tab.</li>
				<li>Click the <strong class="bold">Run new Task</strong> button.</li>
				<li>On the <strong class="bold">Run Task</strong> page, ensure that <strong class="bold">Launch type</strong> is set to <strong class="bold">Fargate</strong>.</li>
				<li>You will find that the task definition has been pre-populated with your task. If not, select it from the drop-down arrow.</li>
				<li>For <strong class="bold">Number of tasks</strong>, ensure that only <strong class="source-inline">1</strong> is set as we will only run one task.</li>
				<li>Under <strong class="bold">VPC and security groups</strong>, select <strong class="bold">ProductionVPC</strong>.</li>
				<li>For <strong class="bold">Subnets</strong>, select <strong class="bold">Public Subnet One</strong>.</li>
				<li>For <strong class="bold">Security groups</strong>, click the <strong class="bold">Edit</strong> button next to the provided security group name.</li>
				<li>You will <a id="_idIndexMarker791"/>be prompted to create a new <a id="_idIndexMarker792"/>security group, as per the following screenshot:<div id="_idContainer163" class="IMG---Figure"><img src="Images/B17124_07_34.jpg" alt="Figure 7.34 – Fargate task security group&#13;&#10;" width="1197" height="558"/></div><p class="figure-caption">Figure 7.34 – Fargate task security group</p></li>
				<li>Accept the default to create an inbound rule that allows port <strong class="source-inline">80</strong> from the internet. Click the <strong class="bold">Save</strong> button at the bottom of the page.</li>
				<li>Next, ensure that <strong class="bold">Auto-assign public IP</strong> is set to <strong class="bold">ENABLED</strong>.</li>
				<li>Click the <strong class="bold">Run Task</strong> button at the bottom of the page.</li>
				<li>You will be taken back to the ECS dashboard. </li>
				<li>Within <a id="_idIndexMarker793"/>a few seconds, you should find that <a id="_idIndexMarker794"/>your task is now in the <strong class="bold">RUNNING</strong> status, as per the following screenshot:<div id="_idContainer164" class="IMG---Figure"><img src="Images/B17124_07_35.jpg" alt="Figure 7.35 – Fargate running task&#13;&#10;" width="1518" height="680"/></div><p class="figure-caption">Figure 7.35 – Fargate running task</p></li>
				<li>Next, under <strong class="bold">Task</strong>, click on the task ID link. This will bring up the <strong class="bold">Details</strong> page of the task.</li>
				<li>Make a note of the <strong class="bold">Public IP</strong> address and copy and paste it into a new browser tab.</li>
				<li>You should then find that you can connect to the <strong class="source-inline">nginx</strong> web page, as per the following screenshot:<div id="_idContainer165" class="IMG---Figure"><img src="Images/B17124_07_36.jpg" alt="Figure 7.36 – nginx application running on Fargate&#13;&#10;" width="887" height="309"/></div><p class="figure-caption">Figure 7.36 – nginx application running on Fargate</p></li>
				<li>You have just deployed your first Fargate task!  </li>
				<li>To clean <a id="_idIndexMarker795"/>up, go back to your ECS dashboard. From the left-hand menu, click the <strong class="bold">Clusters</strong> link.</li>
				<li>In the <a id="_idIndexMarker796"/>right-hand pane, click the <strong class="bold">MyCluster</strong> link.</li>
				<li>Next, from the <strong class="bold">Task</strong> tab, select the checkbox next to your task.</li>
				<li>Finally, click on the <strong class="bold">Stop</strong> button. You will be prompted to confirm your action. Click the <strong class="bold">Stop</strong> button in the dialog box that appears.</li>
				<li>This will stop your task. You will also receive a notification, stating that the task was successfully stopped. You do not need to worry about the cluster as you only pay for the tasks on Fargate.</li>
			</ol>
			<p>In this exercise, we demonstrated how you can launch a simple nginx Docker container on ECS using the Fargate launch type. Next, we will summarize this chapter.</p>
			<h1 id="_idParaDest-186"><a id="_idTextAnchor187"/>Summary</h1>
			<p>In this chapter, we looked at a wide range of AWS compute solutions, starting with their flagship solution, Amazon <strong class="bold">EC2</strong>. We discussed AMIs, which are machine images that contain the base operating system, any applications and the state of patches, and updates that are used to launch your EC2 instance as a fully-fledged server. AMIs are made available via the Quick Start AMIs, Community, and Marketplace, and you can also create your own AMIs based on your corporate requirements.</p>
			<p>We examine the different EC2 instance types and families and how an instance type is effectively a description of associated hardware and software specifications that your EC2 instance offers. We also looked at storage options for your EC2 instance, with EBS, EFS, and FSx as possible solutions. </p>
			<p>Then, you learned how to choose a particular EC2 Pricing Option, depending on your application needs, and identify opportunities for cost-effective deployment by combining the On-Demand, Reserved, and Spot Instance options.</p>
			<p>In the next chapter, we will look at databases on AWS. Almost every application requires some form of database to host structured data. Amazon offers both relational and non-relational databases to help design modern web and mobile applications. Amazon also offers additional database solutions for specific niches such as social networking platforms, data warehousing solutions, and databases designed for hosting highly sensitive data.</p>
			<h1 id="_idParaDest-187"><a id="_idTextAnchor188"/>Questions</h1>
			<ol>
				<li value="1">Which AWS EC2 pricing option can help you reduce costs by allowing you to use your existing server-bound software licenses?<ol><li>On-Demand</li><li>Reserved</li><li>Spot</li><li>Dedicated Hosts</li></ol></li>
				<li>Which AWS EC2 pricing option enables you to take advantage of unused EC2 capacity in the AWS cloud and can offer up to a 90% discount compared to On-Demand prices?<ol><li>Spot Instances</li><li>Reserved Instances</li><li>On-Demand Instance</li><li>Dedicated Hosts</li></ol></li>
				<li>Which of the following is true with regards to the benefits of purchasing a Convertible EC2 Reserved Instance? (Choose 2 answers)<ol><li>You can exchange a Convertible Reserved Instance for a Convertible Reserved Instance in a different Region.</li><li>You can exchange one or more Convertible Reserved Instances at a time for both Convertible and Standard Reserved Instances.</li><li>To benefit from better pricing, you can exchange a No Upfront Convertible Reserved Instance for an All Upfront or Partial Upfront Convertible Reserved Instance.</li><li>You can exchange All Upfront and Partial Upfront Convertible Reserved Instances for No Upfront Convertible Reserved Instances.</li><li>You can exchange one or more Convertible Reserved Instances for another Convertible Reserved Instance with a different configuration, including instance family, operating system, and tenancy.</li></ol></li>
				<li>Which feature of the AWS EC2 service helps prevent accidentally terminating an EC2 instance by preventing the user from issuing a termination command either from the console or CLI?<ol><li>Enable "termination protection"</li><li>Enable "termination protect"</li><li>Enable "prevent termination"</li><li>Enable "protect EC2"</li></ol></li>
				<li>Which storage solution enables you to share a common filesystem across multiple Linux-based EC2 instances that can be used to support applications that require access to data with very low latency connectivity?<ol><li>EFS</li><li>EBS</li><li>S3</li><li>NTFS</li></ol></li>
				<li>Which type of IP address offering from AWS gives you a static, publicly routable address that will not change, even if you stop and restart an EC2 instance that it is associated with?<ol><li>Public IP address</li><li>Private IP address</li><li>Elastic IP address</li><li>Regional IP address</li></ol></li>
				<li>Which AWS service enables you to configure multiple Windows-based EC2 instances to share and access a common storage solution that is based on using the industry-standard SMB protocol and eliminate the administrative overhead of managing Windows file servers?<ol><li>Amazon FSx for Windows File Server</li><li>Amazon Elastic File System</li><li>Amazon Elastic Block Store</li><li>Amazon DFS Volumes for Windows File Server</li></ol></li>
				<li>Which of the following types of EBS volumes can be used as boot volumes for your EC2 instances? (Select 2 answers)<ol><li>General Purpose SSD (gp2)</li><li>Provisioned IOPS SSD (io1)</li><li>Throughput Optimized HDD (st1)</li><li>Cold HDD (sc1)</li><li>FSx for Windows</li></ol></li>
				<li>Which of the following AWS services enables you to quickly launch a web server with a pre-configured WordPress installation pack, offers predictable monthly pricing, comes with integrated certificate management, and provides free SSL/TLS certificates?<ol><li>AWS Lightsail</li><li>AWS EC2</li><li>AWS RDS</li><li>AWS Elastic Beanstalk</li></ol></li>
				<li>Which AWS service can be used to run a piece of code that can create thumbnails of images uploaded to one Amazon S3 bucket and copy them to another S3 bucket?<ol><li>AWS SNS</li><li>AWS Lambda</li><li>AWS RDS</li><li>AWS Snowball</li></ol></li>
			</ol>
		</div>
	</div></body></html>