- en: '[*Chapter 13*](B17124_13_Final_SK_ePub.xhtml#_idTextAnchor317): Management
    and Governance on AWS'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '[*第13章*](B17124_13_Final_SK_ePub.xhtml#_idTextAnchor317)：AWS 上的管理与治理'
- en: Managing and monitoring your resources on AWS is a crucial part of ensuring
    that your applications perform as expected, are highly available and secure, and
    run in the most cost-efficient manner. You want to be able to monitor how your
    applications are being consumed, identify any technical issues that may affect
    performance and availability, and ensure that only authorized entities are granted
    access. Furthermore, you need to be able to audit your environment, with access
    to information such as access patterns, and identify any anomalies that may indicate
    potential performance or security issues. You also want to be able to enforce
    change management processes to ensure that any modifications or changes made to
    your AWS resources are accounted for and approved.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在 AWS 上管理和监控您的资源是确保应用程序按预期运行、具有高可用性和安全性并以最具成本效益的方式运行的关键部分。您希望能够监控您的应用程序如何被使用，识别任何可能影响性能和可用性的技术问题，并确保只有授权实体可以访问。此外，您需要能够审计您的环境，访问诸如访问模式等信息，并识别可能表明潜在性能或安全问题的异常情况。您还希望能够执行变更管理流程，确保对
    AWS 资源所做的任何修改或更改都得到记录和批准。
- en: Finally, as part of your day-to-day administrative tasks in maintaining your
    workloads, you want to be able to effectively manage your resources, such as patching,
    performing updates, and automating tasks wherever possible.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，作为维护工作负载的日常管理任务的一部分，您希望能够有效地管理您的资源，如打补丁、执行更新，并尽可能自动化任务。
- en: In this chapter, we will look at a series of AWS services that allow you to
    effectively monitor, report, and audit your AWS resources, enabling you to incorporate
    change management processes and implement a centralized administration of day-to-day
    tasks. We will also look at tools that offer guidance on where you can improve
    the performance, fault-tolerance, security, and cost-effectiveness of your resources.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将介绍一系列 AWS 服务，这些服务使您能够有效地监控、报告和审计您的 AWS 资源，从而实现变更管理流程并执行日常任务的集中管理。我们还将介绍一些工具，这些工具可以为您提供有关如何提高资源的性能、容错能力、安全性和成本效益的建议。
- en: 'The following topics are dealt with in this chapter:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 本章涉及以下主题：
- en: The basics of Amazon CloudWatch
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Amazon CloudWatch 的基础知识
- en: Meeting compliance requirements with AWS CloudTrail
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 AWS CloudTrail 满足合规要求
- en: Learning about change management with AWS Config
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 学习如何使用 AWS Config 进行变更管理
- en: Managing your AWS resources with AWS Systems Manager
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用 AWS Systems Manager 管理您的 AWS 资源
- en: Learning how to use AWS Trusted Advisor
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 学习如何使用 AWS Trusted Advisor
- en: Understanding the AWS Well-Architected Framework
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 理解 AWS Well-Architected Framework
- en: Technical requirements
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 技术要求
- en: To complete the exercises in this chapter, you will need to log in to your AWS
    account as the **Identity and Access Management** (**IAM**) user **Alice**.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 要完成本章的练习，您需要以 **身份与访问管理**（**IAM**）用户 **Alice** 登录到您的 AWS 账户。
- en: The basics of Amazon CloudWatch
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Amazon CloudWatch 的基础知识
- en: Amazon CloudWatch enables you to monitor your AWS resources and applications,
    running on AWS as well as on-premises. With Amazon CloudWatch, you can see how
    your resources are performing in real time. Using CloudWatch, you can collect
    resource and application metrics, logs, and events, and have these recorded into
    CloudWatch for analysis and identifying trends. A metric represents a time-ordered
    set of data points that are published to CloudWatch.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: Amazon CloudWatch 使您能够监控运行在 AWS 上以及本地的 AWS 资源和应用程序。通过 Amazon CloudWatch，您可以实时查看资源的表现。使用
    CloudWatch，您可以收集资源和应用程序的度量、日志和事件，并将这些数据记录到 CloudWatch 中进行分析和识别趋势。度量是按时间顺序排列的数据点集，这些数据点会被发布到
    CloudWatch 中。
- en: Amazon CloudWatch can be used to configure alarms whereby if those metrics breach
    certain thresholds for a specified period, you can generate an alarm on which
    action can be taken to remediate.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: Amazon CloudWatch 可用于配置警报，当这些指标在指定时间段内突破某些阈值时，您可以生成警报并采取相应的措施进行修复。
- en: With Amazon CloudWatch, you can track and collect metrics for your Amazon EC2
    instances, Amazon DynamoDB tables, Amazon **Relational Database Service** (**RDS**)
    instances, and more. Every AWS service publishes metrics to Amazon CloudWatch.
    You get basic metrics, which are offered free of charge, and detailed metrics,
    for which you pay additional charges.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Amazon CloudWatch，你可以跟踪并收集 Amazon EC2 实例、Amazon DynamoDB 表、Amazon **关系型数据库服务**（**RDS**）实例等的指标。每个
    AWS 服务都会将指标发布到 Amazon CloudWatch。你可以获得基本的免费指标和详细的付费指标。
- en: 'Some typical use cases of Amazon CloudWatch include the following:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: Amazon CloudWatch 的一些典型使用案例包括以下内容：
- en: '**Infrastructure monitoring and troubleshooting**: Monitor key metrics, logs
    and visualize trends over time to identify any potential issues and bottlenecks,
    enabling you to conduct root-cause analysis that helps to resolve both incidents
    and problems.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**基础设施监控与故障排除**：监控关键指标、日志并可视化趋势，帮助识别潜在问题和瓶颈，使你能够进行根本原因分析，帮助解决事件和问题。'
- en: '**Proactive resource optimization**: Configure alarms that monitor metric values
    and are triggered if breaches occur. Define an automatic remediation action, such
    as configuring auto-scaling, to launch new instances and terminate failed instances.
    Send out notification alerts to administrators and system operators.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**主动资源优化**：配置监控指标值的警报，如果发生超限，将触发警报。定义自动修复措施，例如配置自动扩展，以启动新实例并终止失败的实例。向管理员和系统操作员发送通知警报。'
- en: '**Log analytics**: Analyze log information from various sources to help address
    operational issues, potential security attacks, or application performance issues,
    and take effective actions to remediate.'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**日志分析**：分析来自各种来源的日志信息，以帮助解决操作问题、潜在的安全攻击或应用性能问题，并采取有效措施进行修复。'
- en: Let's look at metrics in more detail.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们更详细地了解一下指标。
- en: CloudWatch metrics
  id: totrans-22
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CloudWatch 指标
- en: CloudWatch metrics represent variables that you can monitor as a time-ordered
    set of data points. Any service that you consume will report metrics to CloudWatch.
    For example, you could monitor the CPU utilization of an EC2 instance over a period
    that will help you track the performance of that instance.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: CloudWatch 指标表示可以作为按时间排序的数据点集合进行监控的变量。任何你使用的服务都会向 CloudWatch 报告指标。例如，你可以监控 EC2
    实例的 CPU 利用率，帮助你跟踪该实例的性能。
- en: 'Each data point will consist of a timestamp. If the resource does not provide
    a timestamp as it publishes the metric to CloudWatch, then CloudWatch will create
    a timestamp based on the time that the data point was received. The following
    diagram illustrates the CPU utilization metric of Linux-based EC2 instances over
    the past three days:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 每个数据点将包括时间戳。如果资源在将指标发布到 CloudWatch 时没有提供时间戳，则 CloudWatch 会基于接收数据点的时间创建时间戳。下图展示了过去三天内，基于
    Linux 的 EC2 实例的 CPU 利用率指标：
- en: '![Figure 13.1 – CPU utilization metrics for an EC2 instance running an e-commerce
    application'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 13.1 – 运行电子商务应用程序的 EC2 实例的 CPU 利用率指标'
- en: '](img/B17124_13_01.jpg)'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17124_13_01.jpg)'
- en: Figure 13.1 – CPU utilization metrics for an EC2 instance running an e-commerce
    application
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13.1 – 运行电子商务应用程序的 EC2 实例的 CPU 利用率指标
- en: 'Amazon CloudWatch offers a wide range of built-in metrics, but you can also
    create custom metrics based on your requirements:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: Amazon CloudWatch 提供了广泛的内置指标，但你也可以根据需求创建自定义指标：
- en: '**Built-in metrics**: Amazon CloudWatch allows you to collect default metrics
    from the vast array of AWS services, such as Amazon EC2, Amazon S3, Amazon RDS,
    and more, out of the box. An example includes CPU utilization, disk read/write,
    and data-transfer metrics for your EC2 instance.'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**内置指标**：Amazon CloudWatch 允许你从大量 AWS 服务（如 Amazon EC2、Amazon S3、Amazon RDS
    等）中收集默认指标。一个例子包括 EC2 实例的 CPU 利用率、磁盘读/写和数据传输指标。'
- en: '`PutMetricData` API action to publish them to CloudWatch.'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PutMetricData` API 操作将其发布到 CloudWatch。'
- en: An important point to note is that metrics exist in the Region in which they
    are created. However, you can configure *cross-account cross-Region dashboards*,
    which will allow you to gain visibility of CloudWatch metrics, logs, and alarms
    across related accounts and understand the health and performance of your applications
    across Regions.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 需要注意的重要一点是，指标存在于它们创建的区域中。但是，你可以配置 *跨账户跨区域的仪表板*，这样可以帮助你查看相关账户之间的 CloudWatch 指标、日志和警报，并了解跨区域应用的健康状况和性能。
- en: CloudWatch will store your metrics for up to 15 months. Data points older than
    15 months are expired, as new data points come in on a rolling basis.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: CloudWatch 将存储你的指标数据最长 15 个月。超过 15 个月的数据点将过期，因为新的数据点会按滚动方式加入。
- en: Next, let's look at how you can use AWS CloudWatch dashboards to get centralized
    visibility on your resources.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，让我们来看一下如何使用 AWS CloudWatch 仪表板来集中查看你的资源。
- en: Dashboards
  id: totrans-34
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 仪表板
- en: You can create one or more dashboards on Amazon CloudWatch that allow you to
    visualize and monitor your resources and the metrics that are important, all within
    a single view pane. As well as visualizing your metrics through a variety of charts
    and graphs, you can also publish your CloudWatch alarms (discussed next) on your
    dashboard for high visibility on any potential issues.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在 Amazon CloudWatch 上创建一个或多个仪表板，允许你在一个视图窗格中可视化和监控资源及其重要的指标。除了通过各种图表和图形可视化你的指标外，你还可以在仪表板上发布你的
    CloudWatch 警报（将在下文讨论），以便更高效地关注潜在问题。
- en: 'CloudWatch dashboards can be configured to provide insights on your resources''
    health across AWS accounts and Regions, using the cross-account functionality.
    This functionality is integrated with *AWS Organizations*, enabling you to efficiently
    build your cross-account dashboards. Here is a quick screenshot of a CloudWatch
    dashboard:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: CloudWatch 仪表板可以配置为提供跨 AWS 账户和区域的资源健康状况洞察，利用跨账户功能。此功能与 *AWS Organizations* 集成，使你能够高效地构建跨账户仪表板。以下是一个
    CloudWatch 仪表板的快速截图：
- en: '![Figure 13.2 – A CloudWatch dashboard'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 13.2 – 一个 CloudWatch 仪表板'
- en: '](img/B17124_13_02.jpg)'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17124_13_02.jpg)'
- en: Figure 13.2 – A CloudWatch dashboard
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13.2 – 一个 CloudWatch 仪表板
- en: Alarms
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 警报
- en: You can configure CloudWatch alarms to monitor a given resource metric, for
    example, the average CPU utilization of an EC2 instance. If the metric crosses
    a specific threshold for a specified period, then the alarm can be triggered to
    take a certain action. The alarm only triggers if the threshold has been breached
    for a specified period, and this is important. You do not want the alarm triggering
    just because there happens to be a momentary spike. So, for example, you would
    want the alarm to be triggered if the average CPU utilization on your EC2 instance
    goes above 80% for 15 minutes.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以配置 CloudWatch 警报来监控特定资源的指标，例如 EC2 实例的平均 CPU 使用率。如果该指标超过特定阈值并持续一定时间，警报就会被触发以采取某些措施。警报只有在阈值被超出并持续一段指定时间后才会触发，这一点非常重要。你不希望警报因偶尔的瞬时波动而被触发。例如，你可能希望在
    EC2 实例的平均 CPU 使用率超过 80% 并持续 15 分钟时触发警报。
- en: 'Alarms can be in one of three states:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 警报可以处于以下三种状态之一：
- en: '**OK**: Occurs when a metric is within the range defined as acceptable.'
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**OK**：当指标处于定义为可接受的范围内时，表示“正常”。'
- en: '**Alarm**: Occurs when a metric has breached a threshold for a period.'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**警报**：当指标超出阈值并持续一段时间时，触发警报。'
- en: '**Insufficient data**: Occurs when the data needed to make the decision is
    missing or incomplete. This also generally happens when you first configure an
    alarm while it waits to receive and analyze data.'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**数据不足**：当做出决策所需的数据缺失或不完整时发生。这通常也发生在你首次配置警报时，因为它在等待接收和分析数据。'
- en: 'Once an alarm has been triggered, an automatic action can be taken to respond
    to it, which can include the following:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦警报被触发，就可以采取自动行动进行响应，这些行动可能包括以下内容：
- en: '**Simple Notification Service (SNS) notification**: You can send out automatic
    alerts to an administrator (**application-to-person** or **A2P**) or push a notification
    to an application to take some action (**application-to-application**, or **A2A**).'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**简单通知服务（SNS）通知**：你可以向管理员发送自动警报（**应用到个人**或**A2P**），或向应用程序推送通知以采取某些行动（**应用到应用**，或**A2A**）。'
- en: '**Auto Scaling action**: The EC2 Auto Scaling service can be triggered to add
    or remove an EC2 instance in response to an alarm state. Auto Scaling groups can
    be configured to launch additional instances if the average load across the servers
    is above a given threshold for a period of time, for example, if average CPU is
    above 80% for more than 10 minutes.'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自动扩展操作**：EC2 自动扩展服务可以根据警报状态触发，增加或删除 EC2 实例。如果服务器的平均负载超过给定阈值一段时间（例如，平均 CPU
    使用率超过 80% 超过 10 分钟），则可以配置自动扩展组启动更多实例。'
- en: '**EC2 action**: You can have an alarm trigger an EC2 action, such as stopping
    an EC2 instance, terminating it, restarting it, or recovering it. Recovery of
    an instance simply means that the instances are migrated onto another host, something
    you would do if there was an underlying issue with the host hardware running the
    instance. Recovery action is only initiated based on the failure of *system status
    check* errors.'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**EC2 操作**：你可以让警报触发一个 EC2 操作，例如停止一个 EC2 实例、终止它、重启它或恢复它。实例的恢复仅仅意味着这些实例被迁移到另一台主机上，这是当运行实例的主机硬件出现问题时需要做的事。恢复操作仅会在出现*系统状态检查*错误时启动。'
- en: Finally, you can also publish your alarms in your CloudWatch dashboards, which
    can give you a quick visual of your alarm statuses.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，你还可以将你的警报发布到 CloudWatch 仪表板上，这样可以快速查看你的警报状态。
- en: Next, we look at Amazon CloudWatch Logs.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们来看一下 Amazon CloudWatch Logs。
- en: CloudWatch Logs
  id: totrans-52
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: CloudWatch Logs
- en: Amazon CloudWatch offers a feature to centrally collect and store logs from
    both AWS and non-AWS sources. These AWS sources could be EC2 instances, CloudTrail
    logs (discussed later in this chapter), Route 53 DNS queries, and VPC flow logs.
    You can also ingest logs from non-AWS sources, such as your web applications access
    logs, error logs, and operating system event logs.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 亚马逊 CloudWatch 提供了一个功能，可以集中收集并存储来自 AWS 和非 AWS 源的日志。这些 AWS 源可能是 EC2 实例、CloudTrail
    日志（本章后续会讨论）、Route 53 DNS 查询和 VPC 流量日志。你还可以从非 AWS 源导入日志，例如你的 web 应用访问日志、错误日志和操作系统事件日志。
- en: CloudWatch gives you a central view of all your logs regardless of their source
    – log events generated as part of your CloudWatch logs are essentially a time-ordered
    series of events that you can then query, analyze, search, and filter for specific
    patterns or error codes, and so on. You can also visualize your log data using
    dashboards and ingest these logs into other applications for more complex querying.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: CloudWatch 为你提供一个中央视图，查看所有日志，无论它们的来源如何——作为 CloudWatch 日志的一部分生成的日志事件，本质上是按时间排序的一系列事件，你可以对其进行查询、分析、搜索和过滤，查找特定的模式或错误代码等。你还可以使用仪表板可视化日志数据，并将这些日志导入到其他应用程序中进行更复杂的查询。
- en: In terms of retention, logs are kept indefinitely and never expire. However,
    you can adjust the retention policy by choosing a retention period between 1 day
    and 10 years. You can further archive your log files into Amazon S3 using one
    of the Glacier classes for long-term storage.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 在日志保留方面，日志会被永久保存，永不过期。不过，你可以通过选择 1 天到 10 年之间的保留期来调整保留策略。你还可以使用 Glacier 类别之一将日志文件进一步归档到
    Amazon S3，以便长期存储。
- en: 'Let''s look at some of the key components of CloudWatch Logs next:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们接下来看看 CloudWatch Logs 的一些关键组件：
- en: '**Log events**: This represents some event or activity recorded by the application
    or resource being monitored. The log event will include the timestamp and the
    log message.'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**日志事件**：这表示由被监控的应用程序或资源记录的某个事件或活动。日志事件将包括时间戳和日志消息。'
- en: '**Log streams**: This consists of a sequence of log events that share the same
    source. CloudWatch Logs groups log events from the same source into a log stream.
    For example, a log stream may be associated with a web server access log on a
    specific host.'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**日志流**：它由一系列共享相同来源的日志事件组成。CloudWatch Logs 会将来自同一来源的日志事件分组到一个日志流中。例如，一个日志流可能与特定主机上的
    web 服务器访问日志相关联。'
- en: '**Log groups**: CloudWatch then organizes these log streams into a *log group*.
    A log group represents log streams that have the same retention, monitoring, and
    access control settings. For example, you can create a log group to collect and
    organize all related log streams that relate to web server access logs from multiple
    hosts in a fleet.'
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**日志组**：CloudWatch 将这些日志流组织成一个*日志组*。日志组表示具有相同保留、监控和访问控制设置的日志流。例如，你可以创建一个日志组来收集和组织与多个主机的
    web 服务器访问日志相关的所有日志流。'
- en: '`504 Gateway Timeout` error message, indicating some communication or network
    problem.'
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`504 Gateway Timeout` 错误消息，表示某些通信或网络问题。'
- en: In this section, we learned about Amazon CloudWatch Logs, which can be used
    to ingest log information into CloudWatch from both AWS and non-AWS sources. You
    can use CloudWatch Logs to analyze access patterns, identify security and technical
    issues, and assist in triaging bottlenecks.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们了解了亚马逊 CloudWatch Logs，它可以用于从 AWS 和非 AWS 源将日志信息导入到 CloudWatch。你可以使用 CloudWatch
    Logs 来分析访问模式、识别安全和技术问题，并协助排查瓶颈。
- en: Next, we will look at Amazon CloudWatch Events, which is a near real-time stream
    of system events related to your Amazon resources.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将了解 Amazon CloudWatch 事件，它是一个接近实时的系统事件流，涉及你的 Amazon 资源。
- en: Amazon CloudWatch Events
  id: totrans-63
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Amazon CloudWatch 事件
- en: With Amazon CloudWatch Events, you create *rules* that continuously monitor
    your AWS resources and then respond with an action when a given event occurs.
    Amazon CloudWatch delivers a near real-time stream of system events, and the rules
    you define can trigger some action when those events occur.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 Amazon CloudWatch 事件，你可以创建*规则*，持续监控你的 AWS 资源，并在给定事件发生时响应某个动作。Amazon CloudWatch
    提供了一个接近实时的系统事件流，你定义的规则可以在这些事件发生时触发某个操作。
- en: An example of an event is when an EC2 instance enters the *stop state* because
    someone performed a shutdown operation on the instance. Another example is when
    an IAM user logs into the AWS Management Console. Every *write API operation*
    is an event that has occurred, and you can choose which events to monitor and
    what action to take, if necessary, when those events occur.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 一个事件的例子是，当某个 EC2 实例进入*停止状态*，因为有人对该实例执行了关机操作。另一个例子是当一个 IAM 用户登录 AWS 管理控制台时。每个*写
    API 操作*都是发生的事件，你可以选择监控哪些事件，并在这些事件发生时采取必要的行动。
- en: When you define a rule to monitor an event, you also specify an action by selecting
    an appropriate target. Targets can be a *Lambda* function, an *EC2 instance action*,
    an *SQS queue* or *SNS topic* to post a message to, an *ECS task*, and more. For
    example, let's say you want to trigger a Lambda function to process an image as
    soon as it is uploaded to an S3 bucket. You create an event so that when the upload
    is complete, the Lambda function is called to process the image in some way, such
    as creating multiple formats of the image or adding a watermark to it.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 当你定义一个规则来监控某个事件时，你还需要通过选择合适的目标来指定一个动作。目标可以是一个*Lambda* 函数，一个*EC2 实例操作*，一个*SQS
    队列*或*SNS 主题*以发布消息，*ECS 任务*，等等。例如，假设你希望在图像上传到 S3 存储桶后立即触发一个 Lambda 函数来处理该图像。你可以创建一个事件，当上传完成时，Lambda
    函数将被调用来处理图像，例如生成多种格式的图像或在图像上添加水印。
- en: You can also configure Amazon CloudWatch Event rules to trigger an action at
    a given schedule, using *standard rate* and *cron expressions*. This can be particularly
    useful to perform day-to-day operation tasks. In [*Chapter 12*](B17124_12_Final_SK_ePub.xhtml#_idTextAnchor296),
    *Automation and Deployment on AWS*, you completed an exercise that involved automatically
    starting an EC2 instance at 8 A.M. and then shutting it down at 6 P.M., Monday
    to Friday.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 你还可以配置 Amazon CloudWatch 事件规则，在给定的计划下触发某个动作，使用*标准速率*和*cron 表达式*。这在执行日常操作任务时特别有用。在[*第
    12 章*](B17124_12_Final_SK_ePub.xhtml#_idTextAnchor296)《AWS 上的自动化与部署》中，你完成了一个练习，涉及每天早上
    8 点自动启动一个 EC2 实例，然后在下午 6 点关闭它，周一至周五。
- en: In this section, we learned about Amazon CloudWatch Events, which allow you
    to use simple rules to perform some action when a given event takes place for
    a particular resource. CloudWatch Events can help you respond to operational changes
    to complete workflows and task, or take any corrective action if required. CloudWatch
    events can also be used to schedule automated actions that trigger at certain
    times to help repeatable day-to-day operations.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们了解了 Amazon CloudWatch 事件，它允许你使用简单的规则在特定资源发生特定事件时执行某些操作。CloudWatch 事件可以帮助你响应操作变更，以完成工作流和任务，或在需要时采取任何纠正措施。CloudWatch
    事件还可以用于计划自动化操作，在某些时间触发，以帮助重复进行日常操作。
- en: Important Note
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 重要说明
- en: In [*Chapter 10*](B17124_10_Final_SK_ePub.xhtml#_idTextAnchor249), *Application
    Integration Services*, you learned about Amazon EventBridge. Amazon CloudWatch
    Events and EventBridge use the same underlying service and API, and Amazon recommends
    EventBridge as the preferred way to manage your events as it offers more features.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 在[*第 10 章*](B17124_10_Final_SK_ePub.xhtml#_idTextAnchor249)《应用程序集成服务》中，你了解了
    Amazon EventBridge。Amazon CloudWatch 事件和 EventBridge 使用相同的底层服务和 API，Amazon 推荐使用
    EventBridge 作为管理事件的首选方式，因为它提供了更多功能。
- en: Next up, you will learn about Amazon CloudTrail, which is a service you use
    to enforce governance, compliance, and operational and risk auditing of your AWS
    account.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，你将了解 Amazon CloudTrail，这是一个用于执行治理、合规性、运营和风险审计的服务，适用于你的 AWS 账户。
- en: Meeting compliance requirements with Amazon CloudTrail
  id: totrans-72
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 满足 Amazon CloudTrail 合规性要求
- en: 'AWS CloudTrail is a service that enables you to log every action taken in your
    AWS account, allowing you to track user activity and API usage. CloudTrail is
    enabled by default on your AWS account when you create it. It stores event history
    accessible within the CloudTrail dashboard for every activity that occurs in your
    AWS account. The following screenshot shows an example of the CloudWatch event
    history:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: AWS CloudTrail 是一项服务，可以让你记录在 AWS 账户中进行的每一项操作，从而跟踪用户活动和 API 使用情况。CloudTrail 在你创建
    AWS 账户时默认启用。它存储事件历史，用户可以通过 CloudTrail 仪表板访问，记录了账户中每项活动的历史。以下截图展示了 CloudWatch 事件历史的示例：
- en: '![Figure 13.3 – AWS CloudTrail'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 13.3 – AWS CloudTrail'
- en: '](img/B17124_13_03.jpg)'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17124_13_03.jpg)'
- en: Figure 13.3 – AWS CloudTrail
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13.3 – AWS CloudTrail
- en: You can use CloudTrail for enforcing and managing your overall compliance and
    governance requirements since it can provide you with a time-ordered series of
    events that have taken place in your account. You can also respond to events as
    they occur by ingesting them into Amazon CloudWatch and then configuring alarms
    or event rules accordingly to react to specific events. AWS CloudTrail events
    provide a history of both API and non-API activity. API activity includes actions
    such as launching a new EC2 instance or creating a new IAM user. Non-API activity
    refers to other types of actions, such as logging into the AWS Management Console.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 CloudTrail 强制执行和管理整体合规性与治理要求，因为它可以为你提供按时间排序的系列事件，记录你账户中发生的所有活动。你还可以通过将事件导入
    Amazon CloudWatch，并根据需要配置警报或事件规则，以便在特定事件发生时作出响应。AWS CloudTrail 事件提供了 API 和非 API
    活动的历史记录。API 活动包括启动新的 EC2 实例或创建新 IAM 用户等操作。非 API 活动指的是其他类型的操作，例如登录 AWS 管理控制台。
- en: 'AWS CloudTrail enables you to record three different types of events, as follows:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: AWS CloudTrail 使你能够记录三种不同类型的事件，如下所示：
- en: '`RunInstances` API operation to launch an EC2 instance as shown in the preceding
    screenshot, which was performed by our IAM user, `DescribeInstances` API operation,
    which will return a list of EC2 instances but where no changes are made. Finally,
    management events can also include non-API activity, such as when a user logs
    into the AWS Management Console.'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`RunInstances` API 操作，用于启动如前所示的 EC2 实例，此操作由我们的 IAM 用户执行，`DescribeInstances`
    API 操作，用于返回 EC2 实例列表，但不做任何更改。最后，管理事件也可以包括非 API 活动，例如当用户登录到 AWS 管理控制台时。'
- en: '`PutObject` API operation. Data events are also known as *data plane operations*
    and tend to be high-volume. Other examples of data events include Lambda function
    executions using the `Invoke` API and the `PutItem` API operation on a DynamoDB
    table, which results in new items being added to the table. Data events are not
    logged by default. To record data events, you need to create a trail and explicitly
    add supported resources or resource types for which you wish to collect events.'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`PutObject` API 操作。数据事件也称为*数据平面操作*，通常具有高流量。数据事件的其他示例包括使用 `Invoke` API 执行的 Lambda
    函数，以及对 DynamoDB 表进行的 `PutItem` API 操作，这会导致新项目被添加到表中。数据事件默认情况下不会被记录。要记录数据事件，你需要创建一个跟踪并明确添加你希望收集事件的受支持资源或资源类型。'
- en: '`deleteBucket` API calls per minute, but all of a sudden, it starts to log
    an average of 200 `deleteBucket` API calls per minute. Insight events contain
    related information about the event, such as API, incident time, and statistics,
    that help you understand and act on unusual activity.'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每分钟 `deleteBucket` API 调用次数突然从平均每分钟几十次增加到每分钟 200 次。洞察事件包含与事件相关的信息，如 API、事件发生时间和统计数据，这些信息有助于你了解并应对异常活动。
- en: CloudTrail will log all API management events automatically when you open a
    new AWS account. The event history service will store 90 days' worth of management
    events that can be viewed and downloaded. The event history will not contain any
    data events – for this, you will need to create a trail. Let's look at trails
    next.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: CloudTrail 在你开启新的 AWS 账户时，会自动记录所有 API 管理事件。事件历史服务会存储90天的管理事件，这些事件可以查看并下载。事件历史不包含任何数据事件—为此，你需要创建一个跟踪。接下来，我们来看看跟踪。
- en: Trails
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 跟踪
- en: If you wish to configure CloudTrail to store specific management events or data
    events and require more than 90 days' worth of event history, you can configure
    a *trail*. A trail is a configuration that enables CloudTrail to record specific
    types of events and have them delivered to an Amazon S3 bucket, CloudWatch Logs,
    and CloudWatch Events.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望配置 CloudTrail 来存储特定的管理事件或数据事件，并需要超过 90 天的事件历史记录，您可以配置一个*轨迹*。轨迹是一个配置项，它使
    CloudTrail 能够记录特定类型的事件，并将它们交付到 Amazon S3 存储桶、CloudWatch Logs 和 CloudWatch Events。
- en: 'Trails can be configured to record events from a single Region or across Regions:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 轨迹可以配置为仅记录单一区域的事件或跨区域记录事件：
- en: '**Single Region trail**: CloudTrail will records events that are specific to
    the Region you specify, and those log files are delivered to an Amazon S3 bucket
    you specify. Multiple trails can be delivered to the same S3 bucket or separate
    buckets. Single trails are viewable only in the AWS Regions where the logs are
    created.'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**单一区域轨迹**：CloudTrail 会记录特定于您指定区域的事件，这些日志文件将交付到您指定的 Amazon S3 存储桶。多个轨迹可以交付到同一个
    S3 存储桶或不同的存储桶。单个轨迹仅在日志创建的 AWS 区域中可查看。'
- en: '**All Regions trail**: CloudWatch will record events in each Region and deliver
    the event log files to the S3 bucket you specify. Note that if Amazon adds a new
    Region after you have created a trail that applies to *all Regions*, then the
    new Region is automatically included as well.'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**全区域轨迹**：CloudWatch 会记录每个区域的事件，并将事件日志文件交付到您指定的 S3 存储桶。请注意，如果在您创建适用于*所有区域*的轨迹后，Amazon
    添加了新的区域，则该新区域也会自动包含在内。'
- en: By default, an *all-Regions trail* is the default option when you create a trail
    in the CloudTrail console. Furthermore, CloudTrail will deliver log files from
    multiple Regions to a single Amazon S3 bucket and a CloudWatch Logs log group.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，*全区域轨迹*是您在 CloudTrail 控制台创建轨迹时的默认选项。此外，CloudTrail 会将来自多个区域的日志文件交付到一个单独的
    Amazon S3 存储桶和 CloudWatch Logs 日志组。
- en: Most AWS services are Region-specific and so events are recorded in the Region
    in which the action occurred. However, for global services like `US East (N. Virginia)`
    Region.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数 AWS 服务是区域特定的，因此事件会在发生操作的区域中记录。然而，对于像 `US East (N. Virginia)` 这样的全球服务区域，事件会跨区域记录。
- en: You can also create an *AWS organization trail*, which is a configuration option
    that allows you to record events in the management account and all member accounts
    in AWS Organizations. Using an organization trail will ensure that you record
    important events across all your AWS accounts.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 您还可以创建一个 *AWS 组织轨迹*，它是一种配置选项，可以让您在管理账户和所有 AWS 组织中的成员账户中记录事件。使用组织轨迹将确保您记录所有 AWS
    账户中的重要事件。
- en: In this section, you learned about AWS CloudTrail, which is a service that enables
    you to audit your AWS account and enable compliance, monitoring, and governance.
    AWS CloudTrail is not designed for performance and system health monitoring. Other
    monitoring services, such as Amazon CloudWatch, are designed to help you address
    performance or system health-related matters. Often, you are going to be using
    these tools together as part of the overall management of your AWS services and
    resources.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 在这一节中，您了解了 AWS CloudTrail，它是一个可以帮助您审计 AWS 账户并启用合规性、监控和治理的服务。AWS CloudTrail 并非专为性能和系统健康监控而设计。其他监控服务，如
    Amazon CloudWatch，旨在帮助您解决与性能或系统健康相关的问题。通常，您会将这些工具一起使用，作为 AWS 服务和资源整体管理的一部分。
- en: In the next section, we will look at the AWS Config service, which allows you
    to assess, audit, and evaluate the *configuration changes* of your AWS resources,
    and help in your overall change management process.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将介绍 AWS Config 服务，它可以帮助您评估、审核和评估您的 AWS 资源的*配置变更*，并有助于您的整体变更管理过程。
- en: Learning about change management with AWS Config
  id: totrans-93
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 学习使用 AWS Config 进行变更管理
- en: AWS Config is a service that allows you to gain visibility into how your AWS
    resources are configured and deployed in your AWS account. With AWS Config, you
    can see how resources are related to each other, how they were configured in the
    past, and historical changes to those resources over time.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: AWS Config 是一种服务，可以帮助您了解 AWS 资源在 AWS 账户中的配置和部署情况。使用 AWS Config，您可以查看资源之间的关联，了解它们过去是如何配置的，以及这些资源随时间变化的历史记录。
- en: This can be particularly useful when you start running multiple environments,
    such as development and production, where within those environments are hosted
    countless resources across the vast array of services on AWS. For example, you
    would want to be aware of how your VPCs have been configured, what subnets and
    security groups are attached to them, what routes have been added to your route
    tables, and so on. AWS Config can help you maintain an accurate database of all
    this information as well as track changes as they occur in your AWS accounts.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 当你开始运行多个环境时，这特别有用，比如开发和生产环境，在这些环境中托管着无数的资源，涵盖了 AWS 上各种服务。例如，你会想了解你的 VPC 是如何配置的，哪些子网和安全组附加到它们上，哪些路由已添加到路由表中，等等。AWS
    Config 可以帮助你维护所有这些信息的准确数据库，并跟踪它们在 AWS 账户中的更改。
- en: You can use AWS Config to ensure that your resources have been configured in
    accordance with internal guidelines that fulfill compliance requirements. The
    service enables you to effectively implement security analysis, change management
    processes, and troubleshooting exercises.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以使用 AWS Config 确保你的资源已根据内部指南进行配置，从而满足合规性要求。该服务使你能够有效地实施安全分析、变更管理流程和故障排除操作。
- en: Let's look at some of the core components of AWS Config.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看看 AWS Config 的一些核心组件。
- en: Configuration items
  id: totrans-98
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置项
- en: 'A `JSON diff` file, highlighting the fields which have changed, as shown in
    the following screenshot:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 一个 `JSON diff` 文件，突出显示已更改的字段，如下所示的截图所示：
- en: '![Figure 13.4 – AWS Config JSON showing a configuration change for an EC2 instance'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 13.4 – 显示 EC2 实例配置变更的 AWS Config JSON'
- en: '](img/B17124_13_04.jpg)'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17124_13_04.jpg)'
- en: Figure 13.4 – AWS Config JSON showing a configuration change for an EC2 instance
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13.4 – 显示 EC2 实例配置变更的 AWS Config JSON
- en: As noted in the preceding screenshot, you can see that AWS Config has noted
    various changes that were made to our EC2 instance, such as the upgrade of the
    instance type from `t2.micro` to `t2.small`.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 如前面的截图所示，你可以看到 AWS Config 已记录对我们的 EC2 实例所做的各种更改，例如将实例类型从 `t2.micro` 升级到 `t2.small`。
- en: Configuration history
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置历史
- en: This is particularly useful when you want to review changes to your resources
    over time. The configuration history is a record of configuration items for a
    given resource over a period. Using the configuration history, you can answer
    questions such as when a resource was first created, what changes were made over
    the last week, and what configuration changes were introduced two days ago at
    4 P.M. The configuration history file for each resource type is stored in an Amazon
    S3 bucket that you specify.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 当你想要回顾资源随时间变化的情况时，这尤其有用。配置历史记录是给定资源在一段时间内的配置项记录。通过使用配置历史记录，你可以回答诸如资源何时首次创建、过去一周内做了哪些更改、以及两天前下午四点做了哪些配置更改等问题。每种资源类型的配置历史文件存储在你指定的
    Amazon S3 存储桶中。
- en: Configuration recorder
  id: totrans-106
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置记录器
- en: 'The configuration recorder must be enabled and started for AWS Config to start
    recording changes made to your resources and to create CIs. The configuration
    record can be configured to record all resources or only specific resources in
    each Region, as shown in the following screenshot:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 必须启用并启动配置记录器，才能使 AWS Config 开始记录对资源所做的更改并创建配置项（CIs）。可以配置配置记录器以记录所有资源，或仅记录每个区域中的特定资源，如下所示的截图所示：
- en: '![Figure 13.5 – AWS Config settings'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 13.5 – AWS Config 设置'
- en: '](img/B17124_13_05.jpg)'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17124_13_05.jpg)'
- en: Figure 13.5 – AWS Config settings
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13.5 – AWS Config 设置
- en: You will also note that you can also choose to record global resources, such
    as IAM resources.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 你还会注意到，你也可以选择记录全局资源，例如 IAM 资源。
- en: Configuration snapshot
  id: totrans-112
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置快照
- en: This is a collection of configuration items for your resources represented as
    a point-in-time image in your AWS environment. The snapshot can be used to validate
    configurations and identify any that are incorrectly configured. The snapshots
    can be stored in a predefined Amazon S3 bucket and can be viewed in the AWS Config
    console.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 这是你资源的配置项集合，以时间点的图像形式表示，位于你的 AWS 环境中。该快照可以用于验证配置，并识别任何配置错误的项。快照可以存储在预定义的 Amazon
    S3 存储桶中，并可以在 AWS Config 控制台中查看。
- en: Configuration stream
  id: totrans-114
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 配置流
- en: As you create, modify, or delete resources in your AWS account, new CIs are
    created, which are added to the configuration stream. The configuration stream
    uses an Amazon SNS topic to send out notifications every time a change to your
    resources occurs. This can be used to alert an administrator, for example, and
    potentially watch out for any technical or security issues.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 当你在 AWS 账户中创建、修改或删除资源时，会创建新的 CI，并将其添加到配置流中。配置流使用 Amazon SNS 主题来发送通知，每次资源发生更改时都会触发通知。这可以用来提醒管理员，例如，及时发现任何技术或安全问题。
- en: In this section, you learned about the AWS Config service, which is a service
    to help you manage changes to your resources in your AWS account. You can use
    AWS Config to monitor how your resources relate to each other and how the configurations
    and relationships change over time.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，你了解了 AWS Config 服务，它是一项帮助你管理 AWS 账户中资源更改的服务。你可以使用 AWS Config 来监视资源之间的关系以及这些配置和关系随时间的变化。
- en: In the next section, we look at AWS Systems Manager, which enables you to track
    and resolve operational issues across your AWS accounts, automate day-to-day operational
    tasks to manage your resources, and enforce security measures for your applications.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，我们将介绍 AWS Systems Manager，它使你能够跟踪和解决 AWS 账户中的操作问题，自动化日常操作任务来管理资源，并对应用程序实施安全措施。
- en: Managing your AWS resources with AWS Systems Manager
  id: totrans-118
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用 AWS Systems Manager 管理你的 AWS 资源
- en: AWS Systems Manager is a service that enables you to centrally manage your AWS
    resources. With AWS Systems Manager, you can gain visibility of your resources
    across AWS services, perform configuration management, and automate day-to-day
    operational tasks. Previously known as **SSM**, AWS Systems Manager can help you
    can enforce compliance with desired configuration states and take corrective action
    on any policy violations where necessary.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: AWS Systems Manager 是一项使你能够集中管理 AWS 资源的服务。通过 AWS Systems Manager，你可以获得跨 AWS
    服务的资源可见性，执行配置管理，并自动化日常操作任务。以前称为 **SSM**，AWS Systems Manager 可以帮助你强制执行所需的配置状态，并在必要时对任何政策违规采取纠正措施。
- en: 'AWS Systems Manager uses the concept of documents (written in JSON or YAML),
    which define the actions that Systems Manager performs on your managed resources.
    The documents are used by AWS Systems Manager to fulfill its various capabilities,
    such as operational management, change management, application management, and
    node management. AWS Systems Manager comes with a vast collection of predefined
    documents, and you can create your own. For example, the **AWS-CreateRdsSnapshot**
    document can be used to create an RDS snapshot for an RDS instance, as shown in
    the following screenshot:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: AWS Systems Manager 使用文档（以 JSON 或 YAML 编写）的概念，这些文档定义了 Systems Manager 在你的管理资源上执行的操作。这些文档被
    AWS Systems Manager 用于实现其各种功能，如操作管理、变更管理、应用管理和节点管理。AWS Systems Manager 提供了大量预定义文档，你也可以创建自己的文档。例如，**AWS-CreateRdsSnapshot**
    文档可以用于为 RDS 实例创建 RDS 快照，如以下屏幕截图所示：
- en: '![Figure 13.6 – AWS Systems Manager predefined documents'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 13.6 – AWS Systems Manager 预定义文档'
- en: '](img/B17124_13_06.jpg)'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17124_13_06.jpg)'
- en: Figure 13.6 – AWS Systems Manager predefined documents
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13.6 – AWS Systems Manager 预定义文档
- en: 'AWS Systems Manager offers a wide range of capabilities, including the following:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: AWS Systems Manager 提供广泛的功能，包括以下内容：
- en: '**Run Command**: Part of the node management capability, the Run Command capability
    enables you to remotely run Linux shell scripts and Windows PowerShell commands
    on your fleet of EC2 instances. This can be used to perform configuration changes,
    and install and update applications.'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**运行命令**：作为节点管理功能的一部分，运行命令功能使你能够在 EC2 实例集群中远程运行 Linux shell 脚本和 Windows PowerShell
    命令。这可以用于执行配置更改，安装和更新应用程序。'
- en: '**State Manager**: This ensures that your managed instances are configured
    to a predefined state, enabling you to maintain consistency in your configurations
    across a fleet of instances, such as firewall configuration, antivirus configurations,
    and more.'
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**状态管理器**：它确保你的管理实例配置为预定义的状态，使你能够在一组实例中保持配置的一致性，例如防火墙配置、杀毒软件配置等。'
- en: '**Inventory**: This enables you to gather software configuration information
    about your EC2 instances. The Inventory capability will provide information on
    applications, files, components, and patches across your managed instances.'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**清单**：它使你能够收集关于 EC2 实例的软件配置资料。清单功能将提供有关应用程序、文件、组件和补丁的信息，涵盖你的管理实例。'
- en: '**Maintenance Window**: Part of the change management capability, the Maintenance
    Window service enables you to schedule times when administrative tasks such as
    installing patches and updates can be performed so as not to disrupt your team
    during normal business hours.'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**维护窗口**：作为变更管理功能的一部分，维护窗口服务使您能够安排执行管理任务的时间，例如安装补丁和更新，以避免在正常工作时间干扰您的团队。'
- en: '**Patch Manager**: This enables you to automate patching of your EC2 instances,
    which can comprise security and application updates. Note that updates for applications
    on Windows servers are limited to those released by Microsoft.'
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**补丁管理器**：这使您能够自动化 EC2 实例的补丁操作，包括安全性和应用更新。请注意，Windows 服务器上的应用更新仅限于由 Microsoft
    发布的更新。'
- en: '**Automation**: This enables you to automate various maintenance tasks, such
    as updating AMIs, creating snapshots of **Elastic Block Store** (**EBS**) volumes,
    resetting passwords, and launching or terminating EC2 instances, among others.'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**自动化**：这使您能够自动化各种维护任务，例如更新 AMI、创建**弹性块存储**（**EBS**）卷的快照、重置密码以及启动或终止 EC2 实例等。'
- en: '**Parameter Store**: This offers a means of securely storing configuration
    data and secret information. For example, in [*Chapter 9*](B17124_09_Final_SK_ePub.xhtml#_idTextAnchor223),
    *High Availability, and Elasticity on AWS*, you will recall configuring the database
    connection strings for the *good deed of the month* application. The database
    connection strings consisted of sensitive username and password information, which
    was saved in plain text in the Amazon S3 bucket repository. Furthermore, the database
    connections file when copied from the S3 bucket and stored in the HTML directory
    of your server is a security risk. Sensitive information should always be stored
    and managed more securely. AWS Systems Manager''s Parameter Store enables you
    to store sensitive information such as passwords and database strings as parameter
    values. These values can be stored encrypted, and your application can be configured
    to securely retrieve these values as they are needed from the Parameter Store.'
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**参数存储**：这为您提供了一种安全存储配置数据和机密信息的方法。例如，在[*第九章*](B17124_09_Final_SK_ePub.xhtml#_idTextAnchor223)，*AWS
    上的高可用性和弹性*中，您会回忆起配置“本月的善举”应用程序的数据库连接字符串。数据库连接字符串包含敏感的用户名和密码信息，这些信息以纯文本形式保存在 Amazon
    S3 存储桶中。此外，当从 S3 存储桶复制数据库连接文件并将其存储在服务器的 HTML 目录中时，存在安全风险。敏感信息应始终以更安全的方式进行存储和管理。AWS
    系统管理器的参数存储使您能够将敏感信息（如密码和数据库字符串）作为参数值存储。这些值可以加密存储，您的应用程序可以配置为在需要时从参数存储中安全地检索这些值。'
- en: '**Distributor**: This enables you to create and deploy application packages
    to your managed instances. You can create your software packages as executables
    that operating systems recognize, enabling easy deployments. Distributor can also
    reinstall new package versions and perform in-place updates.'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分发器**：这使您能够创建并将应用程序包部署到您管理的实例上。您可以将软件包创建为操作系统识别的可执行文件，从而实现轻松部署。分发器还可以重新安装新版本的包，并执行就地更新。'
- en: '**Session Manager**: In [*Chapter 7*](B17124_07_Final_SK_ePub.xhtml#_idTextAnchor157),
    *AWS Compute Services*, we discussed the importance of bastion hosts, which act
    as an entry point to administer other EC2 instances you deploy in a VPC, across
    your public and private subnets. While bastion hosts are intended to be highly
    secure because of how they are configured or accessed, you still need to manage
    and maintain the servers, including performing security updates, ensuring performance
    levels, and so on. AWS Systems Manager offers **Session Manager**, which allows
    remote access to your EC2 instances using a browser-based shell or the CLI. Session
    Manager provides secure and auditable instance management without the need to
    open inbound ports, maintain bastion hosts, or manage SSH keys.'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**会话管理器**：[*第七章*](B17124_07_Final_SK_ePub.xhtml#_idTextAnchor157)，*AWS 计算服务*中，我们讨论了堡垒主机的重要性，堡垒主机作为进入点，用于管理您在
    VPC 中部署的其他 EC2 实例，跨越公共子网和私有子网。虽然堡垒主机由于其配置或访问方式被设计为高度安全，但您仍然需要管理和维护这些服务器，包括执行安全更新、确保性能水平等。AWS
    系统管理器提供了**会话管理器**，允许您使用基于浏览器的 shell 或命令行界面（CLI）远程访问 EC2 实例。会话管理器提供了安全且可审计的实例管理，无需打开入站端口、维护堡垒主机或管理
    SSH 密钥。'
- en: '**Incident Manager**: This is another Systems Manager offering that enables
    you to manage and resolve incidents affecting AWS-hosted applications. The Incident
    Manager service offers a management console to track all your incidents and notify
    responders of impact, identify data that can help with troubleshooting, and help
    you get services back up and running.'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**事件管理器**：这是另一个 Systems Manager 提供的功能，帮助您管理和解决影响 AWS 托管应用程序的事件。事件管理器服务提供了一个管理控制台，能够跟踪所有事件，通知响应人员事件的影响，识别有助于故障排除的数据，并帮助您恢复服务。'
- en: 'These are just some of the capabilities on offer from AWS Systems Manager.
    Here is a quick screenshot of the Inventory console, showcasing information from
    a single EC2 instance that was deployed in my AWS account:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 这些只是 AWS Systems Manager 提供的一些功能。这里是清单控制台的快速截图，展示了我在 AWS 账户中部署的单个 EC2 实例的相关信息：
- en: '![Figure 13.7 – AWS Systems Manager Inventory'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 13.7 – AWS Systems Manager 清单'
- en: '](img/B17124_13_07.jpg)'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17124_13_07.jpg)'
- en: Figure 13.7 – AWS Systems Manager Inventory
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13.7 – AWS Systems Manager 清单
- en: So far, we have looked at the AWS Systems Manager service, which offers a suite
    of capabilities to centrally manage and automate day-to-day operations for your
    AWS resources.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经看过了 AWS Systems Manager 服务，它提供了一套功能，帮助您集中管理和自动化日常操作，以便管理您的 AWS 资源。
- en: In the next section, you will learn about the AWS Trusted Advisor service, which
    enables you to inspect your AWS environment and identify whether your resources
    have been configured in accordance with AWS best practices.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，您将了解 AWS Trusted Advisor 服务，该服务使您能够检查您的 AWS 环境，并识别您的资源是否按照 AWS 最佳实践进行配置。
- en: Learning how to use AWS Trusted Advisor
  id: totrans-141
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 学习如何使用 AWS Trusted Advisor
- en: The AWS Trusted Advisor service analyzes your resources and how they have been
    configured. The service helps to measure the configuration of your resources against
    best practices and identify opportunities to save money, improve system availability
    and performance, or address security concerns.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: AWS Trusted Advisor 服务分析您的资源及其配置方式。该服务帮助您将资源的配置与最佳实践进行对比，并识别节省成本、提高系统可用性和性能或解决安全问题的机会。
- en: 'Specifically, the Trusted Advisor service will report on its analysis against
    the following core categories:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 特别地，Trusted Advisor 服务将报告其针对以下核心类别的分析：
- en: '**Cost optimization**: Performs checks on your resources to identify which
    ones are underutilized. AWS Trusted Advisor will then offer recommendations on
    where you could reduce your costs. For example, Elastic IP addresses are only
    free if they are attached to a running EC2 instance. AWS charges you an hourly
    fee for provisioning Elastic IP addresses if they are not being consumed, that
    is, not attached to any instance, or attached to an instance that is in a stopped
    state.'
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**成本优化**：对您的资源进行检查，识别哪些资源未充分利用。AWS Trusted Advisor 会根据这些信息提供减少成本的建议。例如，Elastic
    IP 地址只有在附加到正在运行的 EC2 实例时才是免费的。如果 Elastic IP 地址没有被使用（即没有附加到任何实例，或者附加到已停止的实例上），AWS
    会按小时收费。'
- en: '**Performance**: Offers recommendations on where you can improve the responsiveness
    of your applications. For example, if you are using a gp2 EBS volume type for
    an EC2 instance that seems to be heavily utilized, it can recommend you an upgrade
    to an io1 EBS volume, which will improve performance.'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**性能**：提供关于如何改善应用程序响应性的建议。例如，如果您为一个似乎被大量使用的 EC2 实例使用的是 gp2 EBS 卷类型，系统会建议您升级为
    io1 EBS 卷，从而提高性能。'
- en: '**Security**: Reports on any resources that have not been configured in accordance
    with security best practices. For example, if you have not configured MFA on the
    root account, then AWS will highlight this as a potential security risk and recommend
    that you configure MFA.'
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**安全性**：报告任何未按照安全最佳实践配置的资源。例如，如果您没有在根账户上配置 MFA，AWS 会将其视为潜在的安全风险，并建议您配置 MFA。'
- en: '**Fault tolerance**: Identifies options for increasing the resiliency of your
    AWS solutions. For example, AWS will identify any RDS instance that has not been
    configured with multi-AZ as a risk factor.'
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**容错性**：识别增加 AWS 解决方案弹性的选项。例如，AWS 会将任何没有配置多可用区（multi-AZ）的 RDS 实例视为风险因素。'
- en: '**Service limits**: Checks your AWS account to identify whether you are approaching
    any service limits or quotas. For example, when using the AWS Auto Scaling service,
    you have a default limit of configuring up to 200 launch configurations per Region.
    Should you start to exceed more than 80% of this limit, you will see an alert
    in Trusted Advisor.'
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**服务限制**：检查您的 AWS 账户，识别是否接近任何服务限制或配额。例如，当使用 AWS Auto Scaling 服务时，您每个区域的默认限制是最多配置
    200 个启动配置。如果您开始超过此限制的 80%，您将在 Trusted Advisor 中看到警告。'
- en: AWS Trusted Advisor and Support plans
  id: totrans-149
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: AWS Trusted Advisor 和支持计划
- en: The AWS Trusted Advisor service offers different levels of checks based on the
    AWS Support plan that you have subscribed to. If you are only on the *Basic* Support
    plan, then you only have access to six checks in the security category and all
    checks in the service limits category.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: AWS Trusted Advisor 服务根据您订阅的 AWS 支持计划提供不同级别的检查。如果您仅订阅了 *基础* 支持计划，您将只能访问安全类别中的六项检查和服务限制类别中的所有检查。
- en: To access the full range of checks across all categories, you must be subscribed
    to either the *Business* or *Enterprise* Support plans. With either of these plans,
    you can also use Amazon CloudWatch Events to monitor the status of Trusted Advisor
    checks.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 若要访问所有类别中的完整检查范围，您必须订阅 *企业* 或 *商业* 支持计划。订阅这两种计划中的任意一种后，您还可以使用 Amazon CloudWatch
    Events 来监控 Trusted Advisor 检查的状态。
- en: In this section, we discussed the AWS Trusted Advisor service, which is a reporting
    tool that enables you to identify whether your resources have been configured
    in accordance with best practices and whether there are opportunities to save
    on costs.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，我们讨论了 AWS Trusted Advisor 服务，它是一个报告工具，可以帮助你识别资源是否按照最佳实践配置，并检查是否有节省成本的机会。
- en: In the next section, you will learn about the AWS Well-Architected Framework,
    which offers a series of recommendations to help you build secure, high-performing,
    resilient, and efficient application infrastructure.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一节中，您将了解 AWS Well-Architected 框架，该框架提供一系列建议，帮助您构建安全、高性能、具备韧性和高效的应用程序基础设施。
- en: Understanding the AWS Well-Architected Framework
  id: totrans-154
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 了解 AWS Well-Architected 框架
- en: The AWS Well-Architected Framework consists of a set of design principles and
    architectural best practices that you can follow when building solutions for the
    cloud. AWS offers the Well-Architected Tool, which can be used to review the state
    of your applications and resources, and compares them to the latest AWS architectural
    best practices.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: AWS Well-Architected 框架由一系列设计原则和架构最佳实践组成，您可以在构建云解决方案时遵循这些原则。AWS 提供了 Well-Architected
    工具，您可以使用它来审查您的应用程序和资源的状态，并将其与最新的 AWS 架构最佳实践进行比较。
- en: The Well-Architected Framework comprises the following *five pillars*.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: Well-Architected 框架包括以下 *五大支柱*。
- en: Reliability
  id: totrans-157
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 可靠性
- en: Applications deployed in the cloud must be resilient to failures. The resources
    that your applications depend on (compute, storage, networks, and databases) must
    be available and reliable. Any technical issues on any of these resources will
    cause your application to become unreliable and potentially fail.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 部署在云中的应用程序必须具有抗故障能力。应用程序所依赖的资源（计算、存储、网络和数据库）必须是可用且可靠的。任何这些资源上的技术问题都会导致应用程序变得不可靠，甚至可能会失败。
- en: The reliability pillar also focuses on how quickly you can recover from failure
    based on your architectural design. This is because failures are bound to happen
    and your architecture must be able to recover from these failures swiftly. One
    key concept that you should also consider is the fact that replacing a failed
    component is often better than trying to figure out why the component failed and
    attempting to resolve the issue that caused the failure. This is because as you
    spend time trying to troubleshoot the failure, you risk increasing your **Recovery
    Time Objective** (**RTO**). For example, with EC2, you can deploy your application
    across multiple instances and multiple AZs. You can then configure Elastic Load
    Balancers and the Auto Scaling service to ensure that if an EC2 instance fails,
    traffic is routed to only those instances that are healthy, while the failed EC2
    instance is replaced automatically in the background.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 可靠性支柱还关注你在架构设计中如何迅速从故障中恢复。这是因为故障是不可避免的，你的架构必须能够迅速从故障中恢复。你应该考虑的一个关键概念是，替换故障组件通常比试图找出故障原因并解决故障根本问题更好。这是因为当你花时间排查故障时，可能会导致**恢复时间目标**（**RTO**）的增加。例如，使用
    EC2 时，你可以将应用程序部署在多个实例和多个可用区（AZ）中。然后，你可以配置弹性负载均衡器和自动伸缩服务，确保当某个 EC2 实例发生故障时，流量会被路由到其他健康实例，而故障实例会在后台自动被替换。
- en: Performance efficiency
  id: totrans-160
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 性能效率
- en: When architecting your cloud solutions, you want to offer the best performance
    while still ensuring that you are optimized for cost. This means you should always
    try to select the resource types and sizes based on your performance needs, while
    monitoring your resources consistently to ensure you maintain those levels of
    performance in accordance with demand. Performance should not suffer if demand
    increases. At the same time, you should only provide resources as they are required
    to avoid underutilization of those resources.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 在设计你的云解决方案时，你需要提供最佳性能的同时，确保优化成本。这意味着你应该根据性能需求选择资源的类型和大小，并持续监控资源，以确保在需求变化时能够维持这些性能水平。如果需求增加，性能不应该受到影响。同时，你应该仅在需要时提供资源，避免资源的低效利用。
- en: You'd often need to incorporate resources that fall across different AWS services,
    such as compute, storage, and networking, and architecting your solution requires
    careful planning in addition to configuring each of those resources. For example,
    if your application is hosted in the London Region, your users in London may experience
    good performance. However, if you have users in South America, you may experience
    poor performance due to network latency issues. You can consider using Amazon
    CloudFront to cache your application content at edge locations closer to your
    South American users, improving overall application performance.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 你通常需要结合使用多个 AWS 服务中的资源，如计算、存储和网络，架构设计不仅需要仔细规划，还要配置每个资源。例如，如果你的应用托管在伦敦区域，伦敦的用户可能会体验到良好的性能。然而，如果你在南美有用户，可能会因为网络延迟问题导致性能不佳。你可以考虑使用
    Amazon CloudFront 在离南美用户更近的边缘位置缓存你的应用内容，从而提升整体应用性能。
- en: Security
  id: totrans-163
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 安全性
- en: You should always keep security in mind whenever you are designing your cloud
    solutions. You want to ensure that your applications are accessed securely by
    only authorized users. You also want to ensure data integrity, privacy, and sovereignty.
    Assigning permissions to users must always be based on the principle of least
    privilege, ensuring that access is granted only where required to fulfill the
    job function and nothing more.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 在设计云解决方案时，你应该始终考虑安全性。你需要确保只有授权用户能够安全地访问你的应用程序。你还需要确保数据的完整性、隐私和主权。分配权限给用户时，必须始终遵循最小权限原则，确保只有在执行工作职能时才授予访问权限，而不多于此。
- en: You should incorporate a backup and disaster recovery strategy for your application
    solutions, which would also comprise securing the underlying resources that power
    your application. For example, you must ensure that your databases are backed
    up or that you regularly create EBS snapshots. Another example is to configure
    Amazon S3 bucket replication and, if possible, to use cross-regional replication
    configurations. Finally, you must be able to audit every activity that takes place
    in your account, and you can use tools such as AWS CloudTrail to maintain an audit
    log.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 您应该为您的应用程序解决方案制定备份和灾难恢复策略，这也包括确保支撑您应用程序的基础资源。例如，您必须确保数据库有备份，或者定期创建EBS快照。另一个例子是配置Amazon
    S3桶复制，并在可能的情况下使用跨区域复制配置。最后，您必须能够审计账户中的每一项活动，可以使用如AWS CloudTrail等工具来维护审计日志。
- en: Operational excellence
  id: totrans-166
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 操作卓越
- en: This pillar focuses on achieving operational excellence by making frequent,
    reversible, and continuous changes to your workloads. Your aim should be to achieve
    continuous improvements in your processes and procedures. Furthermore, automating
    operational tasks will strengthen the other pillars, and using **Infrastructure
    as Code** (**IaC**) with tools such as CloudFormation can help to avoid human
    error and enable consistency in how you respond to events.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 这一支柱专注于通过对工作负载进行频繁、可逆且持续的更改来实现操作卓越。您的目标应该是持续改进您的流程和程序。此外，自动化操作任务将加强其他支柱，使用**基础设施即代码**
    (**IaC**) 和像CloudFormation这样的工具可以帮助避免人为错误，并确保您对事件的响应一致。
- en: The operational excellence pillar also suggests anticipating failure and to
    consider performing fail tests and recovery exercises, from which you can learn
    how to remove potential sources of failure and mitigate risks. Understanding how
    your applications fail will also help you design automatic recovery solutions,
    which will offer consistency and rapid recovery.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 操作卓越支柱还建议预见潜在故障并考虑进行故障测试和恢复演练，从中您可以学习如何消除潜在的故障源并降低风险。了解您的应用程序如何故障，还能帮助您设计自动恢复解决方案，提供一致性和快速恢复。
- en: Cost optimization
  id: totrans-169
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 成本优化
- en: This pillar focuses on ensuring that you architect and build solutions in a
    manner that avoids unnecessary costs. At the same time, you want to be able to
    ensure that your applications are highly performant, reliable, operationally efficient,
    and secure. To achieve cost optimization, you should first understand your spending
    patterns and analyze where the money is going. Using tools such as Cost Explorer
    and Cost and Usage Reports will help you with this.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 这一支柱侧重于确保您以避免不必要成本的方式构建和设计解决方案。同时，您还希望确保您的应用程序具有高性能、可靠性、操作效率和安全性。为了实现成本优化，您应首先了解您的消费模式，并分析资金流向。使用像Cost
    Explorer和成本与使用报告等工具可以帮助您完成这项工作。
- en: Next, you must always try to adopt a consumption model. If you are running development
    and test servers that only going to be used for 8 hours a day, Monday to Friday,
    it makes sense to consider procuring those EC2 instances using the On-Demand pricing
    option. You should then ensure that those servers stopped outside of normal business
    hours for a potential cost saving of up to 75% (40 hours versus 168 hours a week).
    Remember that you can automate the startup and shutdown of your EC2 instances
    using Lambda functions and CloudWatch Events, as discussed in [*Chapter 12*](B17124_12_Final_SK_ePub.xhtml#_idTextAnchor296),
    *Automation and Deployment on AWS*.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，您必须始终尝试采用消费模式。如果您正在运行仅在周一到周五每天使用8小时的开发和测试服务器，那么考虑使用按需定价选项购买这些EC2实例是有意义的。然后，您应该确保这些服务器在正常工作时间之外停止，以便潜在地节省高达75%的成本（每周40小时对比168小时）。请记住，您可以使用Lambda函数和CloudWatch事件自动化启动和关闭EC2实例，正如在[*第12章*](B17124_12_Final_SK_ePub.xhtml#_idTextAnchor296)中讨论的，*AWS上的自动化与部署*。
- en: Other areas where you can design for cost optimization include using managed
    service offerings instead of performing heavy-lifting, data center-style operations.
    For example, it is much more cost-effective to host your databases on Amazon RDS
    and have AWS perform all the management functions for you than spinning up EC2
    instances on which you install your database software. The latter results in more
    management efforts to ensure your database servers are patched, backed up, and
    secure.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以在其他设计中考虑成本优化领域，例如使用托管服务，而不是执行重型操作或数据中心风格的操作。例如，将数据库托管在 Amazon RDS 上并让 AWS
    为你执行所有管理功能，比在 EC2 实例上安装数据库软件要更具成本效益。后者需要更多的管理工作来确保你的数据库服务器已打补丁、备份并保持安全。
- en: In this section, you learned about the AWS Well-Architected Framework, which
    is a set of guiding principles and best-practice recommendations to help you design
    and run your solutions in the cloud. In the next section, we move on to some exercises
    for this chapter.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 在本节中，你了解了 AWS Well-Architected 框架，它是一套指导原则和最佳实践建议，旨在帮助你设计和运行云中的解决方案。在下一节中，我们将进行本章的一些练习。
- en: Exercise 13.1 – Reviewing the Trusted Advisor reports in your AWS account
  id: totrans-174
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 练习 13.1 – 查看 AWS 账户中的 Trusted Advisor 报告
- en: 'In this exercise, you will log into your AWS account and review the Trusted
    Advisor service:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 在本次练习中，你将登录到 AWS 账户并查看 Trusted Advisor 服务：
- en: Log in to your AWS Management Console as the IAM user **Alice**.
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 以 IAM 用户**Alice**身份登录到你的 AWS 管理控制台。
- en: Navigate to the **Trusted Advisor** console, which is located under the **Management
    & Governance** category in your list of services.
  id: totrans-177
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 导航到**Trusted Advisor**控制台，它位于你的服务列表中的**管理与治理**类别下。
- en: You will be redirected to the Trusted Advisor dashboard.
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 你将被重定向到 Trusted Advisor 仪表盘。
- en: Because you may only have subscribed to the Basic Support plan, you will note
    that only a few checks are visible. From the main dashboard, note the **Checks
    Summary** section on the main pane of the dashboard.
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 因为你可能只订阅了基础支持计划，你会注意到只有少数检查项是可见的。从主仪表盘中，注意到仪表盘主面板上的**检查摘要**部分。
- en: From the right-hand pane, click on the **Security** category.
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 从右侧面板，点击**安全**类别。
- en: In the right-hand pane, you will note various checks, such as the one for MFA
    being enabled on your root account.
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在右侧面板中，你会注意到各种检查项，例如检查根账户是否启用了 MFA。
- en: 'Expand the check labeled `22` port that enables `22` port from the internet
    unrestricted:'
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 展开标记为`22`的检查项，该检查项允许从互联网无限制地启用`22`端口：
- en: '![Figure 13.8 – AWS Trusted Advisor dashboard'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: '![图 13.8 – AWS Trusted Advisor 仪表盘'
- en: '](img/B17124_13_08.jpg)'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/B17124_13_08.jpg)'
- en: Figure 13.8 – AWS Trusted Advisor dashboard
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13.8 – AWS Trusted Advisor 仪表盘
- en: From this exercise, you should've learned how to review the AWS Trusted Advisor
    dashboard. You were able to identify some security alerts based on your configuration
    of security groups from earlier exercises that did not adhere to best practices.
    You can then use this report to identify which security groups need to be amended
    to increase security.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 通过本次练习，你应该已经学会了如何查看 AWS Trusted Advisor 仪表盘。你能够根据之前练习中配置的安全组识别一些不符合最佳实践的安全警报。然后，你可以使用此报告来识别需要修改的安全组，以提高安全性。
- en: Summary
  id: totrans-187
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we looked at several services on AWS that can help you manage
    and govern your applications in the cloud. We discussed various monitoring and
    logging tools, such as Amazon CloudWatch, AWS CloudTrail, and AWS Config, and
    how you can use these services to ensure performance, reliability, security, and
    effective change management. You also learned about the AWS Systems Manager service,
    which offers a suite of capabilities to centrally track and resolve operational
    issues across your AWS resources. We used AWS Systems Manager to automate day-to-day
    administrative tasks, ensure compliance of your resource configurations, offer
    incident and change management services, and improve visibility and control.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们查看了 AWS 上的几项服务，这些服务可以帮助你在云中管理和治理应用程序。我们讨论了各种监控和日志工具，例如 Amazon CloudWatch、AWS
    CloudTrail 和 AWS Config，以及如何使用这些服务来确保性能、可靠性、安全性和有效的变更管理。你还了解了 AWS Systems Manager
    服务，它提供了一套功能，可以集中跟踪和解决 AWS 资源中的操作问题。我们使用 AWS Systems Manager 来自动化日常管理任务，确保资源配置的合规性，提供事件和变更管理服务，并提高可见性和控制。
- en: The AWS Trusted Advisor service offers a wide range of reports that allow you
    to cross-reference your resource configurations with various best-practice design
    principles. Finally, we discussed how you must follow the design principles and
    recommendations offered by the AWS Well-Architected Framework when building solutions
    for the cloud.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: AWS Trusted Advisor 服务提供了广泛的报告，允许你将资源配置与各种最佳实践设计原则进行交叉参考。最后，我们讨论了在构建云解决方案时，必须遵循
    AWS Well-Architected Framework 提供的设计原则和建议。
- en: In the next chapter, we will cover AWS security concepts and look at various
    security tools you should use when architecting and managing cloud applications.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将介绍 AWS 安全概念，并探讨在架构和管理云应用时应该使用的各种安全工具。
- en: Questions
  id: totrans-191
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 问题
- en: Which AWS service enables you to track all API activity in your AWS account,
    regardless of whether the activity was performed using the AWS Management Console
    of the CLI?
  id: totrans-192
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 哪项 AWS 服务可以让你追踪 AWS 账户中的所有 API 活动，无论这些活动是通过 AWS 管理控制台还是 CLI 执行的？
- en: AWS CloudTrail
  id: totrans-193
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: AWS CloudTrail
- en: AWS Config
  id: totrans-194
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: AWS Config
- en: AWS Trusted Advisor
  id: totrans-195
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: AWS Trusted Advisor
- en: Application load balancer logs
  id: totrans-196
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 应用负载均衡器日志
- en: As part of implementing change management, which AWS service can be used to
    assess, audit, and evaluate change configurations of your AWS resources, enabling
    you to identify whether a change was the cause of an incident?
  id: totrans-197
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 作为变更管理实施的一部分，哪项 AWS 服务可用于评估、审计和评估 AWS 资源的变更配置，从而帮助你识别是否某个变更导致了事件发生？
- en: AWS Config
  id: totrans-198
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: AWS Config
- en: AWS CloudTrail
  id: totrans-199
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: AWS CloudTrail
- en: Amazon CloudWatch
  id: totrans-200
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: Amazon CloudWatch
- en: AWS Outposts
  id: totrans-201
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: AWS Outposts
- en: Which AWS service can be used to monitor your company's fleet of EC2 instances,
    which can be used to identify performance issues related to CPU utilization or
    memory consumptions?
  id: totrans-202
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 哪项 AWS 服务可用于监控公司 EC2 实例的集群，帮助识别与 CPU 使用率或内存消耗相关的性能问题？
- en: Amazon CloudWatch
  id: totrans-203
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: Amazon CloudWatch
- en: AWS Cloud Monitor
  id: totrans-204
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: AWS 云监控
- en: AWS EC2 Monitor
  id: totrans-205
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: AWS EC2 监控
- en: AWS CloudTrail
  id: totrans-206
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: AWS CloudTrail
- en: Which AWS service helps you identify potential unused resources, such as Elastic
    IP addresses, that are not attached to a running instance and thus highlight opportunities
    to save on costs?
  id: totrans-207
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 哪项 AWS 服务帮助你识别潜在的未使用资源，例如未附加到运行中的实例的弹性 IP 地址，从而突出节省成本的机会？
- en: AWS Cost Explorer
  id: totrans-208
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: AWS 成本探查器
- en: AWS Trusted Advisor
  id: totrans-209
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: AWS Trusted Advisor
- en: AWS Resource Manager
  id: totrans-210
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: AWS 资源管理器
- en: AWS Budgets
  id: totrans-211
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: AWS Budgets
- en: Which capability of the AWS Systems Manager service enables you to remotely
    connect to your Linux EC2 instances without having to use bastion hosts in your
    VPC?
  id: totrans-212
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 哪项 AWS Systems Manager 服务的功能使你能够远程连接到 Linux EC2 实例，而无需使用 VPC 中的堡垒主机？
- en: Session Manager
  id: totrans-213
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 会话管理器
- en: Parameter Store
  id: totrans-214
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 参数存储
- en: Run Command
  id: totrans-215
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: Run Command
- en: Incident Manager
  id: totrans-216
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: 事件管理器
